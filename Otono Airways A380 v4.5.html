<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Otono Airways A380 Seat Map - Retrofit Variant (Cargo Deck Display)</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .font-serif { font-family: 'Playfair Display', serif; }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #555; }

    .animate-fade-in { animation: fadeIn 0.3s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px);} to { opacity: 1; transform: translateY(0);} }

    /* --- Fuselage and Seat Look --- */
    .fuselage-style{
      background-color:white;
      border:4px solid #cbd5e1;
      border-top-left-radius:50% 100px;
      border-top-right-radius:50% 100px;
      border-bottom-left-radius:50% 250px;
      border-bottom-right-radius:50% 250px;
      position:relative;
      overflow:hidden;
      box-shadow:0 0 50px rgba(0,0,0,0.2);
      padding:0 10px 350px 10px;
    }

    .seat-style{
      border-top-left-radius:8px;
      border-top-right-radius:8px;
      border-bottom-left-radius:4px;
      border-bottom-right-radius:4px;
      border-width:1px;
      box-shadow:0 1px 2px rgba(0,0,0,0.1);
    }

    .seat-occupied-style{
      background-color:#e5e7eb !important;
      border-color:#9ca3af !important;
      color:#4b5563 !important;
      cursor:not-allowed !important;
      pointer-events:none;
      transform:none !important;
      box-shadow:none !important;
      opacity:0.8;
    }

    .seat-selected-style{
      background-color:#3fd166 !important;
      border-color:#298c43 !important;
      color:black !important;
      transform:scale(1.15);
      z-index:20;
      box-shadow:0 0 15px rgba(0,255,21,0.8);
    }

    /* Quality badges */
    .good-seat-badge{
      background-color:#e9d5ff;
      color:#6d28d9;
      border:1px solid #d8b4fe;
    }
    .bad-seat-badge{
      background-color:#bfdbfe;
      color:#1e40af;
      border:1px solid #93c5fd;
    }

    /* Cargo display tiles (NOT selectable) */
    .cargo-tile{
      border-radius:14px;
      border:2px solid #cbd5e1;
      background:#e5e7eb;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.5);
      user-select:none;
    }
    .cargo-tile.dark{ background:#d1d5db; }
    .cargo-bay{
      border-radius:18px;
      border:3px solid #94a3b8; /* slate-400 */
      background:#e5e7eb;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.55);
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-800">
<div id="root"></div>

<script type="text/babel">
  const { useState, useMemo } = React;

  // --- Icons ---
  const IconWrapper = ({ children, size = 24, className = "" }) => (
    <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none"
      stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
      {children}
    </svg>
  );
  const Plane = (props) => <IconWrapper {...props}><path d="M2 12h20"/><path d="M13 2l9 10-9 10"/><path d="M2 12l5-5m-5 5l5 5"/></IconWrapper>;
  const Star = (props) => <IconWrapper {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></IconWrapper>;
  const Coffee = (props) => <IconWrapper {...props}><path d="M18 8h1a4 4 0 0 1 0 8h-1" /><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z" /><line x1="6" y1="1" x2="6" y2="4" /><line x1="10" y1="1" x2="10" y2="4" /><line x1="14" y1="1" x2="14" y2="4" /></IconWrapper>;
  const User = (props) => <IconWrapper {...props}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></IconWrapper>;
  const Bath = (props) => <IconWrapper {...props}><path d="M9 6 6.5 3.5a1.5 1.5 0 0 0-1-1C5.5 2.5 5 3 5 4v8" /><line x1="10" y1="5" x2="8" y2="7" /><path d="M2 12h20" /><path d="M7 19v2" /><path d="M17 19v2" /></IconWrapper>;
  const ArrowUp = (props) => <IconWrapper {...props}><line x1="12" y1="19" x2="12" y2="5" /><polyline points="5 12 12 5 19 12" /></IconWrapper>;
  const Wifi = (props) => <IconWrapper {...props}><path d="M5 12.55a11 11 0 0 1 14.08 0" /><path d="M1.44 9a16 16 0 0 1 21.16 0" /><path d="M8.53 16.11a6 6 0 0 1 6.95 0" /><line x1="12" y1="20" x2="12.01" y2="20" /></IconWrapper>;
  const ThumbsUp = (props) => <IconWrapper {...props}><path d="M7 10v12" /><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z" /></IconWrapper>;
  const ThumbsDown = (props) => <IconWrapper {...props}><path d="M17 14V2" /><path d="M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z" /></IconWrapper>;

  // --- Configuration ---
  const DECK_UPPER = 'UPPER';
  const DECK_MAIN  = 'MAIN';
  const DECK_CARGO = 'CARGO';

  const CLASS_OTONO_ONE = 'Otono One';
  const CLASS_FIRST     = 'First Class';
  const CLASS_BUSINESS  = 'Business';
  const CLASS_PREM_ECO  = 'Premium Economy';
  const CLASS_ECONOMY   = 'Economy';

  const CLASS_COLORS = {
    [CLASS_OTONO_ONE]: 'bg-purple-900 border-yellow-400 text-yellow-100',
    [CLASS_FIRST]: 'bg-purple-700 border-purple-300 text-white',
    [CLASS_BUSINESS]: 'bg-red-900 border-red-700 text-white',
    [CLASS_PREM_ECO]: 'bg-red-700 border-red-500 text-white',
    [CLASS_ECONOMY]: 'bg-red-500 border-red-400 text-white hover:bg-red-400 hover:border-red-300',
  };

  // --- Pricing Logic ---
  const getPrice = (type, row, features) => {
    if (type === CLASS_OTONO_ONE) return 'Â£14,000';
    if (type === CLASS_FIRST) return 'Â£6,500';
    if (type === CLASS_BUSINESS) {
      if (row >= 10 && row <= 17) return 'Â£3,750';
      return 'Â£3,500'
    }
    if (type === CLASS_PREM_ECO) return 'Â£2,150';
    if (type === CLASS_ECONOMY) {
      if (features.includes('Extra Legroom') || features.includes('Preferred Seat')) return 'Â£1,650';
      if (row >= 68 && row <= 77) return 'Â£1,350';
      return 'Â£1,500';
    }
    return 'N/A';
  };

  const createSeat = (id, type, row, col, isAisle = false, features = []) => {
    let finalFeatures = [...features];

    const wifiFeature =
      (type === CLASS_OTONO_ONE || type === CLASS_FIRST || type === CLASS_BUSINESS)
        ? 'Free High-Speed WiFi'
        : (type === CLASS_PREM_ECO)
          ? 'Â£2.50 for High-Speed WiFi and Free Messaging WiFi'
          : 'Free Messaging WiFi and Â£7.50 for High-Speed WiFi';

    finalFeatures.push(wifiFeature);
    if (type === CLASS_ECONOMY || type === CLASS_PREM_ECO) finalFeatures.push('Standard Otono Service');
    if (row >= 68 && row <= 77) finalFeatures.push('Economy Saver');

    return {
      id, type, row, col, isAisle,
      isOccupied: Math.random() > 0.85,
      features: finalFeatures,
      price: getPrice(type, row, finalFeatures),
    };
  };

  // --- Seat Quality ---
  const getSeatQuality = (seat) => {
    const r = seat.row;
    const c = seat.col;

    if (seat.features.includes('Extra Legroom')) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Extra Legroom', icon: ThumbsUp };
    }
    if (seat.type === CLASS_OTONO_ONE) {
      return { type: 'GOOD', label: 'Amazing Suite', reason: 'Luxury Suite', icon: ThumbsUp };
    }

    // GOOD addition: 67 B/C/H/J
    if (r === 67 && ['B','C','H','J'].includes(c)) {
      return { type: 'GOOD', label: 'Preferred Seat', reason: 'Better position', icon: ThumbsUp };
    }

    // BAD addition: 33 D/G
    if (r === 33 && ['D','G'].includes(c)) {
      return { type: 'BAD', label: 'Bad Seat', reason: 'Near Lavatories', icon: ThumbsDown };
    }
    if (r === 34 && ['A','K'].includes(c)) {
      return { type: 'BAD', label: 'Bad Seat', reason: 'Near Galley', icon: ThumbsDown };
    }
    if (r === 11 && ['A','K'].includes(c)) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Priority Deboarding', icon: ThumbsUp };
    }
    if (r === 12 && ['A','K'].includes(c)) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Priority Deboarding', icon: ThumbsUp };
    }
    if (r === 15 && ['A','K'].includes(c)) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Priority Deboarding', icon: ThumbsUp };
    }
    if (r === 37 && ['A','D','G','K'].includes(c)) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Priority Deboarding', icon: ThumbsUp };
    }
    if (r === 38 && ['A','D','G','K'].includes(c)) {
      return { type: 'GOOD', label: 'Good Seat', reason: 'Priority Deboarding', icon: ThumbsUp };
    }

    return null;
  };

  // --- Passenger Counter ---
  const flattenCabins = (cabins) => cabins.reduce((acc, c) => acc.concat(c.seats), []);
  const buildSeatStats = (seats) => {
    const totals = {
      total: 0, occupied: 0, available: 0,
      byClass: {
        [CLASS_OTONO_ONE]: { total: 0, occupied: 0, available: 0 },
        [CLASS_FIRST]: { total: 0, occupied: 0, available: 0 },
        [CLASS_BUSINESS]: { total: 0, occupied: 0, available: 0 },
        [CLASS_PREM_ECO]: { total: 0, occupied: 0, available: 0 },
        [CLASS_ECONOMY]: { total: 0, occupied: 0, available: 0 },
      }
    };

    for (const s of seats) {
      const paxValue = (s.type === CLASS_OTONO_ONE) ? 2 : 1;
      totals.total += paxValue;
      totals.byClass[s.type].total += paxValue;

      if (s.isOccupied) {
        totals.occupied += paxValue;
        totals.byClass[s.type].occupied += paxValue;
      } else {
        totals.available += paxValue;
        totals.byClass[s.type].available += paxValue;
      }
    }
    return totals;
  };

  const SeatCounterPanel = ({ stats }) => {
    const classOrder = [CLASS_OTONO_ONE, CLASS_FIRST, CLASS_BUSINESS, CLASS_PREM_ECO, CLASS_ECONOMY];
    return (
      <div className="bg-white p-4 rounded-xl shadow-md border border-gray-100">
        <h2 className="text-sm font-bold text-gray-500 uppercase mb-3">Passenger Availability</h2>

        <div className="grid grid-cols-3 gap-2 mb-4">
          <div className="rounded-lg border border-gray-100 p-3">
            <div className="text-[11px] text-gray-500 font-bold uppercase">Total</div>
            <div className="text-2xl font-extrabold text-purple-700">{stats.total}</div>
          </div>
          <div className="rounded-lg border border-gray-100 p-3">
            <div className="text-[11px] text-gray-500 font-bold uppercase">Occupied</div>
            <div className="text-2xl font-extrabold text-red-600">{stats.occupied}</div>
          </div>
          <div className="rounded-lg border border-gray-100 p-3">
            <div className="text-[11px] text-gray-500 font-bold uppercase">Available</div>
            <div className="text-2xl font-extrabold text-green-600">{stats.available}</div>
          </div>
        </div>

        <div className="border-t border-gray-100 pt-3">
          <div className="text-[11px] text-gray-500 font-bold uppercase mb-2">By Class</div>
          <div className="space-y-2">
            {classOrder.map(cls => {
              const c = stats.byClass[cls];
              const badgeBg = CLASS_COLORS[cls].split(' ')[0];
              return (
                <div key={cls} className="rounded-lg border border-gray-100 p-3">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-2">
                      <span className={`w-3 h-3 rounded-sm ${badgeBg} border border-black/10`}></span>
                      <span className="font-bold text-gray-700 text-sm">{cls}</span>
                    </div>
                    <div className="text-xs font-bold text-purple-700">{c.total} pax</div>
                  </div>
                  <div className="grid grid-cols-2 gap-2 mt-2">
                    <div className="rounded-md bg-gray-50 p-2">
                      <div className="text-[10px] uppercase font-bold text-gray-500">Occupied</div>
                      <div className="text-lg font-extrabold text-red-600">{c.occupied}</div>
                    </div>
                    <div className="rounded-md bg-gray-50 p-2">
                      <div className="text-[10px] uppercase font-bold text-gray-500">Available</div>
                      <div className="text-lg font-extrabold text-green-600">{c.available}</div>
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      </div>
    );
  };

  // ============================================================
  // DATA GENERATION â€” RETROFIT VARIANT
  // ============================================================

  // UPPER DECK
  const generateUpperDeck = () => {
    const cabins = [];

    // First 5-8 A D G K
    const firstCabin = [];
    for (let row = 5; row <= 8; row++) {
      ['A','D','G','K'].forEach(col => {
        const isAisle = (col === 'D' || col === 'G');
        firstCabin.push(createSeat(`${row}${col}`, CLASS_FIRST, row, col, isAisle, [
          'Shower Access','Private suite','Larger IFE screen', (col === 'A' || col === 'K') ? 'Window seat' : 'Centre Pair'
        ]));
      });
    }
    cabins.push({ name: "Upper Cabin 1 (First)", seats: firstCabin });

    // Upper Business 37-43 A D G K
    const upperBiz = [];
    for (let row = 37; row <= 43; row++) {
      ['A','D','G','K'].forEach(col => {
        const isAisle = (col === 'D' || col === 'G');
        upperBiz.push(createSeat(`${row}${col}`, CLASS_BUSINESS, row, col, isAisle, ['Lie-flat','Direct aisle access','Gourmet meal service']));
      });
    }
    cabins.push({ name: "Upper Cabin 2 (Business)", seats: upperBiz });

    // Premium 44-52 2-3-2 A C | D F G | H K + storage bins A/K
    const prem = [];
    for (let row = 44; row <= 52; row++) {
      const baseFeats = (row === 44) ? ['Extra Legroom'] : [];
      ['A','C','D','F','G','H','K'].forEach(col => {
        const isAisle = ['C','D','G','H'].includes(col);
        const feats = [...baseFeats];
        if (col === 'A' || col === 'K') feats.push('Storage Bin');
        prem.push(createSeat(`${row}${col}`, CLASS_PREM_ECO, row, col, isAisle, feats));
      });
    }
    cabins.push({ name: "Upper Cabin 3 (Premium Economy)", seats: prem });

    // Upper Economy 84-92 2-4-2 A C | D E F G | H K + storage bins A/K
    const upEco = [];
    for (let row = 84; row <= 92; row++) {
      const baseFeats = (row === 84) ? ['Extra Legroom'] : [];
      ['A','C','D','E','F','G','H','K'].forEach(col => {
        const isAisle = ['C','D','G','H'].includes(col);
        const feats = [...baseFeats];
        if (col === 'A' || col === 'K') feats.push('Storage Bin');
        upEco.push(createSeat(`${row}${col}`, CLASS_ECONOMY, row, col, isAisle, feats));
      });
    }
    cabins.push({ name: "Upper Cabin 4 (Economy)", seats: upEco });

    // Otono One REAR rows 1-2 A/K suites
    const otonoRear = [];
    [1,2].forEach(row => {
      otonoRear.push(createSeat(`${row}A`, CLASS_OTONO_ONE, row, 'A', false, ['Largest IFE screen','Shower Access','Private suite for two','Fine dining','Exclusive amenity kit']));
      otonoRear.push(createSeat(`${row}K`, CLASS_OTONO_ONE, row, 'K', false, ['Largest IFE screen','Shower Access','Private suite for two','Fine dining','Exclusive amenity kit']));
    });
    cabins.push({ name: "Upper Cabin 5 (Otono One - Rear)", seats: otonoRear });

    return cabins;
  };

  // MAIN DECK
  const generateMainDeck = () => {
    const cabins = [];

    // Business block 1: 11,12 (A/K), 15 (A/K only), 16-19 (A D G K)
    const b1 = [];
    [11,12,15,16,17,18,19].forEach(row => {
      b1.push(createSeat(`${row}A`, CLASS_BUSINESS, row, 'A', false, ['Lie-flat','Direct aisle access','Gourmet meal service']));
      b1.push(createSeat(`${row}K`, CLASS_BUSINESS, row, 'K', false, ['Lie-flat','Direct aisle access','Gourmet meal service']));
      if (row !== 11 && row !== 12 && row !== 15) { // 15 D/G removed
        b1.push(createSeat(`${row}D`, CLASS_BUSINESS, row, 'D', true, ['Lie-flat','Centre','Direct aisle access','Gourmet meal service']));
        b1.push(createSeat(`${row}G`, CLASS_BUSINESS, row, 'G', true, ['Lie-flat','Centre','Direct aisle access','Gourmet meal service']));
      }
    });
    cabins.push({ name: "Main Cabin 1 (Business)", seats: b1 });

    // Business block 2: 22-34 (22 no D/G, 34 no D/G)
    const b2 = [];
    for (let row = 22; row <= 34; row++) {
      b2.push(createSeat(`${row}A`, CLASS_BUSINESS, row, 'A', false, ['Lie-flat','Direct aisle access','Gourmet meal service']));
      b2.push(createSeat(`${row}K`, CLASS_BUSINESS, row, 'K', false, ['Lie-flat','Direct aisle access','Gourmet meal service']));
      if (row !== 22 && row !== 34) {
        b2.push(createSeat(`${row}D`, CLASS_BUSINESS, row, 'D', true, ['Lie-flat','Centre','Direct aisle access','Gourmet meal service']));
        b2.push(createSeat(`${row}G`, CLASS_BUSINESS, row, 'G', true, ['Lie-flat','Centre','Direct aisle access','Gourmet meal service']));
      }
    }
    cabins.push({ name: "Main Cabin 2 (Business)", seats: b2 });

    // Economy 56-67 (67 no A/K)
    const e1 = [];
    for (let row = 56; row <= 67; row++) {
      ['A','B','C','D','E','F','G','H','J','K'].forEach(col => {
        if (row === 67 && (col === 'A' || col === 'K')) return;
        const feats = [];
        if (row === 56) feats.push('Extra Legroom');
        const isAisle = ['C','D','G','H'].includes(col);
        e1.push(createSeat(`${row}${col}`, CLASS_ECONOMY, row, col, isAisle, feats));
      });
    }
    cabins.push({ name: "Main Cabin 3 (Economy)", seats: e1 });

    // Economy 68-77 (77 no D/E/F/G)
    const e2 = [];
    for (let row = 68; row <= 77; row++) {
      ['A','B','C','D','E','F','G','H','J','K'].forEach(col => {
        if (row === 77 && ['D','E','F','G'].includes(col)) return;
        const feats = [];
        if (row === 68) feats.push('Extra Legroom');
        const isAisle = ['C','D','G','H'].includes(col);
        e2.push(createSeat(`${row}${col}`, CLASS_ECONOMY, row, col, isAisle, feats));
      });
    }
    cabins.push({ name: "Main Cabin 4 (Economy)", seats: e2 });

    return cabins;
  };

  // ============================================================
  // Components
  // ============================================================

  const Seat = ({ seat, onSelect, isSelected }) => {
    const baseClasses = "w-7 h-8 m-[1px] md:m-0.5 text-[9px] flex items-center justify-center font-bold cursor-pointer transition-all duration-200 seat-style";
    let typeClasses = CLASS_COLORS[seat.type];

    let borderClass = "";
    if (seat.features.includes('Extra Legroom')) borderClass = "border-b-4 border-yellow-400";

    if (seat.isOccupied) {
      typeClasses = "seat-occupied-style";
      borderClass = "";
    } else if (isSelected) {
      typeClasses = "seat-selected-style";
    } else {
      typeClasses += " hover:scale-110 hover:z-10";
    }

    if (seat.type === CLASS_OTONO_ONE) {
      return (
        <div
          onClick={() => !seat.isOccupied && onSelect(seat)}
          className={`w-16 h-16 m-2 rounded-lg text-xs flex flex-col items-center justify-center font-serif border-2 ${
            typeClasses.includes('seat-occupied-style') ? 'seat-occupied-style' : typeClasses
          } ${seat.isOccupied ? '' : 'hover:shadow-xl'} ${isSelected ? 'seat-selected-style' : ''}`}
        >
          <span>{seat.id}</span>
          <span className="text-[8px] opacity-75">SUITE</span>
        </div>
      );
    }

    if (seat.type === CLASS_FIRST) {
      return (
        <div
          onClick={() => !seat.isOccupied && onSelect(seat)}
          className={`w-10 h-10 m-1 rounded-md text-[10px] flex items-center justify-center border ${
            typeClasses.includes('seat-occupied-style') ? 'seat-occupied-style' : typeClasses
          } ${isSelected ? 'seat-selected-style' : ''}`}
        >
          {seat.id}
        </div>
      );
    }

    return (
      <div
        onClick={() => !seat.isOccupied && onSelect(seat)}
        className={`${baseClasses} ${typeClasses} ${borderClass}`}
        title={seat.features.join(', ')}
      >
        {seat.id.replace(/[0-9]/g, '')}
      </div>
    );
  };

  const ShowerSuite = () => (
    <div className="flex flex-col items-center justify-center bg-blue-100 border border-blue-300 text-blue-800 p-2 rounded-lg w-24 h-24 m-2 text-xs text-center shadow-inner">
      <Bath size={24} className="mb-1" />
      <span className="font-bold">Shower Spa</span>
      <span className="text-[9px]">Otono One & First</span>
    </div>
  );

  const Stairs = ({ label, isLower = false }) => (
    <div className={`w-full ${isLower ? 'h-16 w-32 mx-auto rounded-lg border-2' : 'h-10 border-y-2'}
      bg-gray-200 border-gray-300 flex flex-col items-center justify-center my-2 opacity-60
      bg-[url('https://www.transparenttextures.com/patterns/diagmonds-light.png')]`}>
      {isLower && <ArrowUp size={16} className="text-gray-500 mb-1" />}
      <span className="text-gray-500 text-[10px] font-bold uppercase tracking-widest text-center leading-tight">{label}</span>
    </div>
  );

  // Lounge (display-only) â€” EXACT old block
  const Lounge = () => (
    <div className="w-full bg-purple-900 text-white p-6 rounded-b-3xl flex flex-col items-center justify-center mt-4 border-t-4 border-red-600 shadow-2xl relative overflow-hidden">
      <div className="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
      <div className="z-10 flex items-center space-x-4">
        <Coffee size={32} />
        <div className="text-center">
          <h3 className="text-xl font-bold font-serif">The Otono Lounge</h3>
          <p className="text-xs text-purple-200">Open to ALL Classes</p>
          <p className="text-xs text-purple-200">"Grandpa Belt's Favorite Spot"</p>
        </div>
      </div>
    </div>
  );

  // Cargo deck DISPLAY ONLY: Lounge at front + 9 cargo bays (1..9)
  const CargoDeckDisplay = () => {
    const bays = [1,2,3,4,5,6,7,8,9];

    return (
      <div className="w-full flex flex-col items-center">
        {/* Lounge at the FRONT */}
        <div className="w-full px-3">
          <Lounge />
          <div className="text-center text-[10px] text-gray-400 mt-2">
          </div>
        </div>

        <div className="w-full flex items-center justify-center my-5">
          <div className="h-12 w-full bg-gray-100 border-y border-gray-200 flex items-center justify-center">
            <span className="text-[10px] text-gray-400 tracking-widest uppercase">CARGO BAYS</span>
          </div>
        </div>

        {/* 9 rectangles labeled 1..9 */}
        <div className="w-full px-6">
          <div className="grid grid-cols-1 gap-4">
            {bays.map(n => (
              <div
                key={n}
                className="cargo-bay w-full h-20 flex items-center justify-center text-lg font-extrabold text-slate-600"
                title="Cargo bay display"
              >
                Cargo Bay {n}
              </div>
            ))}
          </div>
        </div>

        <div className="mt-6 w-full px-6">
          <Stairs label="Staircase (Up to Main Deck)" isLower={true} />
        </div>
      </div>
    );
  };

  const DeckMap = ({ deck, cabins, onSelect, selectedSeat }) => {
    if (deck === DECK_CARGO) {
      return (
        <div className="flex flex-col items-center bg-white rounded-3xl shadow-2xl border-4 border-gray-300 p-2 md:p-4 w-full max-w-2xl mx-auto relative overflow-hidden min-h-[800px] fuselage-style">
          <div className="mt-8 mb-4 w-full text-center py-2 text-gray-400 font-bold">CARGO DECK</div>
          <CargoDeckDisplay />
        </div>
      );
    }

    return (
      <div className="flex flex-col items-center bg-white rounded-3xl shadow-2xl border-4 border-gray-300 p-2 md:p-4 w-full max-w-2xl mx-auto relative overflow-hidden min-h-[800px] fuselage-style">
        <div className="mt-8 mb-4 w-full flex justify-center z-10">
          {deck === DECK_UPPER ? (
            <div className="flex justify-between w-full px-4 md:px-8">
              <ShowerSuite />
              <div className="flex flex-col justify-end pb-4 w-full mx-2">
                <Stairs label="Grand Staircase" />
              </div>
              <ShowerSuite />
            </div>
          ) : (
            <div className="w-full text-center py-4 text-gray-400 font-bold">COCKPIT ABOVE</div>
          )}
        </div>

        <div className="w-full flex flex-col items-center space-y-2">
          {cabins.map((cabin, cIdx) => {
            const rows = {};
            cabin.seats.forEach(s => {
              if (!rows[s.row]) rows[s.row] = [];
              rows[s.row].push(s);
            });
            const rowNumbers = Object.keys(rows).sort((a,b) => a - b);

            return (
              <div key={cabin.name} className="w-full flex flex-col items-center">
                {cIdx > 0 && (
                  <div className="w-full flex items-center justify-center my-4">
                    <div className="h-12 w-full bg-gray-100 border-y border-gray-200 flex items-center justify-center">
                      <span className="text-[10px] text-gray-400 tracking-widest uppercase">Galley / Exit</span>
                    </div>
                  </div>
                )}

                {rowNumbers.map(rowNum => {
                  const rowSeats = rows[rowNum].sort((a,b) => a.col.localeCompare(b.col));
                  const rInt = parseInt(rowNum, 10);
                  const isGrandStairRow = deck === DECK_MAIN && (rInt === 11 || rInt === 12 || rInt === 15 );

                  return (
                    <div key={rowNum} className="flex items-center justify-center w-full my-0.5">
                      <span className="w-6 text-[10px] text-gray-400 text-right mr-1 font-mono">{rowNum}</span>

                      <div className="flex relative">
                        {isGrandStairRow && (
                          <div className="absolute left-1/2 top-0 -translate-x-1/2 w-24 h-full bg-gray-200 border-x border-gray-300 flex items-center justify-center z-0">
                            {rInt === 11 && <span className="text-[8px] text-gray-400 font-bold uppercase">Grand</span>}
                            {rInt === 12 && <span className="text-[8px] text-gray-400 font-bold uppercase">Staircase</span>}
                            {rInt === 15 && <span className="text-[8px] text-gray-400 font-bold uppercase"></span>}
                          </div>
                        )}

                        {rowSeats.map((seat, i) => {
                          let spacer = null;

                          if (deck === DECK_MAIN && seat.type === CLASS_ECONOMY) {
                            if (seat.col === 'D' && i > 0) spacer = <div className="w-3 md:w-6"></div>;
                            if (seat.col === 'H') spacer = <div className="w-3 md:w-6"></div>;
                          } else if (deck === DECK_UPPER && (seat.type === CLASS_ECONOMY || seat.type === CLASS_PREM_ECO)) {
                            if (seat.col === 'D') spacer = <div className="w-3 md:w-6"></div>;
                            if (seat.col === 'H') spacer = <div className="w-3 md:w-6"></div>;
                          } else if (seat.type === CLASS_BUSINESS) {
                            if (isGrandStairRow) {
                              if (seat.col === 'K') spacer = <div className="w-24 md:w-32"></div>;
                            } else {
                              if (seat.col === 'D') spacer = <div className="w-4 md:w-8"></div>;
                              if (seat.col === 'K') spacer = <div className="w-4 md:w-8"></div>;
                            }
                          } else if (seat.type === CLASS_FIRST) {
                            if (seat.col === 'D') spacer = <div className="w-4 md:w-8"></div>;
                            if (seat.col === 'K') spacer = <div className="w-4 md:w-8"></div>;
                          }

                          return (
                            <React.Fragment key={seat.id}>
                              {spacer}
                              <Seat seat={seat} onSelect={onSelect} isSelected={selectedSeat?.id === seat.id} />
                            </React.Fragment>
                          );
                        })}
                      </div>

                      <span className="w-6 text-[10px] text-gray-400 text-left ml-1 font-mono">{rowNum}</span>
                    </div>
                  );
                })}
              </div>
            );
          })}
        </div>

        <div className="mt-8 w-full z-10">
          {deck === DECK_UPPER ? (
            <>
              <Stairs label="Rear Staircase (Down to Main Deck)" />
              <div className="w-full text-center text-[10px] text-gray-400 mt-2">
                NOTE: The onboard lounge has moved to the Cargo Deck (display-only).
              </div>
            </>
          ) : (
            <>
              <div className="w-full py-4 text-center text-gray-400">
                <div className="w-full h-8 bg-gray-100 my-2 flex items-center justify-center text-[10px] text-gray-400">REAR GALLEY</div>
              </div>
              <Stairs label="Staircase (Down to Cargo Deck Display)" isLower={true} />
            </>
          )}
        </div>
      </div>
    );
  };

  function App() {
    const [currentDeck, setCurrentDeck] = useState(DECK_UPPER);
    const [selectedSeat, setSelectedSeat] = useState(null);

    const upperCabins = useMemo(() => generateUpperDeck(), []);
    const mainCabins  = useMemo(() => generateMainDeck(), []);

    const allSeats = useMemo(() => [...flattenCabins(upperCabins), ...flattenCabins(mainCabins)], [upperCabins, mainCabins]);
    const seatStats = useMemo(() => buildSeatStats(allSeats), [allSeats]);
    const quality = selectedSeat ? getSeatQuality(selectedSeat) : null;

    const currentCabins =
      currentDeck === DECK_UPPER ? upperCabins :
      currentDeck === DECK_MAIN  ? mainCabins  :
      [];

    return (
      <div className="min-h-screen bg-slate-50 font-sans text-slate-800 pb-20">
        <header className="bg-gradient-to-r from-purple-900 to-red-700 text-white p-4 shadow-lg sticky top-0 z-50">
          <div className="max-w-4xl mx-auto flex justify-between items-center">
            <div className="flex items-center space-x-2">
              <Plane className="transform -rotate-45" size={28} />
              <div>
                <h1 className="text-xl font-bold tracking-wider">OTONO AIRWAYS</h1>
                <a href="index.html">Return To Main Menu</a>
                <p className="text-xs text-purple-200">Airbus A380-800 â€¢ Retrofit Variant</p>
              </div>
            </div>

            <div className="text-right hidden sm:block">
              <div className="flex items-center justify-end">
                <Wifi size={16} className="text-yellow-400 mr-1" />
                <span className="text-sm font-bold text-yellow-300">Free Messaging WiFi</span>
                <span className="text-xs ml-1 text-purple-200">(High Speed: Â£7.50 ONLY!!!)</span>
              </div>
              <p className="text-sm font-bold italic">"NO MORE FEAR of economy class!"</p>
              <a href="otonoteam2.github.io/otono%20Airways%20A380%20v4.5fr.html">FranÃ§ais ðŸ‡«ðŸ‡·</a>
              <p className="text-xs opacity-75">Bristol â€¢ London â€¢ Global</p>
            </div>
          </div>
        </header>

        <main className="max-w-6xl mx-auto mt-6 px-2 md:px-6 flex flex-col md:flex-row gap-8">
          <div className="w-full md:w-1/3 space-y-6">
            <div className="bg-white p-4 rounded-xl shadow-md border border-gray-100">
              <h2 className="text-sm font-bold text-gray-500 uppercase mb-3">Select Deck</h2>
              <div className="flex space-x-2 bg-gray-100 p-1 rounded-lg">
                <button
                  onClick={() => { setCurrentDeck(DECK_UPPER); setSelectedSeat(null); }}
                  className={`flex-1 py-3 rounded-md text-sm font-bold transition-all ${currentDeck === DECK_UPPER ? 'bg-white text-purple-700 shadow-sm' : 'text-gray-500 hover:bg-gray-200'}`}
                >
                  Upper Deck
                  <span className="block text-[9px] font-normal opacity-75">First â€¢ Suites (Rear)</span>
                </button>

                <button
                  onClick={() => { setCurrentDeck(DECK_MAIN); setSelectedSeat(null); }}
                  className={`flex-1 py-3 rounded-md text-sm font-bold transition-all ${currentDeck === DECK_MAIN ? 'bg-white text-indigo-700 shadow-sm' : 'text-gray-500 hover:bg-gray-200'}`}
                >
                  Main Deck
                  <span className="block text-[9px] font-normal opacity-75">Business â€¢ Economy</span>
                </button>

                <button
                  onClick={() => { setCurrentDeck(DECK_CARGO); setSelectedSeat(null); }}
                  className={`flex-1 py-3 rounded-md text-sm font-bold transition-all ${currentDeck === DECK_CARGO ? 'bg-white text-slate-700 shadow-sm' : 'text-gray-500 hover:bg-gray-200'}`}
                >
                  Cargo Deck
                  <span className="block text-[9px] font-normal opacity-75">Lounge </span>
                </button>
              </div>
            </div>

            <div className="bg-white p-6 rounded-xl shadow-md border border-gray-100 min-h-[200px]">
              {selectedSeat ? (
                <div className="animate-fade-in">
                  <div className="flex justify-between items-start mb-4">
                    <div>
                      <span className={`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide text-white ${CLASS_COLORS[selectedSeat.type].split(' ')[0]}`}>
                        {selectedSeat.type}
                      </span>
                      <h2 className="text-3xl font-bold text-gray-800 mt-2">{selectedSeat.id}</h2>
                    </div>
                    <div className="text-right">
                      <span className="block text-2xl font-bold text-green-600">{selectedSeat.price}</span>
                      <span className="text-xs text-gray-400">One Way</span>
                    </div>
                  </div>

                  {quality && (
                    <div className={`p-2 rounded-lg mb-4 text-sm font-bold flex items-center shadow-inner ${quality.type === 'GOOD' ? 'good-seat-badge' : 'bad-seat-badge'}`}>
                      <quality.icon size={18} className="mr-2" />
                      <div className="flex flex-col">
                        <span>{quality.label}</span>
                        <span className="text-[10px] font-normal opacity-80 italic">{quality.reason}</span>
                      </div>
                    </div>
                  )}

                  <div className="space-y-3">
                    <div className="flex items-center text-sm text-gray-600">
                      <User size={16} className="mr-2" />
                      <span>{selectedSeat.isAisle ? "Aisle Access" : "Window / Interior"}</span>
                    </div>

                    {selectedSeat.features && selectedSeat.features.map((feat, i) => (
                      <div key={i} className="flex items-center text-sm text-gray-600">
                        {feat.includes('WiFi') ? <Wifi size={16} className="mr-2 text-blue-500" /> : <Star size={16} className="mr-2 text-yellow-500" />}
                        <span>{feat}</span>
                      </div>
                    ))}

                    {selectedSeat.type === CLASS_ECONOMY && (
                      <div className="flex items-center text-sm text-purple-600 font-medium">
                        <span>34" Legroom Guaranteed</span>
                      </div>
                    )}
                  </div>

                  <button
                    className="w-full mt-6 bg-red-600 text-white py-3 rounded-lg font-bold hover:bg-red-700 transition-colors shadow-md hover:shadow-lg flex items-center justify-center"
                    onClick={() => {
                      if (selectedSeat) {
                        window.location.href = 'https://otonoteam2.github.io/Otono%20Airways%20A380%20Destinations.html';
                      } else {
                        alert('Please select a seat first.');
                      }
                    }}
                  >
                    Book Seat {selectedSeat ? selectedSeat.id : ''}
                  </button>
                </div>
              ) : (
                <div className="h-full flex flex-col items-center justify-center text-gray-400 text-center py-8">
                  <p>Select a seat to view details.</p>
                  <p className="text-[11px] mt-2"></p>
                </div>
              )}
            </div>

            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
              <h3 className="text-xs font-bold text-gray-400 uppercase mb-3">Key</h3>
              <div className="space-y-2">
                {Object.keys(CLASS_COLORS).map(cls => (
                  <div key={cls} className="flex items-center">
                    <div className={`w-4 h-4 rounded-sm mr-3 ${CLASS_COLORS[cls].split(' ')[0]} border border-black/10`}></div>
                    <span className="text-sm font-medium text-gray-600">{cls}</span>
                  </div>
                ))}
                <div className="flex items-center mt-4 pt-4 border-t border-gray-100">
                  <div className="w-4 h-4 rounded-sm mr-3 bg-gray-300"></div>
                  <span className="text-sm text-gray-400">Occupied</span>
                </div>
                <div className="flex items-center pt-2">
                  <div className="w-4 h-4 rounded-sm mr-3 bg-red-500 border-b-4 border-yellow-400"></div>
                  <span className="text-sm text-gray-600">Extra Legroom</span>
                </div>
                <div className="flex items-center pt-2">
                  <div className="w-4 h-4 rounded-sm mr-3 good-seat-badge"></div>
                  <span className="text-sm text-gray-600">Good Seat</span>
                </div>
                <div className="flex items-center pt-2">
                  <div className="w-4 h-4 rounded-sm mr-3 bad-seat-badge"></div>
                  <span className="text-sm text-gray-600">Bad Seat</span>
                </div>
              </div>
            </div>

            <SeatCounterPanel stats={seatStats} />
          </div>

          <div className="w-full md:w-2/3">
            <DeckMap deck={currentDeck} cabins={currentCabins} onSelect={setSelectedSeat} selectedSeat={selectedSeat} />
          </div>
        </main>
      </div>
    );
  }

  ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
