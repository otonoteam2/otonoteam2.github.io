<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Otono Airways | A350 Fleet Seat Map (Final Version)</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap');
        
        body { font-family: 'Outfit', sans-serif; background-color: #f0f2f5; }
        
        .fuselage {
            background-color: white;
            border: 4px solid #cbd5e1;
            border-radius: 230px 230px 100px 100px;
            padding: 60px 40px 100px 40px; 
            width: 450px; 
            margin: 0 auto;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }

        .cockpit {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 35px solid transparent;
            border-right: 35px solid transparent;
            border-bottom: 45px solid #e2e8f0;
        }

        .seat {
            height: 33px; 
            margin: 2px;
            border-radius: 6px; 
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
            position: relative;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            min-width: 33px; /* Base for Economy */
        }
        
        .seat.business { width: 40px; height: 40px; } 
        .seat.prem_eco { width: 36px; height: 36px; } 
        .seat.economy { width: 33px; height: 33px; } 

        .seat.occupied {
            background-color: #d1d5db !important; 
            color: #9ca3af !important; 
            border: 1px solid #9ca3af !important;
            cursor: not-allowed;
            pointer-events: none;
            box-shadow: none;
        }

        /* NEW: Selected seat styling */
        .seat.selected:not(.occupied) {
            background-color: #10b981 !important; /* Green-500 */
            color: white !important;
            border-color: #059669 !important; /* Green-600 */
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.6);
        }

        .seat:hover:not(.occupied):not(.selected) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 10;
        }

        .row-num {
            width: 24px;
            text-align: center;
            font-size: 11px;
            color: #64748b;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Specific Otono Colors & Badges */
        .good-seat-badge { background-color: #c084fc; } /* Light Purple */
        .bad-seat-badge { background-color: #60a5fa; } /* Light Blue */
        
        /* Seat Groups for layout control */
        .seat-group { display: flex; justify-content: center; }
        .seat-group-1 { width: 44px; } 
        .seat-group-2 { width: 85px; } 
        .seat-group-3 { width: 125px; } 

    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">

    const CLASS_BUSINESS = 'business';
    const CLASS_PREM_ECO = 'prem_eco';
    const CLASS_ECONOMY = 'economy';

    const CLASS_STYLES = {
        [CLASS_BUSINESS]: 'bg-red-900 border-2 border-red-800 text-red-50', 
        [CLASS_PREM_ECO]: 'bg-red-700 border border-red-600 text-red-50', 
        [CLASS_ECONOMY]: 'bg-red-600 border border-red-500 text-red-50 hover:bg-red-500',
    };

    const App = () => {
        const [variant, setVariant] = React.useState('900');
        const [occupiedSeats, setOccupiedSeats] = React.useState(new Set());
        const [selectedSeat, setSelectedSeat] = React.useState(null);
        const [randomGoodBiz, setRandomGoodBiz] = React.useState(new Set());

        // --- Configuration Data ---
        const getRows900 = () => {
            let rows = [];
            for (let i = 11; i <= 21; i++) {
                if (i === 13 || i === 14) continue;
                rows.push({ num: i, type: CLASS_BUSINESS, layout: '1-2-1' });
            }
            rows.push({ num: 25, type: CLASS_BUSINESS, layout: '1-2-1', exit: true });
            rows.push({ num: 26, type: CLASS_BUSINESS, layout: '1-2-1' });
            rows.push({ num: 27, type: CLASS_BUSINESS, layout: '1-2-1' });
            
            for (let i = 31; i <= 35; i++) rows.push({ num: i, type: CLASS_PREM_ECO, layout: '2-3-2', exit: i === 31 });

            for (let i = 43; i <= 50; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '3-3-3', exit: i === 43 });
            rows.push({ num: 51, type: CLASS_ECONOMY, layout: '2-3-2-rear' });
            for (let i = 56; i <= 71; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '3-3-3', exit: i === 56 });
            for (let i = 72; i <= 74; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '2-3-2-rear' });
            return rows;
        };

        const getRows1000 = () => {
            let rows = [];
            for (let i = 11; i <= 24; i++) {
                if (i === 13 || i === 14) continue;
                rows.push({ num: i, type: CLASS_BUSINESS, layout: '1-2-1' });
            }
            rows.push({ num: 28, type: CLASS_BUSINESS, layout: '1-2-1', exit: true });
            for (let i = 29; i <= 32; i++) rows.push({ num: i, type: CLASS_BUSINESS, layout: '1-2-1' });
            
            for (let i = 38; i <= 42; i++) rows.push({ num: i, type: CLASS_PREM_ECO, layout: '2-3-2', exit: i === 38 });

            for (let i = 48; i <= 57; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '3-3-3', exit: i === 48 });
            for (let i = 58; i <= 76; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '3-3-3', exit: i === 58 });
            for (let i = 77; i <= 79; i++) rows.push({ num: i, type: CLASS_ECONOMY, layout: '2-3-2-rear' });
            return rows;
        };

        const currentRows = variant === '900' ? getRows900() : getRows1000();

        // Random Occupancy & Business Good Seat Generation
        React.useEffect(() => {
            const newOccupied = new Set();
            const newGoodBiz = new Set();
            const rows = variant === '900' ? getRows900() : getRows1000();
            
            rows.forEach(row => {
                let seats = [];
                if (row.layout === '1-2-1') seats = ['A','D','G','K'];
                if (row.layout === '2-3-2') seats = ['A','C','D','F','G','H','K'];
                if (row.layout === '3-3-3') seats = ['A','B','C','D','F','G','H','J','K'];
                if (row.layout === '2-3-2-rear') seats = ['B','C','D','F','G','H','J'];

                seats.forEach(s => {
                    const id = `${row.num}${s}`;
                    if (Math.random() < (0.15 + Math.random() * 0.10)) {
                        newOccupied.add(id);
                    }
                    if (row.type === CLASS_BUSINESS && Math.random() < 0.20) {
                        newGoodBiz.add(id);
                    }
                });
            });
            setOccupiedSeats(newOccupied);
            setRandomGoodBiz(newGoodBiz);
            setSelectedSeat(null);
        }, [variant]);

        // Pricing, Features & Reasoning Logic (Updated per user request)
        const getSeatDetails = (rowNum, seatLetter, type) => {
            let price = 0;
            let label = "";
            let isPreferred = false;
            let isExtraLegroom = false;
            let isCheap = false;
            let isGood = false;
            let isBad = false;
            let reason = "";
            let wifi = "";

            // 1. Base Prices & WiFi
            if (type === CLASS_BUSINESS) {
                price = 3200; wifi = "Free High-Speed WiFi";
            } else if (type === CLASS_PREM_ECO) {
                price = 2150; wifi = "Free Messaging WiFi (£2.50 for High-Speed)";
            } else {
                price = 1500; wifi = "Free Messaging WiFi (£7.50 for High-Speed)";
            }

            // 2. Identify Boundary Rows
            const lastRows900 = [27, 35, 51, 74];
            const lastRows1000 = [32, 42, 57, 79];
            const lastRows = variant === '900' ? lastRows900 : lastRows1000;
            const rearTaperRows = variant === '900' ? [51, 72, 73, 74] : [77, 78, 79];
            
            // 3. Identify Extra Legroom & Preferred Seats
            if (variant === '900') {
                // Updated Preferred Seats (B, C, H, J in 51, and B, C, H, J in 72-74)
                if ((rowNum === 51 || [72, 73, 74].includes(rowNum)) && ['B','C','H','J'].includes(seatLetter)) isPreferred = true;
                if (rowNum === 43 || rowNum === 56 || (type === CLASS_PREM_ECO && rowNum === 31)) isExtraLegroom = true;
                if (rowNum >= 70 && rowNum <= 74) {
                    if (['B', 'F', 'J'].includes(seatLetter)) {
                        if (rowNum >= 72) { if (seatLetter === 'F') isCheap = true; } else { isCheap = true; }
                    }
                }
            } else { // 1000
                // Updated Preferred Seats (B, C, H, J in 77-79)
                if (rearTaperRows.includes(rowNum) && ['B','C','H','J'].includes(seatLetter)) isPreferred = true;
                if (rowNum === 48 || rowNum === 58 || (type === CLASS_PREM_ECO && rowNum === 38)) isExtraLegroom = true;
                if (rowNum >= 75 && rowNum <= 79) {
                     if (['B', 'F', 'J'].includes(seatLetter)) {
                        if (rowNum >= 77) { if (seatLetter === 'F') isCheap = true; } else { isCheap = true; }
                    }
                }
            }

            // 4. Set Base Good Status (All extra legroom is good)
            if (isExtraLegroom) { 
                isGood = true; 
                reason = "Extra legroom due to bulkhead/exit row.";
            }

            // 5. Specific Good/Bad Overrides

            // A. Business Class Logic (Noise Override & Random Good)
            const noisyRows = variant === '900' ? [11, 12, 27, 26, 31, 73, 74] : [11, 12, 32, 38, 78, 79]; 
            if (type === CLASS_BUSINESS) {
                const id = `${rowNum}${seatLetter}`;
                if (noisyRows.includes(rowNum)) {
                    isGood = false; 
                    isBad = true; 
                    reason = "Proximity to galley/lavatory reduces premium comfort.";
                } else if (randomGoodBiz.has(id)) {
                    isGood = true; 
                    reason = "Excellent comfort and privacy.";
                } else {
                    // Default Business seat status, no label needed
                    reason = "Direct aisle access & fully flat bed.";
                }
            }
            
            // B. Economy/PE Logic
            if (type !== CLASS_BUSINESS) {
                
                // Extra Floor Space (Good) - Window seats B/J in tapered sections (already handled by isPreferred)
                if (rearTaperRows.includes(rowNum) && ['B', 'J'].includes(seatLetter) && isPreferred) {
                    isGood = true; 
                    reason = "Preferred Seat: Extra floor space next to the window for bags/comfort.";
                }
                
                // C/H in 51, 72-74 (or 77-79) are Preferred (Good)
                if (isPreferred && ['C', 'H'].includes(seatLetter)) {
                    isGood = true;
                    isBad = false;
                    reason = "Preferred Seat: Excellent location near the front of the cabin section.";
                }

                // Limited Recline (Bad) - Last rows of any cabin section
                if (lastRows.includes(rowNum)) {
                    if (!isGood) {
                        isBad = true;
                        reason = "Limited recline due to wall/galley behind.";
                    }
                }
                
                // Middle Seat (Bad) - Only if cheap/rear AND not preferred/good
                if (isCheap && !isPreferred && !isExtraLegroom) {
                    isBad = true;
                    if (reason.includes("Limited recline")) {
                        reason = "Middle seat located in the rear cabin with limited recline.";
                    } else {
                        reason = "Middle seat located in the rear cabin.";
                    }
                }
            }

            // 6. Final Pricing Adjustments
            if (type === CLASS_ECONOMY) {
                if (isExtraLegroom || isPreferred) {
                    price = 1650; label = isExtraLegroom ? "Extra Legroom" : "Preferred Seat";
                } else if (isCheap) {
                    price = 1350; label = "Saver Economy";
                } else {
                    label = "Standard Economy";
                }
            } else {
                label = type === CLASS_BUSINESS ? "Business Class" : "Premium Economy";
            }
            
            // Clean up: Final check to ensure preferred seats are never bad
            if (isPreferred && isBad) isBad = false;
            // Bad always overrides Good unless a specific Good rule (like Preferred/Extra Legroom) is set.
            if (isBad && isGood && type !== CLASS_BUSINESS) isGood = false;


            return { price, label, isGood, isBad, reason, wifi };
        };

        const handleSeatClick = (row, seat) => {
            const id = `${row.num}${seat}`;
            if (occupiedSeats.has(id)) return;
            
            const details = getSeatDetails(row.num, seat, row.type);
            setSelectedSeat({ id, row: row.num, letter: seat, ...details });
        };

        // --- Render Helpers ---

        const renderSeat = (row, seat) => {
            const id = `${row.num}${seat}`;
            const isOccupied = occupiedSeats.has(id);
            // Check if selectedSeat is the current seat
            const isSelected = selectedSeat?.id === id;
            const details = getSeatDetails(row.num, seat, row.type);

            let classes = `seat ${CLASS_STYLES[row.type]} ${row.type}`;
            if (isOccupied) classes += ' occupied';
            // Use the new green selection class
            if (isSelected) classes = classes.replace(CLASS_STYLES[row.type], '') + ' selected'; 
            
            const showBadge = (details.isGood || details.isBad) && (details.isGood || details.isBad);

            const badge = !isOccupied && showBadge && (
                <>
                    {details.isGood && <div className="absolute top-[-2px] right-[-2px] w-2.5 h-2.5 rounded-full good-seat-badge border border-white"></div>}
                    {!details.isGood && details.isBad && <div className="absolute top-[-2px] right-[-2px] w-2.5 h-2.5 rounded-full bad-seat-badge border border-white"></div>}
                </>
            );

            return (
                <div key={seat} className={classes} onClick={() => handleSeatClick(row, seat)}>
                    {seat}
                    {badge}
                </div>
            );
        };

        const renderRow = (row) => {
            let left = [], mid = [], right = [];
            let leftClass = "", midClass = "", rightClass = "";

            if (row.layout === '1-2-1') {
                left = ['A']; mid = ['D', 'G']; right = ['K'];
                leftClass = "seat-group-1"; midClass = "seat-group-2"; rightClass = "seat-group-1";
            } else if (row.layout === '2-3-2') {
                left = ['A', 'C']; mid = ['D', 'F', 'G']; right = ['H', 'K'];
                leftClass = "seat-group-2"; midClass = "seat-group-3"; rightClass = "seat-group-2";
            } else if (row.layout === '3-3-3') {
                left = ['A', 'B', 'C']; mid = ['D', 'F', 'G']; right = ['H', 'J', 'K'];
                leftClass = "seat-group-3"; midClass = "seat-group-3"; rightClass = "seat-group-3";
            } else if (row.layout === '2-3-2-rear') {
                left = ['B', 'C']; mid = ['D', 'F', 'G']; right = ['H', 'J'];
                leftClass = "seat-group-2"; midClass = "seat-group-3"; rightClass = "seat-group-2";
            }

            return (
                <div key={row.num} className="relative mb-1">
                    {row.exit && (
                         <div className="flex justify-between px-4 mb-4 mt-6">
                            <div className="text-red-600 font-bold text-xs uppercase tracking-widest flex items-center"><i className="fas fa-chevron-left mr-1"></i> Exit</div>
                            <div className="text-red-600 font-bold text-xs uppercase tracking-widest flex items-center">Exit <i className="fas fa-chevron-right ml-1"></i></div>
                        </div>
                    )}
                    <div className="flex justify-between items-center">
                        <div className={`seat-group ${leftClass}`}>{left.map(s => renderSeat(row, s))}</div>
                        <div className="row-num">{row.num}</div>
                        <div className={`seat-group ${midClass}`}>{mid.map(s => renderSeat(row, s))}</div>
                        <div className="row-num">{row.num}</div>
                        <div className={`seat-group ${rightClass}`}>{right.map(s => renderSeat(row, s))}</div>
                    </div>
                </div>
            );
        };

        return (
            <div className="max-w-7xl mx-auto p-4 flex flex-col lg:flex-row gap-8">
                
                {/* Left Panel: Controls & Info */}
                <div className="lg:w-[380px] space-y-6 shrink-0">
                    {/* Header & Variant Select */}
                    <div className="bg-white p-6 rounded-2xl shadow-sm border-t-4 border-red-900">
                        <div className="flex items-center gap-4 mb-6">
                            <div className="w-14 h-14 bg-red-900 rounded-full flex items-center justify-center">
                                <i className="fas fa-plane-departure text-2xl text-white"></i>
                            </div>
                            <div>
                                <h1 className="text-2xl font-black text-gray-900 tracking-tight">Otono Airways</h1>
                                <p className="text-gray-500 font-medium">Airbus A350 Seat Map</p>
                            </div>
                        </div>

                        <div className="flex bg-gray-100 p-1 rounded-xl mb-4">
                            <button onClick={() => setVariant('900')} className={`flex-1 py-2.5 rounded-lg font-bold text-sm transition-all ${variant === '900' ? 'bg-white text-red-900 shadow-sm' : 'text-gray-500 hover:text-gray-700'}`}>A350-900</button>
                            <button onClick={() => setVariant('1000')} className={`flex-1 py-2.5 rounded-lg font-bold text-sm transition-all ${variant === '1000' ? 'bg-white text-red-900 shadow-sm' : 'text-gray-500 hover:text-gray-700'}`}>A350-1000</button>
                        </div>
                        
                        <p className="text-center text-sm font-medium text-gray-600">Showing configuration for <span className="text-red-900">{variant === '900' ? '24' : '9'} aircraft</span>. <span className="text-red-500 font-bold"></span></p>
                        <a href="index.html">Return To Main Menu</a>
                    </div>

                    {/* WiFi Info */}
                     <div className="bg-white p-6 rounded-2xl shadow-sm">
                        <h3 className="font-bold text-gray-900 mb-4 flex items-center"><i className="fas fa-wifi mr-2 text-blue-500"></i> In-Flight WiFi</h3>
                        <ul className="space-y-3 text-sm">
                            <li className="flex items-start"><span className="font-bold text-red-900 w-24 shrink-0">Business</span> <span>Free High-Speed WiFi</span></li>
                            <li className="flex items-start"><span className="font-bold text-red-700 w-24 shrink-0">Premium Economy</span> <span>Free Messaging. £2.50 High-Speed.</span></li>
                            <li className="flex items-start"><span className="font-bold text-red-600 w-24 shrink-0">Economy</span> <span>Free Messaging. £7.50 High-Speed.</span></li>
                        </ul>
                    </div>

                    {/* Selected Seat Card */}
                    <div className={`rounded-2xl shadow-lg overflow-hidden transition-all duration-300 ${selectedSeat ? 'opacity-100 translate-y-0' : 'opacity-50 translate-y-4 pointer-events-none'}`}>
                        {selectedSeat ? (
                            <div>
                                <div className={`p-4 ${selectedSeat.isGood ? 'bg-purple-50' : selectedSeat.isBad ? 'bg-blue-50' : 'bg-gray-50'} border-b`}>
                                    <h2 className="text-sm font-bold text-gray-500 uppercase tracking-wider mb-1">Selected Seat</h2>
                                    <div className="flex justify-between items-baseline">
                                        <div className="text-4xl font-black text-gray-900">{selectedSeat.id}</div>
                                        <div className="text-2xl font-black text-green-600">£{selectedSeat.price}</div>
                                    </div>
                                    <div className="font-bold text-lg mt-1" style={{color: selectedSeat.label.includes('Business') ? '#7f1d1d' : selectedSeat.label.includes('Prem') ? '#b91c1c' : '#dc2626'}}>{selectedSeat.label}</div>
                                </div>
                                
                                <div className="bg-white p-5 space-y-4">
                                    {/* Reason */}
                                    {selectedSeat.reason && (
                                        <div className="flex items-start">
                                            <div className={`mt-1 mr-3 shrink-0 ${selectedSeat.isGood ? 'text-purple-500' : 'text-blue-500'}`}>
                                                <i className={`fas ${selectedSeat.isGood ? 'fa-thumbs-up' : 'fa-info-circle'}`}></i>
                                            </div>
                                            <p className="text-sm font-medium text-gray-700 leading-tight">{selectedSeat.reason}</p>
                                        </div>
                                    )}
                                    
                                    {/* WiFi for this seat */}
                                    <div className="flex items-start border-t pt-4">
                                        <div className="mt-1 mr-3 shrink-0 text-blue-500"><i className="fas fa-wifi"></i></div>
                                        <p className="text-sm font-medium text-gray-700 leading-tight">{selectedSeat.wifi}</p>
                                    </div>

                                    <button className="w-full bg-gray-900 text-white py-3.5 rounded-xl font-bold text-sm hover:bg-black transition transform active:scale-[0.98]">
                                        Confirm Seat {selectedSeat.id}
                                    </button>
                                </div>
                            </div>
                        ) : (
                             <div className="bg-white p-8 text-center text-gray-400 italic rounded-2xl border-2 border-dashed">
                                Select a seat on the map to view details.
                            </div>
                        )}
                    </div>

                    {/* Legend */}
                    <div className="bg-white p-5 rounded-2xl shadow-sm">
                         <h3 className="font-bold text-gray-900 mb-3 text-sm">Map Key</h3>
                         <div className="grid grid-cols-2 gap-y-2 gap-x-4 text-xs font-medium text-gray-700">
                            <div className="flex items-center"><div className="w-4 h-4 bg-red-900 border border-red-800 mr-2 rounded-sm"></div> Business</div>
                            <div className="flex items-center"><div className="w-4 h-4 bg-red-700 border border-red-600 mr-2 rounded-sm"></div> Premium Economy</div>
                            <div className="flex items-center"><div className="w-4 h-4 bg-red-600 border border-red-500 mr-2 rounded-sm"></div> Economy</div>
                            <div className="flex items-center"><div className="w-4 h-4 bg-gray-300 border border-gray-400 mr-2 rounded-sm"></div> Occupied</div>
                         </div>
                         <div className="mt-4 border-t pt-3 grid grid-cols-2 gap-y-2 text-xs font-medium">
                            <div className="flex items-center">
                                <div className="w-3 h-3 rounded-full good-seat-badge mr-2"></div>
                                <span>Good Seat (Preferred)</span>
                            </div>
                            <div className="flex items-center">
                                <div className="w-3 h-3 rounded-full bad-seat-badge mr-2"></div>
                                <span>Bad Seat (Noise/Limited Recline)</span>
                            </div>
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-green-500 border border-green-600 mr-2 rounded-sm"></div>
                                <span>Selected Seat</span>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Right Panel: The Plane */}
                <div className="flex-1 overflow-x-auto pb-12 pt-4 pl-4">
                    <div className="fuselage">
                        <div className="cockpit"></div>
                        
                        {/* Render Rows */}
                        <div className="mt-12 relative z-10">
                            {currentRows.map(row => renderRow(row))}
                        </div>

                        {/* Rear Galley Visual */}
                        <div className="mt-16 pt-6 border-t-2 border-dashed border-gray-300 text-center">
                             <div className="flex justify-center gap-16 text-gray-400 mb-2">
                                <i className="fas fa-restroom fa-lg"></i>
                                <i className="fas fa-utensils fa-lg"></i>
                                <i className="fas fa-restroom fa-lg"></i>
                            </div>
                            <div className="text-gray-400 text-xs font-bold tracking-[0.3em]">REAR GALLEY</div>
                        </div>
                    </div>
                </div>

            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>