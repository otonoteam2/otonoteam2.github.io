<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üü£ Otono French ‚Äî Reading (SAM) ‚Ä¢ Sample set 1</title>
  <style>
    :root{
      --bg1:#2b0a3d; --bg2:#7a0036;
      --card:#0f0b18cc; --card2:#120c22e6;
      --text:#f4efff; --muted:#c9b9ff;
      --accent:#b000ff; --accent2:#ff1b6a;
      --good:#19ff9a; --warn:#ffd166; --bad:#ff4d6d;
      --line:rgba(255,255,255,.12);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--sans); color:var(--text);
      background:
        radial-gradient(1000px 700px at 15% 10%, rgba(176,0,255,.22), transparent 60%),
        radial-gradient(900px 650px at 80% 20%, rgba(255,27,106,.18), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    .wrap{max-width:1100px; margin:0 auto; padding:22px;}
    .topbar{
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      padding:14px 16px; border:1px solid var(--line); border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      position:sticky; top:14px; z-index:20; backdrop-filter: blur(10px);
    }
    .brand{display:flex; flex-direction:column; gap:2px}
    .brand h1{margin:0; font-size:16px; letter-spacing:.3px}
    .brand .sub{font-size:12px; color:var(--muted)}
    .pill{
      padding:8px 10px; border-radius:999px; border:1px solid var(--line);
      background:rgba(0,0,0,.25); font-family:var(--mono); font-size:12px;
      display:flex; gap:10px; align-items:center;
    }
    .pill strong{color:#fff}
    .btn{
      border:1px solid var(--line); background:rgba(0,0,0,.25);
      color:var(--text); padding:10px 12px; border-radius:14px; cursor:pointer;
      transition:.15s transform, .15s background, .15s border;
      font-weight:600;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(0,0,0,.33); border-color:rgba(255,255,255,.22)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(176,0,255,.55), rgba(255,27,106,.45));
      border-color:rgba(255,255,255,.22);
    }
    .btn.danger{background:rgba(255,77,109,.18); border-color:rgba(255,77,109,.35)}
    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:16px; margin-top:16px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} .topbar{position:static} }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px; border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent);
    }
    .card .hd h2{margin:0; font-size:14px}
    .card .hd .meta{font-size:12px; color:var(--muted); line-height:1.25}
    .card .bd{padding:16px}
    label{display:block; font-size:12px; color:var(--muted); margin:10px 0 6px}

    input[type="text"], input[type="number"], textarea, select{
      width:100%; border:1px solid var(--line); background:rgba(0,0,0,.25);
      color:var(--text); padding:10px 12px; border-radius:14px; outline:none;
      font-family:var(--sans);
    }
    textarea{min-height:90px; resize:vertical}

    .row{display:flex; gap:10px; flex-wrap:wrap}
    .row > div{flex:1 1 180px}

    .note{
      font-size:12px; color:var(--muted); line-height:1.4;
      padding:10px 12px; border-radius:14px; border:1px dashed rgba(255,255,255,.18);
      background:rgba(0,0,0,.18);
    }
    .badge{
      font-family:var(--mono); font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid var(--line); background:rgba(0,0,0,.20);
      display:inline-flex; align-items:center; gap:6px;
    }
    .badge.good{border-color:rgba(25,255,154,.35); background:rgba(25,255,154,.12)}
    .badge.warn{border-color:rgba(255,209,102,.35); background:rgba(255,209,102,.12)}
    .badge.bad{border-color:rgba(255,77,109,.35); background:rgba(255,77,109,.12)}
    .divider{height:1px; background:var(--line); margin:14px 0}
    .passage{
      padding:12px 14px; border:1px solid var(--line); border-radius:16px;
      background:rgba(0,0,0,.22); line-height:1.5;
    }
    .q{
      margin-top:14px; padding:12px 14px; border:1px solid var(--line);
      border-radius:16px; background:rgba(0,0,0,.20);
    }
    .q h3{margin:0 0 8px; font-size:13px}
    .opts{display:grid; gap:8px; margin-top:8px}
    .opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 10px; border-radius:14px; border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      cursor:pointer;
    }
    .opt input{margin-top:3px}
    .kpi{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    @media (max-width: 980px){ .kpi{grid-template-columns:repeat(2,1fr)} }
    .kpi .box{
      border:1px solid var(--line); border-radius:16px; padding:10px 12px;
      background:rgba(0,0,0,.22);
    }
    .kpi .box .t{font-size:12px; color:var(--muted)}
    .kpi .box .v{font-size:18px; font-weight:800; margin-top:4px}
    .small{font-size:12px; color:var(--muted)}
    .tabs{display:flex; gap:8px; flex-wrap:wrap}
    .tab{padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(0,0,0,.22); cursor:pointer; font-weight:700}
    .tab.active{background:linear-gradient(135deg, rgba(176,0,255,.35), rgba(255,27,106,.22)); border-color:rgba(255,255,255,.22)}
    .resultsList{display:grid; gap:10px}
    .attempt{
      border:1px solid var(--line); border-radius:16px; padding:12px 14px;
      background:rgba(0,0,0,.20);
    }
    .attempt .top{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .attempt .top strong{font-family:var(--mono)}
    .attempt .meta{font-size:12px; color:var(--muted); margin-top:6px; line-height:1.4}
    .copy{font-family:var(--mono); font-size:12px; white-space:pre-wrap; word-break:break-word}
    .hide{display:none !important}

    /* Candidate number 4 squares */
    .digitRow{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .digitRow .digit{
      width:52px; text-align:center; font-family:var(--mono);
      font-size:18px; font-weight:900; padding:12px 0;
      border-radius:14px; border:1px solid var(--line);
      background:rgba(0,0,0,.25); color:var(--text);
      outline:none;
    }
    .digitRow .hint{font-size:12px; color:var(--muted)}
    .miniRow{display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end}
    .miniRow > *{flex:1 1 160px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <h1>üü£ Otono French ‚Äî Paper 3 ‚Ä¢ Reading ‚Ä¢ Sample Assessment Material ‚Ä¢ Sample set 1</h1>
        <div class="sub">
          Auto marking ‚Ä¢ 4 random passages √ó 20 + 1 translation √ó 20 = 100 ‚Ä¢ Centre:
          <strong id="centreTop">50749</strong>
        </div>
      </div>
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end">
        <div class="pill">
          <span>‚è±Ô∏è Timer:</span>
          <strong id="timerText">--:--</strong>
        </div>
        <button class="btn" id="btnResults">Results</button>
        <button class="btn primary" id="btnHome">Test</button>
      </div>
    </div>

    <div class="grid">
      <!-- Left: main -->
      <div class="card" id="panelHome">
        <div class="hd">
          <div>
            <h2>Candidate setup</h2>
            <div class="meta">No dictionary ‚Ä¢ No translator ‚Ä¢ Answer from the text ‚Ä¢ Auto marking for written answers uses keywords (not perfect).</div>
          </div>
          <span class="badge" id="statusBadge">Ready</span>
        </div>

        <div class="bd" id="homeBody">
          <div class="miniRow">
            <div>
              <label>Centre number</label>
              <input type="text" id="centreNo" value="50749" disabled />
              <div class="small" style="margin-top:6px">
                Default is <strong>50749</strong>. You can change it (optional) with the button.
              </div>
            </div>
            <div style="display:flex; gap:10px; align-items:flex-end; flex-wrap:wrap">
              <button class="btn" id="btnEditCentre">Customise centre</button>
              <button class="btn" id="btnResetCentre">Reset centre</button>
            </div>
          </div>

          <div class="divider"></div>

          <div>
            <label>Candidate number (required, 4 digits)</label>
            <div class="digitRow" aria-label="Candidate number 4 digits">
              <input class="digit" id="candD1" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD2" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD3" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD4" inputmode="numeric" maxlength="1" />
              <span class="hint">Digits only ‚Ä¢ auto-advance</span>
            </div>
          </div>

          <div class="row" style="margin-top:6px">
            <div>
              <label>Candidate surname (optional)</label>
              <input type="text" id="candSurname" placeholder="Surname" />
            </div>
            <div>
              <label>Candidate forename(s) (optional)</label>
              <input type="text" id="candForenames" placeholder="Forename(s)" />
            </div>
          </div>

          <div class="divider"></div>

          <div class="note">
            <strong>How the random paper works (SAM set 1):</strong><br/>
            ‚Ä¢ The system selects <strong>4 random passages</strong> (each worth <strong>20</strong>) and <strong>1 random translation</strong> (worth <strong>20</strong>).<br/>
            ‚Ä¢ You‚Äôll get a mix of <strong>MCQ</strong>, <strong>P/N/P+N</strong>, <strong>True/False/Not mentioned</strong>, and <strong>written answers</strong>.<br/>
            ‚Ä¢ Some passages include <strong>questions answered in French</strong> (you must answer in French).<br/>
            ‚Ä¢ Written + translation answers are marked by <strong>keyword coverage</strong> (so write clear, direct answers).<br/>
            ‚Ä¢ Your attempt is saved to this browser using <strong>localStorage</strong>.
          </div>

          <div class="divider"></div>

          <div class="row">
            <div>
              <label>Time allowed</label>
              <select id="timeAllowed">
                <option value="75" selected>75 minutes (recommended)</option>
                <option value="60">60 minutes</option>
                <option value="45">45 minutes</option>
              </select>
            </div>
            <div>
              <label>Question order</label>
              <select id="shuffleMode">
                <option value="shuffleAll" selected>Shuffle questions (harder)</option>
                <option value="keepOrder">Keep original order</option>
              </select>
            </div>
            <div>
              <label>On timer end</label>
              <select id="autoSubmit">
                <option value="yes" selected>Auto-submit</option>
                <option value="no">Do not auto-submit</option>
              </select>
            </div>
          </div>

          <div style="display:flex; gap:10px; margin-top:14px; flex-wrap:wrap">
            <button class="btn primary" id="btnStart">Start Random Paper</button>
            <button class="btn" id="btnPreview">Preview Random Selection</button>
          </div>

          <div id="previewBox" class="note hide" style="margin-top:12px"></div>
        </div>

        <!-- Test body -->
        <div class="bd hide" id="testBody">
          <div class="kpi">
            <div class="box"><div class="t">Candidate</div><div class="v" id="kpiCandidate">‚Äî</div></div>
            <div class="box"><div class="t">Selected passages</div><div class="v" id="kpiPassages">‚Äî</div></div>
            <div class="box"><div class="t">Translation</div><div class="v" id="kpiTranslation">‚Äî</div></div>
            <div class="box"><div class="t">Max score</div><div class="v">100</div></div>
          </div>

          <div class="divider"></div>

          <div class="note">
            <strong>Instructions reminder:</strong>
            No dictionary. Do not copy from outside. Base answers on the passage. For written answers, include the key idea(s) clearly.
          </div>

          <div id="paper"></div>

          <div class="divider"></div>

          <div style="display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn primary" id="btnSubmit">Submit & Auto-Mark</button>
            <button class="btn" id="btnReset">Reset (new random paper)</button>
          </div>

          <div id="markingBox" class="hide" style="margin-top:14px"></div>
        </div>
      </div>

      <!-- Right: results / help -->
      <div class="card" id="panelSide">
        <div class="hd">
          <div>
            <h2 id="sideTitle">Otono grading</h2>
            <div class="meta" id="sideMeta">Score ‚Üí Otono grade + GCSE estimate + Pass/Merit/Distinction.</div>
          </div>
        </div>

        <div class="bd" id="sideBody">
          <div class="note">
            <strong>Pass/Merit/Distinction</strong><br/>
            PASS: 66+<br/>
            MERIT: 80+<br/>
            DISTINCTION: 90+<br/>
          </div>
          <div class="divider"></div>
          <div class="note">
            <strong>Otono grades (A‚ÄìH + secret S)</strong><br/>
            S: 101+ (secret)<br/>
            A*: 95‚Äì100<br/>
            A: 90‚Äì94<br/>
            B: 80‚Äì89<br/>
            C: 70‚Äì79<br/>
            D: 66‚Äì69<br/>
            E: 55‚Äì65<br/>
            F: 45‚Äì54<br/>
            G: 30‚Äì44<br/>
            H: 15‚Äì29<br/>
            U: 0‚Äì14
          </div>
          <div class="divider"></div>
          <div class="note">
            <strong>GCSE 9‚Äì1 estimate (simple mapping)</strong><br/>
            9: 90‚Äì100 ‚Ä¢ 8: 80‚Äì89 ‚Ä¢ 7: 70‚Äì79 ‚Ä¢ 6: 60‚Äì69 ‚Ä¢ 5: 50‚Äì59<br/>
            4: 40‚Äì49 ‚Ä¢ 3: 30‚Äì39 ‚Ä¢ 2: 20‚Äì29 ‚Ä¢ 1: 10‚Äì19 ‚Ä¢ U: 0‚Äì9
          </div>
          <div class="divider"></div>
          <div class="small">
            Tip: results are stored locally on this device/browser only. If you clear site data, they disappear.
          </div>
        </div>

        <!-- Results panel -->
        <div class="bd hide" id="resultsBody">
          <div class="tabs">
            <div class="tab active" id="tabAll">All attempts</div>
            <div class="tab" id="tabCandidate">By candidate</div>
          </div>

          <div class="row" style="margin-top:10px">
            <div>
              <label>Filter candidate number (4 digits)</label>
              <input type="text" id="filterCandidate" placeholder="e.g. 1105" inputmode="numeric" />
            </div>
            <div>
              <label>Actions</label>
              <div style="display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn" id="btnExport">Export JSON</button>
                <button class="btn danger" id="btnClear">Clear stored results</button>
              </div>
            </div>
          </div>

          <div class="divider"></div>
          <div class="resultsList" id="resultsList"></div>

          <div id="exportBox" class="note hide" style="margin-top:12px">
            <div><strong>Exported JSON</strong> (copy/save it):</div>
            <div class="divider"></div>
            <div class="copy" id="exportText"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* -----------------------------
   OTONO BANK (STRAIGHTFORWARD TEXT, SIMILAR LENGTH)
   Each passage total = 20 marks
--------------------------------*/

const PASSAGES = [
  {
    id: 1,
    title: "Passage 1 ‚Äî Monsieur Barley et la m√©thode",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 1 (Monsieur Barley)",
    text: `Monsieur Barley est professeur de sciences √† l‚Äô√©cole Otono. Il parle calmement et il aime que tout soit clair. Dans sa salle, il y a des r√®gles simples : les cahiers sont rang√©s, les tables sont propres et le mat√©riel est pr√™t avant le cours. Les √©l√®ves disent qu‚Äôil est strict, mais Monsieur Barley r√©pond : ¬´ Je veux surtout que ce soit pr√©cis. ¬ª

Avant chaque contr√¥le, il r√©p√®te la m√™me id√©e : il faut lire la consigne et r√©pondre exactement √† la question. Il explique qu‚Äôun √©l√®ve peut conna√Ætre le sujet, mais perdre des points si la r√©ponse n‚Äôest pas compl√®te. Par exemple, si la question demande une justification, √©crire un seul mot ne suffit pas. Si la question demande deux raisons, donner une seule raison n‚Äôest pas assez.

Red √©coute et il essaie de changer sa fa√ßon de travailler. Il relit la question, il souligne les mots importants et il v√©rifie le nombre de d√©tails demand√©s. Il pense que ce petit effort peut √©viter des erreurs simples.`,
    questions: [
      { id:"p1q1", type:"mcq", marks:2,
        prompt:"(E) What is Monsieur Barley‚Äôs subject?",
        options:["Science","Music","PE","English"],
        answerIndex:0
      },
      { id:"p1q2", type:"short", marks:4,
        prompt:"(E) Give TWO classroom rules/details mentioned.",
        rubric:"Any two: notebooks put away; tables clean; equipment ready before lesson; rules are simple; everything must be clear.",
        keywords:[
          ["cahiers","ranges","rang√©s","ranger","notebooks","put away"],
          ["tables","propres","propre","clean"],
          ["mat√©riel","materiel","pr√™t","pret","ready","equipment"],
          ["r√®gles","regles","simple","rules"],
          ["clair","claire","clear"]
        ]
      },
      { id:"p1q3", type:"tfnm", marks:2,
        prompt:"(E) Monsieur Barley speaks calmly. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p1q4", type:"short", marks:4,
        prompt:"(E) What does Monsieur Barley repeat before tests?",
        rubric:"He says you must read the instructions and answer exactly what is asked.",
        keywords:[
          ["lire","read"],
          ["consigne","instructions","instruction"],
          ["r√©pondre","repondre","answer"],
          ["exactement","exactly"],
          ["question","asked"]
        ]
      },
      { id:"p1q5", type:"short", marks:6,
        prompt:"(H) Give ONE example of how a student could lose marks, and what they should do to avoid it.",
        rubric:"Example: if justification is required, you must explain; if two reasons are required, give two reasons (not one).",
        keywords:[
          ["justification","justify","expliquer","explain","parce que","because","car"],
          ["deux","two"],
          ["raisons","reasons"],
          ["donner","give"],
          ["au lieu","instead","rather than"]
        ]
      },
      { id:"p1q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Que fait Red pour √©viter des erreurs simples ? Donne DEUX actions.",
        rubric:"Deux parmi : il relit la question ; il souligne les mots importants ; il v√©rifie le nombre de d√©tails demand√©s.",
        keywords:[
          ["relit","relire","question"],
          ["souligne","souligner","mots","importants"],
          ["v√©rifie","verifie","nombre","d√©tails","details","demand√©s","demandes"]
        ]
      }
    ]
  },

  {
    id: 2,
    title: "Passage 2 ‚Äî L‚Äôencre et les consignes",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 2 (Ink system)",
    text: `Avant les examens √† Otono, on parle souvent des stylos. Certains √©l√®ves √©crivent sans se poser de questions. D‚Äôautres stressent, parce qu‚Äôils ont peur d‚Äôutiliser le mauvais stylo et de perdre des points.

Luke aime l‚Äôencre noire. Il dit que c‚Äôest propre et facile √† lire. En maths, on demande souvent d‚Äô√©crire en noir, car les copies sont scann√©es. Mais en sciences, les √©l√®ves entendent parfois des consignes diff√©rentes : on peut demander d‚Äô√©viter certaines encres, ou de suivre une r√®gle particuli√®re pour un document.

Cette situation peut cr√©er de la confusion. La veille d‚Äôun examen, certains √©l√®ves pr√©parent deux stylos. D‚Äôautres demandent au professeur. Red choisit une strat√©gie simple : il reste calme et il lit la consigne √©crite sur la feuille d‚Äôexamen, car c‚Äôest la r√®gle officielle.`,
    questions: [
      { id:"p2q1", type:"mcq", marks:2,
        prompt:"(E) Why do some students stress before exams?",
        options:["They fear using the wrong pen","They want extra homework","They dislike reading","They forget lunch"],
        answerIndex:0
      },
      { id:"p2q2", type:"short", marks:4,
        prompt:"(E) Give TWO reasons Luke likes black ink.",
        rubric:"Any two: it is clean/neat; easy to read; clear.",
        keywords:[
          ["propre","clean","neat"],
          ["facile","easy"],
          ["lire","read","lisible"],
          ["clair","clear"]
        ]
      },
      { id:"p2q3", type:"tfnm", marks:2,
        prompt:"(E) In maths, copies are scanned. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p2q4", type:"short", marks:4,
        prompt:"(E) Why can the pen rules be confusing?",
        rubric:"Because instructions can differ between subjects (e.g., maths vs science), and some inks may be avoided in certain papers.",
        keywords:[
          ["consignes","instructions"],
          ["diff√©rentes","different","differ"],
          ["maths","math"],
          ["sciences","science"],
          ["√©viter","eviter","avoid","encres","inks"]
        ]
      },
      { id:"p2q5", type:"short", marks:6,
        prompt:"(H) What does Red do the day before / during the exam to solve the pen problem, and why is this sensible?",
        rubric:"He stays calm and reads the written instructions on the exam paper; sensible because the written instructions are the official rule.",
        keywords:[
          ["calme","calm"],
          ["lit","lire","read"],
          ["consigne","instructions"],
          ["feuille","paper"],
          ["officielle","official","r√®gle","regle","rule"]
        ]
      },
      { id:"p2q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Donne UNE solution propos√©e dans le texte pour √©viter la confusion sur les stylos.",
        rubric:"Une solution : pr√©parer deux stylos / demander au professeur / lire la consigne sur la feuille d‚Äôexamen.",
        keywords:[
          ["pr√©parer","preparer","deux","stylos"],
          ["demander","professeur"],
          ["lire","consigne","feuille"]
        ]
      }
    ]
  },

  {
    id: 3,
    title: "Passage 3 ‚Äî Choisir ses options",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 3 (GCSE options)",
    text: `Choisir ses options GCSE est important pour beaucoup d‚Äô√©l√®ves. Certains choisissent vite, parce qu‚Äôils savent d√©j√† ce qu‚Äôils veulent faire. D‚Äôautres h√©sitent, car ils aiment plusieurs mati√®res ou ils ont peur de se tromper.

√Ä Otono, il y a aussi des contraintes : il peut y avoir un nombre limit√© de places dans une classe, et certaines mati√®res peuvent √™tre au m√™me moment dans l‚Äôemploi du temps. Thomas h√©site sur le fran√ßais. Il aime la mati√®re, mais il se demande s‚Äôil sera assez bon. Il parle avec d‚Äôautres √©l√®ves et il comprend qu‚Äôils ont les m√™mes inqui√©tudes.

Finalement, Thomas choisit le fran√ßais. L‚Äô√©cole accepte son choix, m√™me si c‚Äôest un peu tard. Pour lui, c‚Äôest rassurant : si on explique bien sa situation, le syst√®me peut √™tre flexible.`,
    questions: [
      { id:"p3q1", type:"mcq", marks:2,
        prompt:"(E) What is the passage mainly about?",
        options:["Choosing GCSE options","A sports match","A school trip","Cooking lessons"],
        answerIndex:0
      },
      { id:"p3q2", type:"short", marks:4,
        prompt:"(E) Give TWO reasons some students hesitate when choosing options.",
        rubric:"Any two: they like several subjects; fear making the wrong choice; worry they aren‚Äôt good enough; timetable clashes; limited class places.",
        keywords:[
          ["plusieurs","mati√®res","several","subjects"],
          ["peur","fear","tromper","wrong"],
          ["assez bon","good enough"],
          ["emploi du temps","timetable","m√™me moment","same time","clash"],
          ["places","limit√©","limited"]
        ]
      },
      { id:"p3q3", type:"tfnm", marks:2,
        prompt:"(E) Thomas hates French. (True / False / Not mentioned)",
        correct:"False"
      },
      { id:"p3q4", type:"short", marks:4,
        prompt:"(E) Give ONE constraint the school has when organising options.",
        rubric:"Example: limited places in a class; some subjects at the same time on the timetable.",
        keywords:[
          ["places","limit√©","limited"],
          ["classe","class"],
          ["emploi du temps","timetable"],
          ["m√™me moment","same time"]
        ]
      },
      { id:"p3q5", type:"short", marks:6,
        prompt:"(H) What helps Thomas make his decision, and what happens in the end?",
        rubric:"He talks to other students and realises they share worries; he chooses French; the school accepts even though it is a bit late.",
        keywords:[
          ["parle","talk"],
          ["autres","√©l√®ves","eleves","others","students"],
          ["m√™mes","memes","inqui√©tudes","worries"],
          ["choisit","choose","fran√ßais","french"],
          ["accepte","accept"]
        ]
      },
      { id:"p3q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi le syst√®me est-il ‚Äòflexible‚Äô selon Thomas ?",
        rubric:"Parce que si on explique bien sa situation, l‚Äô√©cole peut accepter un changement m√™me un peu tard.",
        keywords:[
          ["expliquer","explique"],
          ["situation"],
          ["accepter","accepte"],
          ["changement","changer"],
          ["tard"]
        ]
      }
    ]
  },

  {
    id: 4,
    title: "Passage 4 ‚Äî Dans la salle d‚Äôexamen",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Exam rules)",
    text: `Le jour de l‚Äôexamen, l‚Äôambiance change dans le couloir. Les √©l√®ves parlent moins. Certains relisent une derni√®re fois leurs notes. D‚Äôautres attendent en silence. Quand la porte s‚Äôouvre, tout le monde entre calmement.

Dans la salle, les tables sont espac√©es et les sacs sont plac√©s √† l‚Äôavant. L‚Äôinvigilateur attend que tout le monde soit assis, puis il lit les consignes : √©crire clairement, pas de t√©l√©phone, et respecter la liste d‚Äôobjets interdits.

Quand il parle de cette liste, quelques √©l√®ves paniquent. Ils se demandent s‚Äôils ont oubli√© quelque chose dans une poche. Red, lui, reste concentr√©. Il se r√©p√®te qu‚Äôune petite erreur peut co√ªter des points, mais que le plus important est de suivre les consignes jusqu‚Äô√† la fin.`,
    questions: [
      { id:"p4q1", type:"mcq", marks:2,
        prompt:"(E) Where are the bags placed in the exam room?",
        options:["At the front","Under each chair","Outside the school","On the tables"],
        answerIndex:0
      },
      { id:"p4q2", type:"short", marks:4,
        prompt:"(E) Give TWO exam-room details from the passage.",
        rubric:"Any two: tables spaced; bags at the front; invigilator reads instructions; phones not allowed; list of forbidden items.",
        keywords:[
          ["tables","espac√©es","spaced"],
          ["sacs","bags","avant","front"],
          ["invigilateur","lit","reads","consignes"],
          ["t√©l√©phone","telephone","phone"],
          ["objets","interdits","forbidden","liste","list"]
        ]
      },
      { id:"p4q3", type:"tfnm", marks:2,
        prompt:"(E) Students are allowed to use phones. (True / False / Not mentioned)",
        correct:"False"
      },
      { id:"p4q4", type:"short", marks:4,
        prompt:"(E) Why do some students panic?",
        rubric:"They worry they forgot a forbidden item in a pocket.",
        keywords:[
          ["paniquent","panic"],
          ["oubli√©","oublie","forgot"],
          ["poche","pocket"],
          ["interdit","forbidden","objets","items"]
        ]
      },
      { id:"p4q5", type:"short", marks:6,
        prompt:"(H) What does Red tell himself to stay calm, and what does he focus on?",
        rubric:"He reminds himself small mistakes can lose marks, but the most important thing is to follow the instructions until the end; he stays focused.",
        keywords:[
          ["petite","small"],
          ["erreur","mistake"],
          ["co√ªter","cost","points"],
          ["plus important","most important"],
          ["suivre","follow","consignes","instructions"],
          ["jusqu‚Äô√† la fin","until the end"]
        ]
      },
      { id:"p4q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Quelles sont DEUX consignes lues par l‚Äôinvigilateur ?",
        rubric:"Deux parmi : √©crire clairement ; pas de t√©l√©phone ; respecter la liste d‚Äôobjets interdits.",
        keywords:[
          ["√©crire","ecrire","clairement"],
          ["pas","t√©l√©phone","telephone"],
          ["respecter","liste","objets","interdits"]
        ]
      }
    ]
  },

  {
  id: 5,
  title: "Passage 5 ‚Äî Le serveur Minecraft Otono : coop√©ration et tensions",
  theme: "Theme 2 ‚Äî Free time",
  unit: "Unit 5 (Minecraft server)",
  text: `Sur le serveur Minecraft Otono, les joueurs construisent souvent en √©quipe. Avant une grande construction, ils choisissent un objectif clair : une maison, une tour, ou une zone enti√®re du monde. Ensuite, ils se r√©partissent les t√¢ches. Par exemple, une personne r√©colte les mat√©riaux, une autre construit la structure, et une autre v√©rifie les d√©tails pour √©viter les erreurs.

Cette organisation aide beaucoup, mais elle peut aussi cr√©er des tensions. Red aime aller vite et il veut voir des r√©sultats imm√©diatement. OWing pr√©f√®re avancer plus lentement : il relit le plan, il corrige les petites erreurs, et il insiste sur la pr√©cision. Parfois, Red pense qu‚ÄôOWing ralentit tout. Parfois, OWing pense que Red va trop vite et oublie des d√©tails.

Quand ils suivent une m√©thode simple, le projet avance mieux. Ils fixent d‚Äôabord une √©tape rapide (la structure), puis une √©tape de v√©rification (les d√©tails). Gr√¢ce √† ce rythme, ils gagnent du temps, car ils √©vitent de refaire le travail plus tard.`,
  questions: [
    { id:"p5q1", type:"mcq", marks:2,
      prompt:"(E) On the Otono Minecraft server, players usually build‚Ä¶",
      options:["Alone","In teams","Only in silence","Without a plan"],
      answerIndex:1
    },
    { id:"p5q2", type:"short", marks:4,
      prompt:"(E) Give TWO example roles mentioned in the passage.",
      rubric:"Two roles such as: collect materials; build the structure; check details/correct errors.",
      keywords:[
        ["r√©colte","recolte","materials","mat√©riaux","collect"],
        ["construit","build","structure"],
        ["v√©rifie","verifie","check","d√©tails","details"],
        ["corrige","correct","erreurs","errors"]
      ]
    },
    { id:"p5q3", type:"tfnm", marks:2,
      prompt:"(E) Red wants results immediately. (True / False / Not mentioned)",
      correct:"True"
    },
    { id:"p5q4", type:"short", marks:4,
      prompt:"(E) Why can teamwork create tension between Red and OWing? Give ONE reason.",
      rubric:"Because Red wants speed but OWing prioritises precision/checking, so they disagree about pace/details.",
      keywords:[
        ["vite","speed","rapidement"],
        ["lentement","slow"],
        ["pr√©cision","precision"],
        ["d√©tails","details"],
        ["d√©saccord","disagree","tensions"]
      ]
    },
    { id:"p5q5", type:"pn", marks:2,
      prompt:"(E) The passage suggests teamwork on the server is‚Ä¶ (P / N / P+N)",
      answer:"P+N"
    },
    { id:"p5q6", type:"fr_short", marks:4,
      prompt:"(M) En fran√ßais : Quelle m√©thode en DEUX √©tapes aide le projet √† avancer ?",
      rubric:"√âtape 1 : faire la structure rapidement. √âtape 2 : v√©rifier/corriger les d√©tails.",
      keywords:[
        ["√©tape","etape"],
        ["structure"],
        ["rapidement","vite"],
        ["v√©rifier","verifier","corriger"],
        ["d√©tails","details"]
      ]
    }
  ]
},

  {
  id: 6,
  title: "Passage 6 ‚Äî Otono Airways : confort et contraintes",
  theme: "Theme 3 ‚Äî Otono Team",
  unit: "Unit 8 (Otono Airways)",
  text: `Voyager avec Otono Airways est souvent confortable. Les passagers remarquent l‚Äôorganisation dans la cabine, la disposition des si√®ges et l‚Äôambiance g√©n√©rale. M√™me en classe √©conomique, beaucoup trouvent qu‚Äôil y a assez d‚Äôespace pour s‚Äôinstaller correctement.

Cependant, tout n‚Äôest pas toujours parfait. Certains passagers trouvent que les r√®gles √† bord sont strictes, surtout dans les zones calmes comme le salon. D‚Äôautres disent que le service peut sembler rapide : le repas arrive vite, mais on a moins de temps pour discuter avec l‚Äô√©quipage. Red observe ces d√©tails avec attention. Pour lui, un bon vol d√©pend d‚Äôun √©quilibre : confort, efficacit√© et respect des consignes.

√Ä la fin, Red conclut que l‚Äôexp√©rience est positive, mais qu‚Äôil existe aussi des petites limites selon les attentes de chacun.`,
  questions: [
    { id:"p6q1", type:"mcq", marks:2,
      prompt:"(E) The passage says travelling with Otono Airways is often‚Ä¶",
      options:["Uncomfortable","Comfortable","Chaotic","Boring"],
      answerIndex:1
    },
    { id:"p6q2", type:"short", marks:4,
      prompt:"(E) Give TWO things passengers notice in the cabin.",
      rubric:"Any two: organisation; seat layout; general atmosphere; enough space in economy.",
      keywords:[
        ["organisation","organis√©","organise"],
        ["disposition","layout"],
        ["si√®ges","sieges","seats"],
        ["ambiance","atmosphere"],
        ["espace","space","√©conomique","economy"]
      ]
    },
    { id:"p6q3", type:"tfnm", marks:2,
      prompt:"(E) The passage says many passengers find there is enough space in economy. (True / False / Not mentioned)",
      correct:"True"
    },
    { id:"p6q4", type:"short", marks:4,
      prompt:"(E) Give ONE criticism mentioned about the flight experience.",
      rubric:"Any one: rules can feel strict (especially in quiet areas like the lounge); service can feel too fast / less time to talk to crew.",
      keywords:[
        ["r√®gles","regles","rules","strictes","strict"],
        ["salon","lounge","calme","quiet"],
        ["service","repas","meal"],
        ["vite","rapidement","fast"],
        ["moins de temps","less time","√©quipage","crew"]
      ]
    },
    { id:"p6q5", type:"pn", marks:2,
      prompt:"(E) Overall, the passage presents Otono Airways as‚Ä¶ (P / N / P+N)",
      answer:"P+N"
    },
    { id:"p6q6", type:"fr_short", marks:4,
      prompt:"(M) En fran√ßais : Quel ‚Äò√©quilibre‚Äô Red dit-il qu‚Äôun bon vol doit avoir ? Donne DEUX √©l√©ments.",
      rubric:"Deux √©l√©ments parmi : confort ; efficacit√© ; respect des consignes.",
      keywords:[
        ["confort"],
        ["efficacit√©","efficacite"],
        ["respect","respecter"],
        ["consignes","instructions","r√®gles","regles"]
      ]
    }
  ]
},

  // ‚úÖ Longer + more straightforward from here (7‚Äì17)

  {
    id: 7,
    title: "Passage 7 ‚Äî La gestion du temps",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Study skills)",
    text: `Pour r√©ussir √† l‚Äô√©cole, la gestion du temps est essentielle. Beaucoup d‚Äô√©l√®ves savent quoi faire, mais ils ne savent pas quand le faire. Ils commencent les devoirs tr√®s tard, puis ils se sentent stress√©s. Ils travaillent longtemps le soir, ils dorment moins, et le lendemain ils sont fatigu√©s en cours. √Ä la fin, ils ont l‚Äôimpression que l‚Äô√©cole ‚Äúprend tout le temps‚Äù, alors qu‚Äôen r√©alit√© le probl√®me est surtout l‚Äôorganisation.

Red essaye une m√©thode plus simple et plus r√©aliste. Chaque dimanche soir, il ouvre un planning et il note tout ce qu‚Äôil doit faire : devoirs, contr√¥les, et petites r√©visions. Ensuite, il divise le travail en t√¢ches courtes. Par exemple, au lieu de r√©viser deux heures d‚Äôun coup, il fait vingt minutes de vocabulaire, puis une pause, puis quinze minutes d‚Äôexercices. Il se fixe aussi une heure limite : il √©vite de travailler trop tard, pour garder un bon sommeil.

Il ne r√©ussit pas parfaitement tous les jours. Parfois il oublie une t√¢che ou il sous-estime le temps n√©cessaire. Mais il corrige rapidement : il d√©place la t√¢che au lendemain, et il ajuste son planning. Selon lui, le but n‚Äôest pas d‚Äô√™tre ‚Äúparfait‚Äù, mais d‚Äô√™tre r√©gulier. Gr√¢ce √† cette r√©gularit√©, il arrive aux examens plus calme, et il commet moins d‚Äôerreurs dues √† la fatigue.`,
    questions: [
      { id:"p7q1", type:"mcq", marks:2,
        prompt:"(E) What is the main topic of the passage?",
        options:["Time management for school","A sports tournament","A music concert","A holiday plan"],
        answerIndex:0
      },
      { id:"p7q2", type:"short", marks:4,
        prompt:"(E) Give TWO problems caused by starting homework very late.",
        rubric:"Any two: stress; working very late; sleeping less; being tired in class; feeling school takes all the time.",
        keywords:[
          ["stress","stress√©s","stress√©"],
          ["tard","late","soir"],
          ["dort","dormir","sleep","moins"],
          ["fatigu√©","fatigue","tired"],
          ["prend tout le temps","all the time"]
        ]
      },
      { id:"p7q3", type:"short", marks:4,
        prompt:"(E) What does Red do on Sunday evening?",
        rubric:"He opens a planner and writes what he must do (homework, tests, revision).",
        keywords:[
          ["dimanche","sunday"],
          ["planning","planner"],
          ["note","noter","writes"],
          ["devoirs","homework"],
          ["contr√¥les","tests"],
          ["r√©visions","revisions"]
        ]
      },
      { id:"p7q4", type:"tfnm", marks:2,
        prompt:"(E) Red tries to avoid working too late at night. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p7q5", type:"short", marks:6,
        prompt:"(H) Why does Red say the goal is not to be ‚Äòperfect‚Äô, but ‚Äòregular‚Äô?",
        rubric:"Because regular work keeps him calmer before exams and reduces mistakes from tiredness; he can adjust when plans go wrong.",
        keywords:[
          ["but","goal","objectif"],
          ["r√©gulier","regular"],
          ["calme","calmer"],
          ["examens","exams"],
          ["moins d‚Äôerreurs","less mistakes","erreurs"],
          ["fatigue","tiredness"],
          ["ajuste","adjust","corrige","correct"]
        ]
      },
      { id:"p7q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Donne DEUX exemples de ‚Äòt√¢ches courtes‚Äô dans la m√©thode de Red.",
        rubric:"Deux parmi : vingt minutes de vocabulaire ; quinze minutes d‚Äôexercices ; faire une pause entre deux t√¢ches.",
        keywords:[
          ["vingt","20","minutes","vocabulaire"],
          ["quinze","15","minutes","exercices"],
          ["pause"]
        ]
      }
    ]
  },

  {
    id: 8,
    title: "Passage 8 ‚Äî Le stress avant un contr√¥le",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Exams)",
    text: `Avant un contr√¥le important, de nombreux √©l√®ves ressentent du stress. Ils connaissent souvent leurs le√ßons, mais ils ont peur ‚Äúd‚Äôoublier tout‚Äù au moment de r√©pondre. Certains s‚Äôinqui√®tent du temps : ils regardent l‚Äôhorloge toutes les deux minutes. D‚Äôautres sont g√™n√©s par le silence dans la salle, car chaque bruit (une chaise, une page tourn√©e, un stylo qui tombe) leur semble √©norme.

Red remarque aussi un autre probl√®me : quand on est stress√©, on lit trop vite. On saute des mots, on confond les consignes, et on r√©pond √† c√¥t√©. Pour √©viter cela, il pr√©pare une petite routine. Avant de commencer, il respire calmement pendant quelques secondes. Ensuite, il lit la premi√®re question lentement, et il souligne un ou deux mots cl√©s (par exemple : ‚Äúdeux raisons‚Äù, ‚Äúexpliquer‚Äù, ‚Äúciter‚Äù). Puis il commence par les exercices les plus simples, pour gagner des points rapidement et se mettre en confiance.

Pour Red, rester calme ne veut pas dire ‚Äúne rien sentir‚Äù. Il accepte que le stress existe, mais il essaie de le transformer en concentration. Quand il suit sa routine, il r√©fl√©chit mieux, il √©crit plus clairement, et il v√©rifie ses r√©ponses √† la fin si le temps le permet.`,
    questions: [
      { id:"p8q1", type:"mcq", marks:2,
        prompt:"(E) The passage says many students stress because they fear‚Ä¶",
        options:["Forgetting everything during the test","Being late for lunch","Having too much free time","Getting no homework"],
        answerIndex:0
      },
      { id:"p8q2", type:"short", marks:4,
        prompt:"(E) Give TWO causes of stress mentioned in the passage.",
        rubric:"Any two: fear of forgetting; worry about time/clock; silence; noises feel huge.",
        keywords:[
          ["oublier","forget"],
          ["temps","time","horloge","clock"],
          ["silence"],
          ["bruit","noise","chaise","page","stylo"]
        ]
      },
      { id:"p8q3", type:"short", marks:4,
        prompt:"(E) What extra problem does Red mention about stress and reading?",
        rubric:"When stressed, people read too fast and miss words / misunderstand instructions.",
        keywords:[
          ["stress√©","stressed"],
          ["lit","lire","read"],
          ["trop vite","too fast"],
          ["saute","skip"],
          ["consignes","instructions"],
          ["√† c√¥t√©","off-topic","wrong"]
        ]
      },
      { id:"p8q4", type:"tfnm", marks:2,
        prompt:"(E) Red starts with the simplest exercises first. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p8q5", type:"short", marks:6,
        prompt:"(H) Describe Red‚Äôs routine with THREE steps.",
        rubric:"Three steps such as: breathe calmly; read slowly; underline key words; start with easiest questions; check answers at the end if time.",
        keywords:[
          ["respire","respirer","breathe"],
          ["lentement","slowly","lire","read"],
          ["souligne","underline"],
          ["mots cl√©s","key words"],
          ["exercices","questions","simples","easiest"],
          ["v√©rifie","check"]
        ]
      },
      { id:"p8q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi commencer par les exercices les plus simples aide Red ?",
        rubric:"Parce qu‚Äôil gagne des points rapidement et il se met en confiance.",
        keywords:[
          ["gagne","points"],
          ["rapidement","vite"],
          ["confiance"]
        ]
      }
    ]
  },

  {
    id: 9,
    title: "Passage 9 ‚Äî Le travail en groupe",
    theme: "Theme 2 ‚Äî Free time",
    unit: "Unit 5 (Teamwork)",
    text: `Dans certains cours et projets, les √©l√®ves doivent travailler en groupe. Cette m√©thode peut √™tre tr√®s utile : on partage les id√©es, on se corrige, et on avance plus vite. Mais elle peut aussi cr√©er des tensions. Parfois, une personne fait presque tout le travail tandis qu‚Äôune autre participe tr√®s peu. Dans ce cas, le groupe se d√©courage, et la qualit√© baisse.

Red pr√©f√®re les groupes organis√©s. Pour lui, le secret est simple : chaque √©l√®ve doit avoir un r√¥le clair d√®s le d√©but. Par exemple, une personne pr√©pare un plan, une autre √©crit la r√©ponse finale, et une autre v√©rifie les d√©tails. Red insiste aussi sur une r√®gle : tout le monde doit parler au moins une fois, m√™me si c‚Äôest pour une petite id√©e. Ainsi, personne ne peut ‚Äúdispara√Ætre‚Äù pendant le projet.

Quand les r√¥les sont clairs, Red remarque trois avantages. D‚Äôabord, le travail avance plus vite parce que chacun sait quoi faire. Ensuite, les id√©es sont plus vari√©es, car plusieurs personnes contribuent. Enfin, on commet moins d‚Äôerreurs, parce qu‚Äôune personne peut relire et corriger. Pour Red, un groupe n‚Äôest pas seulement ‚Äúplusieurs √©l√®ves ensemble‚Äù : c‚Äôest une √©quipe avec une m√©thode.`,
    questions: [
      { id:"p9q1", type:"mcq", marks:2,
        prompt:"(E) What does Red think is the secret of good group work?",
        options:["Clear roles from the start","Never speaking","Working alone","Finishing late"],
        answerIndex:0
      },
      { id:"p9q2", type:"short", marks:4,
        prompt:"(E) Give TWO problems of group work mentioned.",
        rubric:"Any two: one person does almost all the work; another participates very little; tension; discouragement; quality drops.",
        keywords:[
          ["une personne","one person"],
          ["presque tout","almost all"],
          ["participe","participates","peu","little"],
          ["tensions","tension"],
          ["d√©courage","discourage"],
          ["qualit√©","quality","baisse","drops"]
        ]
      },
      { id:"p9q3", type:"short", marks:4,
        prompt:"(E) Give TWO example roles Red suggests.",
        rubric:"Any two: plan; write the final answer; check details; re-read/correct.",
        keywords:[
          ["plan"],
          ["√©crit","ecrire","write"],
          ["r√©ponse finale","final answer"],
          ["v√©rifie","check"],
          ["d√©tails","details"],
          ["relire","re-read","corriger","correct"]
        ]
      },
      { id:"p9q4", type:"tfnm", marks:2,
        prompt:"(E) Red wants everyone to speak at least once. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p9q5", type:"short", marks:6,
        prompt:"(H) Give THREE advantages Red sees when roles are clear.",
        rubric:"Three: faster progress; more varied ideas; fewer errors; better quality; teamwork feels like a method.",
        keywords:[
          ["avance","progress","plus vite","faster"],
          ["id√©es","ideas","vari√©es","varied"],
          ["moins d‚Äôerreurs","fewer errors","erreurs"],
          ["qualit√©","quality"],
          ["m√©thode","method"]
        ]
      },
      { id:"p9q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi une personne relit-elle le travail √† la fin ?",
        rubric:"Pour v√©rifier et corriger les erreurs / am√©liorer la qualit√©.",
        keywords:[
          ["v√©rifier","verifier"],
          ["corriger"],
          ["erreurs"],
          ["qualit√©","qualite","am√©liorer","ameliorer"]
        ]
      }
    ]
  },

  {
    id: 10,
    title: "Passage 10 ‚Äî L‚Äôenvironnement de travail",
    theme: "Theme 2 ‚Äî Your region",
    unit: "Unit 7 (Environment)",
    text: `L‚Äôenvironnement de travail influence beaucoup la concentration. Certains √©l√®ves pr√©f√®rent le silence total, parce que le moindre bruit les d√©range. D‚Äôautres, au contraire, aiment un l√©ger bruit de fond, comme une ventilation ou une musique tr√®s discr√®te, car cela les aide √† se sentir ‚Äúdans une routine‚Äù. Il n‚Äôy a pas une seule solution pour tout le monde, mais il existe des principes simples.

OWing pense qu‚Äôun espace clair et calme donne envie de travailler. Avant de commencer, il range son bureau : il enl√®ve les papiers inutiles, il pr√©pare seulement ce dont il a besoin, et il met son t√©l√©phone loin de lui. Il choisit aussi un endroit pr√©cis : toujours le m√™me coin, avec une chaise confortable. Pour OWing, ce petit rituel envoie un message au cerveau : ‚Äúmaintenant, c‚Äôest le moment de se concentrer‚Äù.

Quand l‚Äôespace est d√©sorganis√©, OWing remarque que l‚Äôon perd du temps. On cherche un stylo, on regarde une notification, puis on oublie ce qu‚Äôon faisait. √Ä l‚Äôinverse, quand tout est pr√™t, on commence plus vite, et on termine mieux. Selon lui, un bon environnement ne fait pas tout, mais il am√©liore la qualit√© du travail et r√©duit le stress.`,
    questions: [
      { id:"p10q1", type:"mcq", marks:2,
        prompt:"(E) OWing believes a good work space should be‚Ä¶",
        options:["Clear and calm","Noisy and messy","Crowded","Outside only"],
        answerIndex:0
      },
      { id:"p10q2", type:"short", marks:4,
        prompt:"(E) Give TWO different preferences students can have about noise.",
        rubric:"Some prefer total silence; others prefer light background noise.",
        keywords:[
          ["silence","total"],
          ["bruit","noise"],
          ["l√©ger","light","fond","background"],
          ["musique","music"]
        ]
      },
      { id:"p10q3", type:"short", marks:4,
        prompt:"(E) Give TWO things OWing does before starting work.",
        rubric:"Any two: tidy the desk; remove useless papers; prepare only what he needs; put phone far away; use the same corner/chair.",
        keywords:[
          ["range","ranger","tidy"],
          ["papiers","papers","inutiles","useless"],
          ["pr√©pare","prepare"],
          ["besoin","need"],
          ["t√©l√©phone","phone","loin","far"],
          ["m√™me coin","same corner","chaise","chair"]
        ]
      },
      { id:"p10q4", type:"tfnm", marks:2,
        prompt:"(E) OWing keeps his phone close to him while studying. (True / False / Not mentioned)",
        correct:"False"
      },
      { id:"p10q5", type:"short", marks:6,
        prompt:"(H) Explain why a tidy environment saves time, according to OWing.",
        rubric:"Because you don‚Äôt waste time searching for things or getting distracted; you start faster and finish better.",
        keywords:[
          ["perd du temps","waste time"],
          ["cherche","search"],
          ["stylo","pen"],
          ["notification","notifications"],
          ["distractions","distracted"],
          ["commence","start","plus vite","faster"],
          ["termine","finish","mieux","better"]
        ]
      },
      { id:"p10q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Quel est l‚Äôeffet du ‚Äòrituel‚Äô d‚ÄôOWing ?",
        rubric:"Il aide le cerveau √† comprendre que c‚Äôest le moment de se concentrer / il met OWing en routine.",
        keywords:[
          ["cerveau","brain"],
          ["moment","time"],
          ["se concentrer","concentrer","concentration"],
          ["routine"]
        ]
      }
    ]
  },

  {
    id: 11,
    title: "Passage 11 ‚Äî Clayton et le GCSE anticip√©",
    theme: "Bonus Theme 4 ‚Äî Results",
    unit: "Unit 10 (Clayton GCSE)",
    text: `Clayton a pass√© son examen de maths bien avant la majorit√© des √©l√®ves. Normalement, les √©l√®ves attendent la p√©riode officielle, avec toute la classe. Lui, il a √©t√© autoris√© √† passer l‚Äôexamen plus t√¥t, parce que ses professeurs pensaient qu‚Äôil √©tait pr√™t. Le jour des r√©sultats, il obtient 160 sur 160, une note parfaite. Beaucoup de personnes admirent sa r√©ussite. Elles disent qu‚Äôil a une logique rapide, une m√©thode claire, et une discipline rare.

Apr√®s cette annonce, l‚Äô√©cole parle beaucoup de lui. Certains √©l√®ves se sentent motiv√©s : ils se disent que si Clayton a r√©ussi, eux aussi peuvent progresser. D‚Äôautres se sentent d√©courag√©s, parce qu‚Äôils comparent leurs propres notes √† une perfection. Clayton explique qu‚Äôil ne s‚Äôagit pas de ‚Äútalent magique‚Äù. Pour lui, ce score repr√©sente des ann√©es d‚Äôefforts : il a fait de nombreux exercices, il a corrig√© ses erreurs, et il a travaill√© r√©guli√®rement.

Cependant, tout le monde n‚Äôest pas positif. Certaines personnes trouvent qu‚Äôil parle trop souvent de son r√©sultat. Elles pensent que la r√©ussite est importante, mais que l‚Äôhumilit√© l‚Äôest aussi. Clayton r√©pond qu‚Äôil est fier, et qu‚Äôil veut montrer que la discipline fonctionne. Le d√©bat continue : faut-il c√©l√©brer un exploit sans limite, ou faut-il garder une attitude plus discr√®te ?`,
    questions: [
      { id:"p11q1", type:"mcq", marks:2,
        prompt:"(E) What score did Clayton get?",
        options:["160/160","150/160","140/160","100/160"],
        answerIndex:0
      },
      { id:"p11q2", type:"short", marks:4,
        prompt:"(E) Why was Clayton allowed to take the exam early?",
        rubric:"Because teachers believed he was ready / he had the level to do it earlier.",
        keywords:[
          ["autoris√©","allowed"],
          ["plus t√¥t","earlier"],
          ["professeurs","teachers"],
          ["pr√™t","ready"],
          ["niveau","level"]
        ]
      },
      { id:"p11q3", type:"short", marks:4,
        prompt:"(E) Give TWO reactions people have after his result.",
        rubric:"Any two: admiration; motivated; discouraged; some criticise him for talking too much; debate about humility.",
        keywords:[
          ["admirent","admire","admiration"],
          ["motiv√©","motivated","motivent"],
          ["d√©courag√©s","discouraged"],
          ["critique","criticise","parle trop","too often"],
          ["humilit√©","humility"]
        ]
      },
      { id:"p11q4", type:"tfnm", marks:2,
        prompt:"(E) Clayton says his success is ‚Äòmagic talent‚Äô. (True / False / Not mentioned)",
        correct:"False"
      },
      { id:"p11q5", type:"short", marks:6,
        prompt:"(H) According to Clayton, what are THREE reasons for his success?",
        rubric:"Three: lots of practice/exercises; correcting mistakes; regular work; discipline; effort over years; clear method.",
        keywords:[
          ["exercices","practice","many exercises"],
          ["corrig√©","corriger","correct mistakes"],
          ["r√©guli√®rement","regular"],
          ["discipline"],
          ["efforts","effort"],
          ["ann√©es","years"],
          ["m√©thode","method"]
        ]
      },
      { id:"p11q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi certaines personnes critiquent-elles Clayton ?",
        rubric:"Parce qu‚Äôelles trouvent qu‚Äôil parle trop souvent de son r√©sultat et qu‚Äôil manque d‚Äôhumilit√©.",
        keywords:[
          ["critiquent","critique"],
          ["parle trop","trop souvent"],
          ["r√©sultat","resultat","score"],
          ["humilit√©","humilite"]
        ]
      }
    ]
  },

  {
    id: 12,
    title: "Passage 12 ‚Äî Les notes parfaites",
    theme: "Bonus Theme 4 ‚Äî Results",
    unit: "Unit 10 (Reactions)",
    text: `Quand un √©l√®ve obtient une note parfaite, les r√©actions varient beaucoup. Dans une m√™me classe, on peut voir des √©motions compl√®tement diff√©rentes. Certains √©l√®ves se sentent motiv√©s : ils se disent ‚Äúsi c‚Äôest possible, je peux aussi essayer‚Äù. Ils demandent des conseils, ils refont des exercices, et ils veulent am√©liorer leurs m√©thodes. Pour eux, une note parfaite est comme une preuve qu‚Äôon peut atteindre tr√®s haut.

Mais d‚Äôautres √©l√®ves vivent la situation autrement. Ils se sentent d√©courag√©s, parce qu‚Äôils comparent leur propre niveau √† une perfection. Ils pensent qu‚Äôils n‚Äôatteindront jamais ce r√©sultat, m√™me en travaillant beaucoup. Parfois, ce d√©couragement devient de la jalousie, surtout si la personne qui a r√©ussi en parle trop.

Red pense qu‚Äôun excellent r√©sultat doit inspirer les autres, pas les √©craser. Il dit qu‚Äôil faut c√©l√©brer l‚Äôeffort, pas seulement le chiffre. Selon lui, la comp√©tition peut √™tre saine si elle pousse chacun √† progresser, tout en gardant du respect. Dans son id√©e, le but est simple : se comparer √† soi-m√™me, et devenir meilleur qu‚Äôhier, sans cr√©er de drames inutiles dans la classe.`,
    questions: [
      { id:"p12q1", type:"mcq", marks:2,
        prompt:"(E) The passage says reactions to perfect scores are‚Ä¶",
        options:["Varied","Always positive","Always negative","Unchanged"],
        answerIndex:0
      },
      { id:"p12q2", type:"short", marks:4,
        prompt:"(E) Give TWO positive reactions mentioned.",
        rubric:"Any two: feel motivated; ask for advice; redo exercises; want better methods; work harder.",
        keywords:[
          ["motiv√©","motivated"],
          ["conseils","advice"],
          ["refont","redo","exercices"],
          ["am√©liorer","improve","m√©thodes","methods"],
          ["travailler plus","work harder"]
        ]
      },
      { id:"p12q3", type:"short", marks:4,
        prompt:"(E) Give TWO negative reactions mentioned.",
        rubric:"Any two: discouraged; think they will never reach it; jealousy; feel crushed.",
        keywords:[
          ["d√©courag√©s","discouraged"],
          ["jamais","never","atteindre","reach"],
          ["jalousie","jealousy"],
          ["√©craser","crushed"]
        ]
      },
      { id:"p12q4", type:"tfnm", marks:2,
        prompt:"(E) Red thinks competition can be healthy. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p12q5", type:"short", marks:6,
        prompt:"(H) What is Red‚Äôs main message about success and competition?",
        rubric:"Celebrate effort, not only the number; competition is healthy if it helps progress and keeps respect; compare yourself to yourself.",
        keywords:[
          ["effort"],
          ["chiffre","number"],
          ["comp√©tition","competition"],
          ["saine","healthy"],
          ["progresser","progress"],
          ["respect"],
          ["se comparer","compare","√† soi-m√™me","yourself"]
        ]
      },
      { id:"p12q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Quel est le but ‚Äòsimple‚Äô selon Red ?",
        rubric:"Se comparer √† soi-m√™me et devenir meilleur qu‚Äôhier, sans drames inutiles.",
        keywords:[
          ["se comparer","comparer"],
          ["soi-m√™me","soi"],
          ["meilleur","better"],
          ["hier","yesterday"],
          ["drames","inutiles"]
        ]
      }
    ]
  },

  {
    id: 13,
    title: "Passage 13 ‚Äî La pression des examens",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Exam pressure)",
    text: `La p√©riode des examens peut √™tre intense. Les √©l√®ves doivent r√©viser plusieurs mati√®res en m√™me temps, parfois avec des devoirs encore √† rendre. Dans les couloirs, on entend souvent les m√™mes phrases : ‚Äúje n‚Äôai pas assez de temps‚Äù, ‚Äúj‚Äôai trop de chapitres‚Äù, ‚Äúje ne sais pas par o√π commencer‚Äù. La pression augmente encore quand les √©l√®ves regardent les autres : certains semblent pr√™ts, d‚Äôautres paniquent, et l‚Äôambiance devient contagieuse.

Dans ce contexte, les √©l√®ves adoptent des m√©thodes diff√©rentes. Certains organisent un planning tr√®s d√©taill√©, avec des heures et des objectifs pr√©cis. D‚Äôautres travaillent de mani√®re plus spontan√©e : ils r√©visent ce qu‚Äôils ‚Äúont envie‚Äù de faire ce jour-l√†. Chaque m√©thode peut fonctionner, mais elle a des risques. Sans planning, on peut oublier une mati√®re. Avec un planning trop strict, on peut se sentir coupable d√®s qu‚Äôon prend une pause.

OWing pr√©f√®re planifier chaque journ√©e, mais de fa√ßon raisonnable. Il choisit des objectifs simples : par exemple ‚Äúfaire un sujet‚Äù, ‚Äúrelire une fiche‚Äù, ‚Äúr√©viser vingt mots‚Äù. Il ajoute aussi du temps pour se reposer, car il pense que la fatigue d√©truit la concentration. Pour lui, la pr√©paration r√©duit la pression et √©vite les surprises. Quand il suit son plan, il se sent plus confiant et il arrive aux examens avec une id√©e claire de ce qu‚Äôil sait.`,
    questions: [
      { id:"p13q1", type:"mcq", marks:2,
        prompt:"(E) The exam period is described as‚Ä¶",
        options:["Intense","Relaxing","Unimportant","Funny"],
        answerIndex:0
      },
      { id:"p13q2", type:"short", marks:4,
        prompt:"(E) Give TWO reasons why students feel pressure in this passage.",
        rubric:"Any two: many subjects at once; not enough time; too many chapters; comparing with others; panic spreading; still have homework.",
        keywords:[
          ["plusieurs","many","mati√®res","subjects"],
          ["pas assez de temps","not enough time"],
          ["trop de chapitres","too many chapters"],
          ["devoirs","homework"],
          ["regardent les autres","compare","others"],
          ["paniquent","panic","contagieuse","contagious"]
        ]
      },
      { id:"p13q3", type:"short", marks:4,
        prompt:"(E) What are TWO study methods mentioned?",
        rubric:"Detailed planning; spontaneous studying.",
        keywords:[
          ["planning","planifier"],
          ["d√©taill√©","detaille","detailed"],
          ["spontan√©","spontane","spontaneous"]
        ]
      },
      { id:"p13q4", type:"tfnm", marks:2,
        prompt:"(E) OWing plans in a ‚Äòreasonable‚Äô way (not too strict). (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p13q5", type:"short", marks:6,
        prompt:"(H) Give THREE things OWing includes in his approach.",
        rubric:"Three: simple goals; specific tasks (do a paper, reread a sheet, learn 20 words); rest time; avoid fatigue; preparation reduces surprises; builds confidence.",
        keywords:[
          ["objectifs","goals","simples","simple"],
          ["faire un sujet","paper"],
          ["relire","reread","fiche","sheet"],
          ["vingt","20","mots","words"],
          ["se reposer","rest"],
          ["fatigue"],
          ["confiant","confidence","confiance"]
        ]
      },
      { id:"p13q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi OWing dit-il que le repos est important ?",
        rubric:"Parce que la fatigue d√©truit la concentration / r√©duit la qualit√© du travail.",
        keywords:[
          ["fatigue"],
          ["d√©truit","detruit"],
          ["concentration"],
          ["qualit√©","qualite"]
        ]
      }
    ]
  },

  {
    id: 14,
    title: "Passage 14 ‚Äî La concentration en classe",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Focus)",
    text: `En classe, la concentration est essentielle pour comprendre les explications du professeur. Pourtant, rester attentif n‚Äôest pas toujours facile. Certains √©l√®ves se laissent distraire par des bruits : une conversation au fond, une porte qui claque, un stylo qui tape sur la table. D‚Äôautres sont distraits par leurs pens√©es : ils pensent au week-end, √† un message, ou √† un probl√®me personnel. M√™me une petite distraction peut suffire √† perdre une information importante.

Red pense qu‚Äôil faut √©couter activement, pas seulement ‚Äú√™tre assis‚Äù. Pour lui, √©couter activement signifie regarder le professeur, suivre le fil, et prendre des notes claires. Il √©crit les mots essentiels et il organise ses notes avec des titres. Quand il ne comprend pas, il note un point d‚Äôinterrogation pour demander plus tard, au lieu de d√©crocher compl√®tement.

Red √©vite aussi d‚Äôutiliser son t√©l√©phone pendant les cours. Il sait qu‚Äôune seule notification peut briser l‚Äôattention, et qu‚Äôapr√®s, il est difficile de revenir au sujet. Selon lui, l‚Äôattention est comme une √©nergie : si on la gaspille sur des distractions, on comprend moins et on travaille plus √† la maison. Quand il se concentre bien en classe, il a moins besoin de r√©viser longtemps le soir.`,
    questions: [
      { id:"p14q1", type:"mcq", marks:2,
        prompt:"(E) The passage says concentration helps students‚Ä¶",
        options:["Understand the teacher‚Äôs explanations","Sleep in class","Skip homework","Talk more"],
        answerIndex:0
      },
      { id:"p14q2", type:"short", marks:4,
        prompt:"(E) Give TWO distractions mentioned.",
        rubric:"Any two: noises; conversation; door slamming; pen tapping; thoughts about weekend/messages/problems.",
        keywords:[
          ["bruits","noise"],
          ["conversation"],
          ["porte","door"],
          ["stylo","pen"],
          ["pens√©es","pensees","thoughts"],
          ["week-end","message","probl√®me","problem"]
        ]
      },
      { id:"p14q3", type:"short", marks:4,
        prompt:"(E) What does ‚Äòactive listening‚Äô mean for Red? Give TWO actions.",
        rubric:"Two actions: look at teacher; follow the lesson; take clear notes; write key words; use titles; mark questions to ask later.",
        keywords:[
          ["regarder","look"],
          ["professeur","teacher"],
          ["suivre","follow"],
          ["notes","claires","clear"],
          ["mots essentiels","key words"],
          ["titres","headings"],
          ["point d‚Äôinterrogation","question mark","demander","ask"]
        ]
      },
      { id:"p14q4", type:"tfnm", marks:2,
        prompt:"(E) Red avoids using his phone in class. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p14q5", type:"short", marks:6,
        prompt:"(H) Why does Red say good focus in class reduces work at home?",
        rubric:"Because he understands more in class, wastes less attention on distractions, and then needs less long revision in the evening.",
        keywords:[
          ["comprend","understand"],
          ["moins","less"],
          ["distractions"],
          ["r√©viser","revise"],
          ["soir","evening"],
          ["travaille plus","work more","maison","home"]
        ]
      },
      { id:"p14q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Quel est le danger d‚Äôune notification selon Red ?",
        rubric:"Elle casse l‚Äôattention et il est difficile de revenir au sujet.",
        keywords:[
          ["notification"],
          ["casse","brise"],
          ["attention"],
          ["difficile"],
          ["revenir","retourner"],
          ["sujet"]
        ]
      }
    ]
  },

  {
    id: 15,
    title: "Passage 15 ‚Äî L‚Äôorganisation d‚ÄôOtono Mansion",
    theme: "Theme 3 ‚Äî Otono Team",
    unit: "Unit 9 (Otono Mansion)",
    text: `Otono Mansion poss√®de plus de quatre-vingt-dix pi√®ces, r√©parties sur plusieurs √©tages. Dans une maison aussi grande, l‚Äôorganisation est indispensable. Chaque espace a une fonction pr√©cise : certaines salles sont destin√©es au travail, d‚Äôautres au repos, et d‚Äôautres encore aux activit√©s du quotidien. Quand tout est bien structur√©, les habitants perdent moins de temps, et les invit√©s comprennent plus facilement o√π aller.

Cette organisation permet d‚Äô√©viter le chaos. Par exemple, les objets importants ne se trouvent pas ‚Äún‚Äôimporte o√π‚Äù : on sait o√π ranger le mat√©riel, o√π laisser les documents, et o√π se retrouver. Les couloirs restent plus calmes, et les conflits diminuent, car chacun respecte le r√¥le des pi√®ces. Quand une pi√®ce est faite pour √©tudier, on ne la transforme pas en salle bruyante au dernier moment.

Red appr√©cie particuli√®rement les espaces calmes pour travailler. Il choisit un endroit sans passage, avec une table claire et une lumi√®re correcte. Il dit que, dans une grande maison, le silence est un luxe : si on sait o√π le trouver, on peut se concentrer plus facilement. Pour lui, l‚Äôorganisation d‚ÄôOtono Mansion n‚Äôest pas seulement ‚Äújolie‚Äù : c‚Äôest une m√©thode pour vivre ensemble sans stress.`,
    questions: [
      { id:"p15q1", type:"mcq", marks:2,
        prompt:"(E) How many rooms does Otono Mansion have?",
        options:["Over 90","Exactly 20","Less than 10","Over 200"],
        answerIndex:0
      },
      { id:"p15q2", type:"short", marks:4,
        prompt:"(E) Give TWO reasons why organisation is necessary in a very large house.",
        rubric:"Any two: avoid chaos; save time; help guests know where to go; keep corridors calm; reduce conflicts; know where important items are stored.",
        keywords:[
          ["√©viter","eviter","chaos"],
          ["perdre moins de temps","save time"],
          ["invit√©s","guests"],
          ["comprendre","understand","o√π aller","where to go"],
          ["calmes","calm"],
          ["conflits","conflicts"],
          ["ranger","store","objets","items","importants"]
        ]
      },
      { id:"p15q3", type:"short", marks:4,
        prompt:"(E) Give TWO types of room functions mentioned.",
        rubric:"Work/study rooms; rest rooms; daily activity rooms.",
        keywords:[
          ["travail","work","√©tudier","etudier","study"],
          ["repos","rest"],
          ["quotidien","daily","activit√©s","activities"]
        ]
      },
      { id:"p15q4", type:"tfnm", marks:2,
        prompt:"(E) Red likes quiet spaces for working. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p15q5", type:"short", marks:6,
        prompt:"(H) Give THREE features of the study space Red chooses.",
        rubric:"Three: quiet; no passage/low traffic; clear table; good light; calm environment.",
        keywords:[
          ["calme","quiet"],
          ["sans passage","no passage","sans","passage"],
          ["table","claire","clear"],
          ["lumi√®re","lumiere","light"],
          ["se concentrer","concentrer","focus"]
        ]
      },
      { id:"p15q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Pourquoi Red dit-il que l‚Äôorganisation est ‚Äòune m√©thode pour vivre ensemble‚Äô ?",
        rubric:"Parce qu‚Äôelle r√©duit le stress, √©vite le chaos, et aide chacun √† respecter le r√¥le des pi√®ces.",
        keywords:[
          ["stress"],
          ["√©vite","eviter","chaos"],
          ["respecte","respecter"],
          ["r√¥le","role"],
          ["pi√®ces","pieces"],
          ["vivre ensemble","together"]
        ]
      }
    ]
  },

  {
    id: 16,
    title: "Passage 16 ‚Äî L‚Äô√©quilibre entre vitesse et pr√©cision",
    theme: "Theme 2 ‚Äî Free time",
    unit: "Unit 5 (Balance)",
    text: `Dans les projets d‚ÄôOtono, on voit souvent deux styles de travail. Certains pr√©f√®rent aller vite : ils veulent terminer rapidement, montrer des r√©sultats, et passer √† la suite. D‚Äôautres privil√©gient la pr√©cision : ils v√©rifient tout, ils relisent, et ils pr√©f√®rent avancer lentement mais s√ªrement. Les deux styles ont des avantages, mais aussi des risques.

La vitesse permet de finir rapidement. Dans un jeu ou un projet cr√©atif, cela peut √™tre utile pour garder la motivation. Mais si on va trop vite, on oublie des d√©tails, on construit de travers, ou on fait une erreur qui co√ªte beaucoup de temps plus tard. La pr√©cision r√©duit les erreurs et am√©liore la qualit√©. Pourtant, si on devient trop lent, on bloque le projet : les autres attendent, et on perd l‚Äô√©nergie du groupe.

OWing pense qu‚Äôil faut trouver un √©quilibre. Pour lui, l‚Äô√©quilibre signifie une r√®gle simple : avancer vite sur les grandes √©tapes, puis ralentir pour v√©rifier √† des moments pr√©cis. Par exemple, on peut construire une premi√®re version rapidement, puis faire une v√©rification compl√®te avant de finaliser. Selon OWing, ce rythme √©vite les probl√®mes et √©vite aussi les retards. Le but n‚Äôest pas de choisir ‚Äúvitesse OU pr√©cision‚Äù, mais de combiner les deux intelligemment.`,
    questions: [
      { id:"p16q1", type:"mcq", marks:2,
        prompt:"(E) What does OWing recommend?",
        options:["Balancing speed and precision","Only speed always","Only precision always","Never checking work"],
        answerIndex:0
      },
      { id:"p16q2", type:"short", marks:4,
        prompt:"(E) Give ONE benefit of speed and ONE benefit of precision.",
        rubric:"Speed: finish quickly / keep motivation. Precision: reduce errors / improve quality.",
        keywords:[
          ["finir","finish","rapidement","quickly","vite","speed"],
          ["motivation"],
          ["r√©duit","reduce","erreurs","errors"],
          ["qualit√©","quality","pr√©cision","precision"]
        ]
      },
      { id:"p16q3", type:"short", marks:4,
        prompt:"(E) Give TWO risks mentioned (one for going too fast, one for going too slow).",
        rubric:"Too fast: forget details / mistakes / costly error later. Too slow: delay project / others wait / lose group energy.",
        keywords:[
          ["trop vite","too fast"],
          ["oublie","forget","d√©tails","details"],
          ["erreur","mistake"],
          ["plus tard","later","co√ªte","costs"],
          ["trop lent","too slow"],
          ["retarde","delay","retard"],
          ["attendent","wait"],
          ["√©nergie","energy"]
        ]
      },
      { id:"p16q4", type:"tfnm", marks:2,
        prompt:"(E) OWing suggests checking at specific moments. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p16q5", type:"short", marks:6,
        prompt:"(H) Describe OWing‚Äôs method in TWO parts.",
        rubric:"Part 1: move fast on big steps / first version. Part 2: slow down to check fully before finalising.",
        keywords:[
          ["grandes √©tapes","big steps"],
          ["vite","fast"],
          ["premi√®re version","first version"],
          ["ralentir","slow down"],
          ["v√©rification","check","compl√®te","complete"],
          ["finaliser","finalise"]
        ]
      },
      { id:"p16q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Quelle phrase r√©sume l‚Äôid√©e d‚ÄôOWing √† la fin ?",
        rubric:"On combine vitesse et pr√©cision intelligemment (pas ‚Äòvitesse OU pr√©cision‚Äô).",
        keywords:[
          ["combine","combiner"],
          ["vitesse"],
          ["pr√©cision","precision"],
          ["intelligemment"],
          ["ou"]
        ]
      }
    ]
  },

  {
    id: 17,
    title: "Passage 17 ‚Äî L‚Äôimportance de la discipline",
    theme: "Theme 1 ‚Äî School",
    unit: "Unit 4 (Discipline)",
    text: `La discipline est une qualit√© importante pour r√©ussir. Elle ne signifie pas √™tre dur avec soi-m√™me toute la journ√©e, mais savoir continuer m√™me quand on n‚Äôa pas envie. La discipline implique de travailler r√©guli√®rement, de respecter des r√®gles simples, et de garder une direction. Sans discipline, il est facile de perdre la motivation : on remet au lendemain, on abandonne au premier obstacle, et on progresse moins.

Red pense que la discipline n‚Äôest pas seulement scolaire. Pour lui, la m√™me logique existe dans la musique, le sport, et m√™me les jeux. Quand on veut progresser, il faut r√©p√©ter, corriger, et revenir plusieurs fois sur la m√™me comp√©tence. Red donne un exemple simple : si on travaille un peu chaque jour, m√™me dix minutes, on avance plus que si on fait ‚Äútout d‚Äôun coup‚Äù une fois par mois. La r√©gularit√© cr√©e des r√©sultats solides, parce qu‚Äôelle construit une habitude.

Red ajoute aussi une id√©e importante : la discipline aide √† rester calme. Quand on a une routine, on panique moins avant une √©valuation, parce qu‚Äôon sait qu‚Äôon a fait le travail n√©cessaire. Bien s√ªr, il y a des jours difficiles. Mais pour Red, la discipline, c‚Äôest justement la capacit√© de reprendre le lendemain, sans se juger, et de continuer le chemin.`,
    questions: [
      { id:"p17q1", type:"mcq", marks:2,
        prompt:"(E) In this passage, discipline mainly means‚Ä¶",
        options:["Continuing regularly even when you don‚Äôt feel like it","Never resting","Being perfect","Ignoring rules"],
        answerIndex:0
      },
      { id:"p17q2", type:"short", marks:4,
        prompt:"(E) Give TWO things that can happen without discipline.",
        rubric:"Any two: lose motivation; postpone work; give up at obstacles; progress less.",
        keywords:[
          ["perdre la motivation","lose motivation","motivation"],
          ["remet","remettre","tomorrow","au lendemain","postpone"],
          ["abandonne","give up"],
          ["obstacle"],
          ["progresse moins","less progress"]
        ]
      },
      { id:"p17q3", type:"short", marks:4,
        prompt:"(E) Give TWO areas (not just school) where Red says discipline is useful.",
        rubric:"Two: music; sport; games.",
        keywords:[
          ["musique","music"],
          ["sport"],
          ["jeux","games"],
          ["scolaire","school"]
        ]
      },
      { id:"p17q4", type:"tfnm", marks:2,
        prompt:"(E) Red believes ten minutes every day can help progress. (True / False / Not mentioned)",
        correct:"True"
      },
      { id:"p17q5", type:"short", marks:6,
        prompt:"(H) Explain why ‚Äòregularity creates solid results‚Äô according to Red.",
        rubric:"Because regular work builds habits, repeated practice and correction improve skills over time, and you progress more than doing everything rarely.",
        keywords:[
          ["r√©gularit√©","regularity"],
          ["habitude","habit"],
          ["r√©p√©ter","repeat"],
          ["corriger","correct"],
          ["avec le temps","over time"],
          ["progresse","progress"],
          ["rarement","rarely"]
        ]
      },
      { id:"p17q6", type:"fr_short", marks:4,
        prompt:"(M) En fran√ßais : Comment la discipline aide-t-elle Red √† rester calme ?",
        rubric:"Gr√¢ce √† une routine, il panique moins avant une √©valuation car il sait qu‚Äôil a fait le travail n√©cessaire.",
        keywords:[
          ["routine"],
          ["panique","paniquer"],
          ["moins"],
          ["√©valuation","evaluation"],
          ["sait","know"],
          ["travail","n√©cessaire"]
        ]
      }
    ]
  }
];

/* -----------------------------
   TRANSLATIONS (LONGER + STRICT KEY IDEAS)
   Each translation = 20 marks
   Marking: 5 idea-groups √ó 4 marks = 20
--------------------------------*/

const TRANSLATIONS = [
  {
    id: "T1",
    title: "Translation ‚Äî Exam routine",
    theme: "Theme 1 ‚Äî School",
    text: "Before an exam, I stay calm and I read the instructions carefully. I underline the important words, and I check how many details the question needs. This method helps me avoid simple mistakes and lose fewer marks.",
    // French-aware idea groups (each group = one ‚Äúidea‚Äù)
    keyIdeas: [
      ["avant un examen", "avant l examen"],
      ["je reste calme", "rester calme", "je suis calme"],
      ["je lis les consignes", "lire les consignes", "consignes attentivement", "je lis la consigne"],
      ["je souligne", "souligner", "mots importants", "les mots importants"],
      ["eviter des erreurs simples", "erreurs simples", "perdre moins de points", "je perds moins de points"]
    ],
    sampleAnswer:
      "Avant un examen, je reste calme et je lis les consignes attentivement. Je souligne les mots importants et je v√©rifie combien de d√©tails la question demande. Cette m√©thode m‚Äôaide √† √©viter des erreurs simples et √† perdre moins de points."
  },

  {
    id: "T2",
    title: "Translation ‚Äî Teamwork in a game",
    theme: "Theme 2 ‚Äî Free time",
    text: "On our game server, teamwork is essential. If someone rushes, they can make mistakes, but if someone checks everything, the project is cleaner. When we combine speed and precision, the build progresses faster and the result is better.",
    keyIdeas: [
      ["sur notre serveur", "serveur de jeu", "serveur"],
      ["le travail d equipe est essentiel", "travail d equipe", "equipe", "travailler ensemble", "cooperation"],
      ["se precipite", "va trop vite", "se dep√™che", "se depeche"],
      ["faire des erreurs", "des erreurs", "commettre des erreurs"],
      ["verifie tout", "verifier tout", "verifie les details", "precision", "plus propre"],
      ["combine vitesse et precision", "vitesse et precision", "avance plus vite", "progresse plus vite", "resultat meilleur", "meilleur resultat"]
    ],
    sampleAnswer:
      "Sur notre serveur, le travail d‚Äô√©quipe est essentiel. Si quelqu‚Äôun se pr√©cipite, il peut faire des erreurs, mais si quelqu‚Äôun v√©rifie tout, le projet est plus propre. Quand on combine vitesse et pr√©cision, la construction avance plus vite et le r√©sultat est meilleur."
  },

  {
    id: "T3",
    title: "Translation ‚Äî Otono Airways",
    theme: "Theme 3 ‚Äî Otono Team",
    text: "With Otono Airways, passengers notice the organisation in the cabin and the comfort of the seats. Even in economy class, there is enough space to sit comfortably. For some people, these details show the quality of the airline.",
    keyIdeas: [
      ["avec otono airways", "otono airways"],
      ["les passagers remarquent", "passagers remarquent", "les passagers"],
      ["organisation dans la cabine", "organisation", "cabine"],
      ["confort des sieges", "confort", "sieges", "si√®ges"],
      ["meme en classe economique", "classe economique", "assez d espace", "s installer confortablement", "confortablement"],
      ["qualite de la compagnie", "qualite", "compagnie", "compagnie aerienne"]
    ],
    sampleAnswer:
      "Avec Otono Airways, les passagers remarquent l‚Äôorganisation dans la cabine et le confort des si√®ges. M√™me en classe √©conomique, il y a assez d‚Äôespace pour s‚Äôinstaller confortablement. Pour certaines personnes, ces d√©tails montrent la qualit√© de la compagnie."
  },

  {
    id: "T4",
    title: "Translation ‚Äî Rules and success",
    theme: "Theme 1 ‚Äî School",
    text: "Knowing the topic is not always enough in an exam. If you do not follow the instructions, you can lose marks even with the correct idea. That is why it is important to answer fully and to include the details the question asks for.",
    keyIdeas: [
      ["connaitre le sujet", "conna√Ætre le sujet", "connaitre le theme", "conna√Ætre le th√®me"],
      ["ne suffit pas toujours", "pas toujours suffisant", "n est pas toujours suffisant", "ce n est pas toujours assez"],
      ["si tu ne suis pas les consignes", "ne pas suivre les consignes", "sans suivre les consignes"],
      ["tu peux perdre des points", "perdre des points", "perdre des marques", "perdre des notes"],
      ["meme avec la bonne idee", "bonne idee", "idee correcte", "bonne reponse"],
      ["repondre completement", "repondre pleinement", "repondre en detail", "inclure les details demandes", "details demandes"]
    ],
    sampleAnswer:
      "Conna√Ætre le sujet ne suffit pas toujours dans un examen. Si tu ne suis pas les consignes, tu peux perdre des points m√™me avec la bonne id√©e. C‚Äôest pourquoi il est important de r√©pondre compl√®tement et d‚Äôinclure les d√©tails demand√©s."
  }
];

/* -----------------------------
   Utilities
--------------------------------*/
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

function nowISO(){ return new Date().toISOString(); }

function norm(s){
  return (s ?? "")
    .toString()
    .toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[^a-z0-9\s]/g," ")
    .replace(/\s+/g," ")
    .trim();
}

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

function pickRandom(arr, n){
  return shuffle(arr).slice(0, n);
}

function escapeHtml(str){
  return (str ?? "").toString()
    .replace(/&/g,"&amp;")
    .replace(/</g,"&lt;")
    .replace(/>/g,"&gt;")
    .replace(/"/g,"&quot;")
    .replace(/'/g,"&#039;");
}

function otonoLetterGrade(score){
  if(score >= 101) return "S";
  if(score >= 95) return "A*";
  if(score >= 90) return "A";
  if(score >= 80) return "B";
  if(score >= 70) return "C";
  if(score >= 66) return "D";
  if(score >= 55) return "E";
  if(score >= 45) return "F";
  if(score >= 30) return "G";
  if(score >= 15) return "H";
  return "U";
}

function passMeritDistinction(score){
  if(score >= 90) return "DISTINCTION";
  if(score >= 80) return "MERIT";
  if(score >= 66) return "PASS";
  return "FAIL";
}

function gcseEstimate(score){
  if(score >= 90) return 9;
  if(score >= 80) return 8;
  if(score >= 70) return 7;
  if(score >= 60) return 6;
  if(score >= 50) return 5;
  if(score >= 40) return 4;
  if(score >= 30) return 3;
  if(score >= 20) return 2;
  if(score >= 10) return 1;
  return "U";
}

function badgeForScore(score){
  if(score >= 90) return ["badge good","üèÜ DISTINCTION"];
  if(score >= 80) return ["badge good","‚≠ê MERIT"];
  if(score >= 66) return ["badge warn","‚úÖ PASS"];
  return ["badge bad","‚ùå FAIL"];
}

/* -----------------------------
   Local storage
--------------------------------*/
const STORE_KEY = "otonoFrenchReadingSAM_set1_results_v2";

function loadResults(){
  try{ return JSON.parse(localStorage.getItem(STORE_KEY) || "[]"); }
  catch(e){ return []; }
}
function saveResults(list){
  localStorage.setItem(STORE_KEY, JSON.stringify(list));
}
function addResult(attempt){
  const list = loadResults();
  list.unshift(attempt);
  saveResults(list);
}

/* -----------------------------
   App state
--------------------------------*/
let state = {
  mode: "home",
  timer: null,
  remainingSec: 0,
  startedAt: null,

  centreNo: "50749",

  candidateNo: null,         // 4 digits
  candSurname: "",
  candForenames: "",

  selection: null,
  answers: {},               // qid -> user answer (string)
  mcqCorrectValue: {},       // qid -> correct radio value after shuffling
  submitted: false
};

/* -----------------------------
   Centre number controls
--------------------------------*/
function setCentre(no){
  state.centreNo = String(no);
  $("#centreNo").value = state.centreNo;
  $("#centreTop").textContent = state.centreNo;
}

$("#btnEditCentre").addEventListener("click", () => {
  const val = prompt("Enter centre number (digits only, e.g. 50749):", state.centreNo);
  if(val === null) return;
  const clean = String(val).replace(/\D/g,"").slice(0, 10);
  if(clean.length < 5){
    alert("Centre number must be digits only (at least 5 digits).");
    return;
  }
  setCentre(clean);
});

$("#btnResetCentre").addEventListener("click", () => setCentre("50749"));

/* -----------------------------
   Candidate number 4 squares
--------------------------------*/
const digitIds = ["#candD1","#candD2","#candD3","#candD4"];

function getCandidateNoFromSquares(){
  const d = digitIds.map(id => ($(id).value || "").trim());
  if(d.some(x => x.length !== 1 || !/^\d$/.test(x))) return "";
  return d.join("");
}

function focusDigit(i){
  const el = $(digitIds[i]);
  if(el) el.focus();
}

function wireDigitSquares(){
  digitIds.forEach((id, idx) => {
    const el = $(id);

    el.addEventListener("input", () => {
      // keep digits only
      el.value = (el.value || "").replace(/\D/g,"").slice(0,1);
      if(el.value && idx < digitIds.length-1) focusDigit(idx+1);
    });

    el.addEventListener("keydown", (e) => {
      if(e.key === "Backspace" && !el.value && idx > 0){
        focusDigit(idx-1);
      }
      if(e.key === "ArrowLeft" && idx > 0){
        e.preventDefault(); focusDigit(idx-1);
      }
      if(e.key === "ArrowRight" && idx < digitIds.length-1){
        e.preventDefault(); focusDigit(idx+1);
      }
    });

    el.addEventListener("paste", (e) => {
      e.preventDefault();
      const txt = (e.clipboardData || window.clipboardData).getData("text") || "";
      const digits = txt.replace(/\D/g,"").slice(0,4).split("");
      digits.forEach((ch, j) => {
        const target = $(digitIds[j]);
        if(target) target.value = ch;
      });
      // focus next empty
      const joined = getCandidateNoFromSquares();
      if(joined.length === 4) focusDigit(3);
      else{
        const firstEmpty = digitIds.findIndex(did => !$(did).value);
        if(firstEmpty >= 0) focusDigit(firstEmpty);
      }
    });
  });
}
wireDigitSquares();

/* -----------------------------
   Build paper (4 passages + 1 translation)
--------------------------------*/
function generateSelection(){
  const passages = pickRandom(PASSAGES, 4);
  const translation = pickRandom(TRANSLATIONS, 1)[0];
  return { passages, translation };
}
function selectionSummary(sel){
  const p = sel.passages.map(x=>`#${x.id}`).join(", ");
  return `Passages: ${p} ‚Ä¢ Translation: ${sel.translation.id}`;
}

/* -----------------------------
   Rendering
--------------------------------*/
function setBadge(text, cls="badge"){
  const b = $("#statusBadge");
  b.className = cls;
  b.textContent = text;
}

function renderHome(){
  $("#homeBody").classList.remove("hide");
  $("#testBody").classList.add("hide");
  $("#resultsBody").classList.add("hide");
  $("#sideTitle").textContent = "Otono grading";
  $("#sideMeta").textContent = "Score ‚Üí Otono grade + GCSE estimate + Pass/Merit/Distinction.";
  $("#sideBody").classList.remove("hide");
  setBadge("Ready","badge");
  $("#timerText").textContent = "--:--";
}

function renderResults(){
  $("#homeBody").classList.add("hide");
  $("#testBody").classList.add("hide");
  $("#sideBody").classList.add("hide");
  $("#resultsBody").classList.remove("hide");
  $("#sideTitle").textContent = "Saved results";
  $("#sideMeta").textContent = "Stored per candidate in this browser (localStorage).";
  setBadge("Results","badge");
  $("#timerText").textContent = "--:--";
  drawResults();
}

function stopTimer(){
  if(state.timer){
    clearInterval(state.timer);
    state.timer = null;
  }
}

function startTimer(minutes){
  stopTimer();
  state.remainingSec = Math.max(1, Math.floor(minutes*60));
  state.startedAt = Date.now();

  const tick = () => {
    if(state.submitted) return;
    const m = Math.floor(state.remainingSec/60);
    const s = state.remainingSec%60;
    $("#timerText").textContent = `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
    state.remainingSec--;
    if(state.remainingSec < 0){
      stopTimer();
      const auto = $("#autoSubmit").value === "yes";
      if(auto) submitPaper(true);
      else alert("Time is up. You can still submit manually.");
    }
  };

  tick();
  state.timer = setInterval(tick, 1000);
}

function renderTest(){
  $("#homeBody").classList.add("hide");
  $("#testBody").classList.remove("hide");
  $("#resultsBody").classList.add("hide");
  $("#sideBody").classList.remove("hide");

  const candNameLine = [
    state.candSurname ? state.candSurname : "",
    state.candForenames ? state.candForenames : ""
  ].filter(Boolean).join(", ");

  const cand = `${state.candidateNo}${candNameLine ? " ‚Ä¢ " + candNameLine : ""}`;
  $("#kpiCandidate").textContent = cand;
  $("#kpiPassages").textContent = state.selection.passages.map(p=>`#${p.id}`).join(" ");
  $("#kpiTranslation").textContent = state.selection.translation.id;

  const shuffleMode = $("#shuffleMode").value;
  const paper = $("#paper");
  paper.innerHTML = "";

  // reset per-paper MCQ mapping
  state.mcqCorrectValue = {};

  const sel = state.selection;
  const themes = sel.passages.map(p => `${p.title} (${p.theme}, ${p.unit})`);
  const head = document.createElement("div");
  head.className = "note";
  head.innerHTML = `<strong>Selected content</strong><br/>` +
    themes.map(t => `‚Ä¢ ${escapeHtml(t)}`).join("<br/>") +
    `<br/>‚Ä¢ ${escapeHtml(sel.translation.title)} (${escapeHtml(sel.translation.theme)})`;
  paper.appendChild(head);

  let allBlocks = [];

  sel.passages.forEach(p => {
    const block = document.createElement("div");
    block.className = "card";
    block.style.marginTop = "14px";

    block.innerHTML = `
      <div class="hd">
        <div>
          <h2>${escapeHtml(p.title)}</h2>
          <div class="meta">${escapeHtml(p.theme)} ‚Ä¢ ${escapeHtml(p.unit)} ‚Ä¢ <strong>20 marks</strong></div>
        </div>
        <span class="badge">${escapeHtml("#"+p.id)}</span>
      </div>
      <div class="bd">
        <div class="passage">${escapeHtml(p.text).replace(/\n/g,"<br/>")}</div>
        <div class="divider"></div>
        <div class="small">MCQ/choice options are always shuffled. Written answers are auto-marked using keyword coverage.</div>
        <div class="qs"></div>
      </div>
    `;

    const qs = block.querySelector(".qs");
    let qsList = p.questions.slice();
    if(shuffleMode === "shuffleAll") qsList = shuffle(qsList);

    qsList.forEach(q => {
      const qWrap = document.createElement("div");
      qWrap.className = "q";
      qWrap.dataset.qid = q.id;

      const markTag = `<span class="badge" title="Marks for this question">${q.marks} marks</span>`;
      const instruction = (q.type === "fr_short")
        ? "Answer in French. Auto-mark uses keywords."
        : (["mcq","pn","tfnm"].includes(q.type) ? "Select one option." : "Auto-mark uses keywords. Write concise, direct answers.");

      qWrap.innerHTML = `
        <h3>${escapeHtml(q.prompt)} ${markTag}</h3>
        ${renderQuestion(q)}
        <div class="small" style="margin-top:8px">${escapeHtml(instruction)}</div>
      `;
      qs.appendChild(qWrap);
    });

    allBlocks.push(block);
  });

  // Translation block
  const t = sel.translation;
  const tBlock = document.createElement("div");
  tBlock.className = "card";
  tBlock.style.marginTop = "14px";
  tBlock.innerHTML = `
    <div class="hd">
      <div>
        <h2>${escapeHtml(t.title)}</h2>
        <div class="meta">${escapeHtml(t.theme)} ‚Ä¢ <strong>20 marks</strong></div>
      </div>
      <span class="badge">TRANSLATION</span>
    </div>
    <div class="bd">
      <div class="passage">${escapeHtml(t.text)}</div>
      <div class="divider"></div>
      <div class="q" data-qid="translation">
        <h3>Translate into French (write naturally). <span class="badge">20 marks</span></h3>
        <textarea id="ans_translation" placeholder="Type your French translation here..."></textarea>
        <div class="small" style="margin-top:8px">Auto-mark checks key ideas. It‚Äôs strict: include the meaning clearly.</div>
      </div>
    </div>
  `;
  allBlocks.push(tBlock);

  allBlocks.forEach(b => paper.appendChild(b));

  bindInputs();

  const mins = parseInt($("#timeAllowed").value,10);
  startTimer(mins);
  state.submitted = false;

  $("#markingBox").classList.add("hide");
  $("#markingBox").innerHTML = "";
  setBadge("In progress","badge warn");
}

function renderQuestion(q){
  if(q.type === "mcq"){
    const opts = q.options.map((text, idx) => ({ text, isCorrect: idx === q.answerIndex }));
    return renderChoice(q, opts);
  }
  if(q.type === "pn"){
    // Positive / Negative / Both
    const opts = [
      { text:"P", isCorrect: q.correct === "P" },
      { text:"N", isCorrect: q.correct === "N" },
      { text:"P+N", isCorrect: q.correct === "P+N" }
    ];
    return renderChoice(q, opts);
  }
  if(q.type === "tfnm"){
    const opts = [
      { text:"True", isCorrect: q.correct === "True" },
      { text:"False", isCorrect: q.correct === "False" },
      { text:"Not mentioned", isCorrect: q.correct === "Not mentioned" }
    ];
    return renderChoice(q, opts);
  }
  // short / fr_short
  return `<textarea id="ans_${q.id}" placeholder="${q.type === "fr_short" ? "R√©ponds en fran√ßais..." : "Write your answer here..."}"></textarea>`;
}

function renderChoice(q, optionObjects){
  const name = `ans_${q.id}`;

  // ALWAYS shuffle choice options
  const shuffled = shuffle(optionObjects);

  // store which radio value is correct after shuffle
  // value = index in shuffled array
  const correctIndex = shuffled.findIndex(o => o.isCorrect);
  state.mcqCorrectValue[q.id] = String(correctIndex);

  return `
    <div class="opts">
      ${shuffled.map((opt, idx) => `
        <label class="opt">
          <input type="radio" name="${name}" value="${idx}" />
          <div><div><strong>${String.fromCharCode(65+idx)}.</strong> ${escapeHtml(opt.text)}</div></div>
        </label>
      `).join("")}
    </div>
  `;
}

function bindInputs(){
  $$("input[type='radio']").forEach(r => {
    r.addEventListener("change", () => {
      const qid = r.name.replace("ans_","");
      state.answers[qid] = r.value;
    });
  });
  $$("textarea").forEach(t => {
    t.addEventListener("input", () => {
      const id = t.id.replace("ans_","");
      state.answers[id] = t.value;
    });
  });
}

/* -----------------------------
   Auto marking
--------------------------------*/
function markShortAnswer(q, userText){
  const t = norm(userText);
  if(!t) return {score:0, max:q.marks, detail:"Blank answer."};

  const groups = q.keywords || [];
  if(groups.length === 0) return {score:0, max:q.marks, detail:"No keyword rubric set."};

  let hits = 0;
  groups.forEach(g => {
    const found = g.some(k => t.includes(norm(k)));
    if(found) hits++;
  });

  const per = q.marks / groups.length;
  const raw = hits * per;
  const score = Math.max(0, Math.min(q.marks, Math.round(raw*2)/2));

  let detail = `Keyword groups matched: ${hits}/${groups.length}.`;
  if(q.rubric) detail += ` Expected: ${q.rubric}`;
  return {score, max:q.marks, detail};
}

function markChoice(qid, chosenValue, marks){
  const correctValue = state.mcqCorrectValue[qid];
  const ok = String(chosenValue ?? "") === String(correctValue);
  return {
    score: ok ? marks : 0,
    max: marks,
    detail: ok ? "Correct." : "Incorrect."
  };
}

function markTranslation(tObj, userText){
  const t = norm(userText);
  if(!t) return {score:0, max:20, detail:"Blank translation."};

  let hits = 0;
  const ideas = tObj.keyIdeas || [];
  ideas.forEach(group => {
    const ok = group.some(k => t.includes(norm(k)));
    if(ok) hits++;
  });

  // 5 ideas √ó 4 marks
  const score = Math.min(20, hits * 4);
  const detail = `Key ideas matched: ${hits}/${ideas.length}. (4 marks each)`;
  return {score, max:20, detail};
}

function computeTotal(){
  let total = 0;
  let breakdown = [];

  state.selection.passages.forEach(p => {
    p.questions.forEach(q => {
      const ans = state.answers[q.id];
      let res;

      if(["mcq","pn","tfnm"].includes(q.type)){
        res = markChoice(q.id, ans, q.marks);
      }else{
        res = markShortAnswer(q, ans);
      }

      total += res.score;
      breakdown.push({
        qid: q.id,
        passageId: p.id,
        type: q.type,
        prompt: q.prompt,
        score: res.score,
        max: res.max,
        detail: res.detail
      });
    });
  });

  const tAns = state.answers["translation"] ?? $("#ans_translation")?.value ?? "";
  const tRes = markTranslation(state.selection.translation, tAns);
  total += tRes.score;
  breakdown.push({
    qid: "translation",
    passageId: "translation",
    type: "translation",
    prompt: "Translate into French",
    score: tRes.score,
    max: tRes.max,
    detail: tRes.detail
  });

  const totalRounded = Math.round(total*10)/10;
  return { total: totalRounded, max: 100, breakdown };
}

/* -----------------------------
   Submission + saving
--------------------------------*/
function submitPaper(fromAutoTimer=false){
  if(state.submitted) return;

  const { total, max, breakdown } = computeTotal();
  state.submitted = true;
  stopTimer();

  const letter = otonoLetterGrade(total);
  const pmd = passMeritDistinction(total);
  const gcse = gcseEstimate(total);
  const [badgeCls, badgeText] = badgeForScore(total);

  const attempt = {
    paper: "Otono French Reading (SAM) ‚Ä¢ Sample set 1",
    centre: state.centreNo,
    candidateNo: String(state.candidateNo),
    candidateSurname: state.candSurname || "",
    candidateForenames: state.candForenames || "",
    submittedAt: nowISO(),
    timeAllowedMin: parseInt($("#timeAllowed").value,10),
    selectedPassages: state.selection.passages.map(p=>p.id),
    selectedTranslation: state.selection.translation.id,
    score: total,
    maxScore: max,
    otonoGrade: letter,
    gcseEstimated: gcse,
    outcome: pmd,
    breakdown
  };
  addResult(attempt);

  const nameLine = [attempt.candidateSurname, attempt.candidateForenames].filter(Boolean).join(", ");

  const box = $("#markingBox");
  box.classList.remove("hide");
  box.className = "";
  box.innerHTML = `
    <div class="card">
      <div class="hd">
        <div>
          <h2>‚úÖ Marked${fromAutoTimer ? " (auto-submitted)" : ""}</h2>
          <div class="meta">Saved to Results ‚Ä¢ Centre ${escapeHtml(attempt.centre)} ‚Ä¢ Candidate ${escapeHtml(attempt.candidateNo)}${nameLine ? " ‚Ä¢ " + escapeHtml(nameLine) : ""}</div>
        </div>
        <span class="${badgeCls}">${escapeHtml(badgeText)}</span>
      </div>
      <div class="bd">
        <div class="kpi">
          <div class="box"><div class="t">Score</div><div class="v">${attempt.score} / ${attempt.maxScore}</div></div>
          <div class="box"><div class="t">Otono grade</div><div class="v">${escapeHtml(attempt.otonoGrade)}</div></div>
          <div class="box"><div class="t">GCSE estimate</div><div class="v">${escapeHtml(String(attempt.gcseEstimated))}</div></div>
          <div class="box"><div class="t">Outcome</div><div class="v">${escapeHtml(attempt.outcome)}</div></div>
        </div>

        <div class="divider"></div>

        <div class="note">
          <strong>Marking notes</strong><br/>
          ‚Ä¢ MCQ / P-N / TFNM are exact (options are shuffled).<br/>
          ‚Ä¢ Written + translation are keyword-based. If you used very different wording, it may under-mark.
        </div>

        <div class="divider"></div>

        <button class="btn" id="btnShowBreakdown">Show question breakdown</button>
        <div id="breakdown" class="hide" style="margin-top:12px"></div>

        <div class="divider"></div>

        <div class="note">
          <strong>Translation model answer (for reference)</strong><br/>
          ${escapeHtml(state.selection.translation.sampleAnswer)}
        </div>
      </div>
    </div>
  `;

  $("#btnShowBreakdown").addEventListener("click", () => {
    const bd = $("#breakdown");
    bd.classList.toggle("hide");
    if(!bd.classList.contains("hide")){
      bd.innerHTML = breakdown.map(b => `
        <div class="attempt">
          <div class="top">
            <div><strong>${escapeHtml(b.qid)}</strong> ‚Ä¢ ${escapeHtml(String(b.type))}</div>
            <div><span class="badge">${b.score} / ${b.max}</span></div>
          </div>
          <div class="meta">
            <div><strong>Prompt:</strong> ${escapeHtml(b.prompt)}</div>
            <div><strong>Marker:</strong> ${escapeHtml(b.detail)}</div>
          </div>
        </div>
      `).join("");
    }
  });

  setBadge("Submitted","badge good");
}

/* -----------------------------
   Results UI
--------------------------------*/
function drawResults(){
  const listEl = $("#resultsList");
  const all = loadResults();
  const filter = ($("#filterCandidate").value || "").replace(/\D/g,"").slice(0,4);

  const filtered = filter ? all.filter(a => String(a.candidateNo) === String(filter)) : all;

  if(filtered.length === 0){
    listEl.innerHTML = `<div class="note">No stored attempts${filter ? " for this candidate" : ""} yet.</div>`;
    return;
  }

  listEl.innerHTML = filtered.map(a => {
    const [cls, txt] = badgeForScore(a.score);
    const nameLine = [a.candidateSurname, a.candidateForenames].filter(Boolean).join(", ");
    return `
      <div class="attempt">
        <div class="top">
          <div>
            <strong>${escapeHtml(a.candidateNo)}</strong>${nameLine ? " ‚Ä¢ " + escapeHtml(nameLine) : ""}
            <span class="badge" style="margin-left:8px">Centre ${escapeHtml(a.centre)}</span>
          </div>
          <div class="${cls}">${escapeHtml(txt)} ‚Ä¢ ${escapeHtml(String(a.score))}/100</div>
        </div>
        <div class="meta">
          <div><strong>Date:</strong> ${escapeHtml(new Date(a.submittedAt).toLocaleString())}</div>
          <div><strong>Selection:</strong> Passages ${escapeHtml(a.selectedPassages.join(", "))} ‚Ä¢ Translation ${escapeHtml(a.selectedTranslation)}</div>
          <div><strong>Grades:</strong> Otono ${escapeHtml(a.otonoGrade)} ‚Ä¢ GCSE ${escapeHtml(String(a.gcseEstimated))} ‚Ä¢ ${escapeHtml(a.outcome)}</div>
        </div>
      </div>
    `;
  }).join("");
}

function exportResults(){
  const all = loadResults();
  $("#exportText").textContent = JSON.stringify(all, null, 2);
  $("#exportBox").classList.remove("hide");
}

function clearResults(){
  if(!confirm("Clear ALL stored Otono French results on this browser?")) return;
  localStorage.removeItem(STORE_KEY);
  drawResults();
  $("#exportBox").classList.add("hide");
}

/* -----------------------------
   Buttons / navigation
--------------------------------*/
$("#btnHome").addEventListener("click", () => {
  state.mode = "home";
  renderHome();
});

$("#btnResults").addEventListener("click", () => {
  state.mode = "results";
  renderResults();
});

$("#btnPreview").addEventListener("click", () => {
  const c = getCandidateNoFromSquares();
  if(!c){
    alert("Enter a candidate number first.");
    return;
  }
  const sel = generateSelection();
  const box = $("#previewBox");
  box.classList.remove("hide");
  box.innerHTML = `<strong>Preview (not started):</strong><br/>${escapeHtml(selectionSummary(sel))}<br/>` +
    sel.passages.map(p => `‚Ä¢ ${escapeHtml(p.title)} (${escapeHtml(p.theme)})`).join("<br/>") +
    `<br/>‚Ä¢ ${escapeHtml(sel.translation.title)} (${escapeHtml(sel.translation.theme)})`;
});

$("#btnStart").addEventListener("click", () => {
  const c = getCandidateNoFromSquares();
  if(!c){
    alert("Candidate number is required.");
    focusDigit(0);
    return;
  }

  state.candidateNo = c;
  state.candSurname = ($("#candSurname").value || "").trim();
  state.candForenames = ($("#candForenames").value || "").trim();

  state.selection = generateSelection();
  state.answers = {};
  renderTest();
});

$("#btnSubmit").addEventListener("click", () => submitPaper(false));

$("#btnReset").addEventListener("click", () => {
  if(!confirm("Reset this paper and generate a NEW random test? Your current answers will be lost.")) return;
  stopTimer();
  state.answers = {};
  state.submitted = false;
  state.selection = generateSelection();
  renderTest();
});

/* Results filters & tabs */
$("#filterCandidate").addEventListener("input", (e) => {
  e.target.value = e.target.value.replace(/\D/g,"").slice(0,4);
  drawResults();
});

$("#tabAll").addEventListener("click", () => {
  $("#tabAll").classList.add("active");
  $("#tabCandidate").classList.remove("active");
  $("#filterCandidate").value = "";
  drawResults();
});

$("#tabCandidate").addEventListener("click", () => {
  $("#tabCandidate").classList.add("active");
  $("#tabAll").classList.remove("active");
  $("#filterCandidate").focus();
});

$("#btnExport").addEventListener("click", exportResults);
$("#btnClear").addEventListener("click", clearResults);

/* Initial */
setCentre("50749");
renderHome();

/* -----------------------------
   Anti-cheat / source protection
   (as requested)
--------------------------------*/
const disabledKeys = ["u", "I"];
const showAlert = e => {
  e.preventDefault();
  return alert("Hahaha, I challenge you, valiant soldier, to uproot the source codes yourself!!!");
};
document.addEventListener("contextmenu", e => { showAlert(e); });
document.addEventListener("keydown", e => {
  if ((e.ctrlKey && disabledKeys.includes(e.key)) || e.key === "F12") {
    showAlert(e);
  }
});
</script>

</body>
</html>
