<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üü£ Otono Spanish ‚Äî Reading (SAM) ‚Ä¢ Sample set 1</title>
  <style>
    :root{
      --bg1:#2b0a3d; --bg2:#7a0036;
      --card:#0f0b18cc; --card2:#120c22e6;
      --text:#f4efff; --muted:#c9b9ff;
      --accent:#b000ff; --accent2:#ff1b6a;
      --good:#19ff9a; --warn:#ffd166; --bad:#ff4d6d;
      --line:rgba(255,255,255,.12);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--sans); color:var(--text);
      background:
        radial-gradient(1000px 700px at 15% 10%, rgba(176,0,255,.22), transparent 60%),
        radial-gradient(900px 650px at 80% 20%, rgba(255,27,106,.18), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    .wrap{max-width:1100px; margin:0 auto; padding:22px;}
    .topbar{
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      padding:14px 16px; border:1px solid var(--line); border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      position:sticky; top:14px; z-index:20; backdrop-filter: blur(10px);
    }
    .brand{display:flex; flex-direction:column; gap:2px}
    .brand h1{margin:0; font-size:16px; letter-spacing:.3px}
    .brand .sub{font-size:12px; color:var(--muted)}
    .pill{
      padding:8px 10px; border-radius:999px; border:1px solid var(--line);
      background:rgba(0,0,0,.25); font-family:var(--mono); font-size:12px;
      display:flex; gap:10px; align-items:center;
    }
    .pill strong{color:#fff}
    .btn{
      border:1px solid var(--line); background:rgba(0,0,0,.25);
      color:var(--text); padding:10px 12px; border-radius:14px; cursor:pointer;
      transition:.15s transform, .15s background, .15s border;
      font-weight:600;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(0,0,0,.33); border-color:rgba(255,255,255,.22)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(176,0,255,.55), rgba(255,27,106,.45));
      border-color:rgba(255,255,255,.22);
    }
    .btn.danger{background:rgba(255,77,109,.18); border-color:rgba(255,77,109,.35)}
    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:16px; margin-top:16px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} .topbar{position:static} }

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px; border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent);
    }
    .card .hd h2{margin:0; font-size:14px}
    .card .hd .meta{font-size:12px; color:var(--muted); line-height:1.25}
    .card .bd{padding:16px}
    label{display:block; font-size:12px; color:var(--muted); margin:10px 0 6px}

    input[type="text"], input[type="number"], textarea, select{
      width:100%; border:1px solid var(--line); background:rgba(0,0,0,.25);
      color:var(--text); padding:10px 12px; border-radius:14px; outline:none;
      font-family:var(--sans);
    }
    textarea{min-height:90px; resize:vertical}

    .row{display:flex; gap:10px; flex-wrap:wrap}
    .row > div{flex:1 1 180px}

    .note{
      font-size:12px; color:var(--muted); line-height:1.4;
      padding:10px 12px; border-radius:14px; border:1px dashed rgba(255,255,255,.18);
      background:rgba(0,0,0,.18);
    }
    .badge{
      font-family:var(--mono); font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid var(--line); background:rgba(0,0,0,.20);
      display:inline-flex; align-items:center; gap:6px;
    }
    .badge.good{border-color:rgba(25,255,154,.35); background:rgba(25,255,154,.12)}
    .badge.warn{border-color:rgba(255,209,102,.35); background:rgba(255,209,102,.12)}
    .badge.bad{border-color:rgba(255,77,109,.35); background:rgba(255,77,109,.12)}
    .divider{height:1px; background:var(--line); margin:14px 0}
    .passage{
      padding:12px 14px; border:1px solid var(--line); border-radius:16px;
      background:rgba(0,0,0,.22); line-height:1.5;
    }
    .q{
      margin-top:14px; padding:12px 14px; border:1px solid var(--line);
      border-radius:16px; background:rgba(0,0,0,.20);
    }
    .q h3{margin:0 0 8px; font-size:13px}
    .opts{display:grid; gap:8px; margin-top:8px}
    .opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 10px; border-radius:14px; border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      cursor:pointer;
    }
    .opt input{margin-top:3px}
    .kpi{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    @media (max-width: 980px){ .kpi{grid-template-columns:repeat(2,1fr)} }
    .kpi .box{
      border:1px solid var(--line); border-radius:16px; padding:10px 12px;
      background:rgba(0,0,0,.22);
    }
    .kpi .box .t{font-size:12px; color:var(--muted)}
    .kpi .box .v{font-size:18px; font-weight:800; margin-top:4px}
    .small{font-size:12px; color:var(--muted)}
    .tabs{display:flex; gap:8px; flex-wrap:wrap}
    .tab{padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:rgba(0,0,0,.22); cursor:pointer; font-weight:700}
    .tab.active{background:linear-gradient(135deg, rgba(176,0,255,.35), rgba(255,27,106,.22)); border-color:rgba(255,255,255,.22)}
    .resultsList{display:grid; gap:10px}
    .attempt{
      border:1px solid var(--line); border-radius:16px; padding:12px 14px;
      background:rgba(0,0,0,.20);
    }
    .attempt .top{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .attempt .top strong{font-family:var(--mono)}
    .attempt .meta{font-size:12px; color:var(--muted); margin-top:6px; line-height:1.4}
    .copy{font-family:var(--mono); font-size:12px; white-space:pre-wrap; word-break:break-word}
    .hide{display:none !important}

    /* Candidate number 4 squares */
    .digitRow{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .digitRow .digit{
      width:52px; text-align:center; font-family:var(--mono);
      font-size:18px; font-weight:900; padding:12px 0;
      border-radius:14px; border:1px solid var(--line);
      background:rgba(0,0,0,.25); color:var(--text);
      outline:none;
    }
    .digitRow .hint{font-size:12px; color:var(--muted)}
    .miniRow{display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end}
    .miniRow > *{flex:1 1 160px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <h1>üü£ Otono Spanish ‚Äî Paper 3 ‚Ä¢ Reading ‚Ä¢ Sample Assessment Material ‚Ä¢ Sample set 1</h1>
        <div class="sub">
          Auto marking ‚Ä¢ 4 random passages √ó 20 + 1 translation √ó 20 = 100 ‚Ä¢ Centre:
          <strong id="centreTop">50749</strong>
        </div>
      </div>
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end">
        <div class="pill">
          <span>‚è±Ô∏è Timer:</span>
          <strong id="timerText">--:--</strong>
        </div>
        <button class="btn" id="btnResults">Results</button>
        <button class="btn primary" id="btnHome">Test</button>
      </div>
    </div>

    <div class="grid">
      <!-- Left: main -->
      <div class="card" id="panelHome">
        <div class="hd">
          <div>
            <h2>Candidate setup</h2>
            <div class="meta">No dictionary ‚Ä¢ No translator ‚Ä¢ Answer from the text ‚Ä¢ Auto marking for written answers uses keywords (not perfect).</div>
          </div>
          <span class="badge" id="statusBadge">Ready</span>
        </div>

        <div class="bd" id="homeBody">
          <div class="miniRow">
            <div>
              <label>Centre number</label>
              <input type="text" id="centreNo" value="50749" disabled />
              <div class="small" style="margin-top:6px">
                Default is <strong>50749</strong>. You can change it (optional) with the button.
              </div>
            </div>
            <div style="display:flex; gap:10px; align-items:flex-end; flex-wrap:wrap">
              <button class="btn" id="btnEditCentre">Customise centre</button>
              <button class="btn" id="btnResetCentre">Reset centre</button>
            </div>
          </div>

          <div class="divider"></div>

          <div>
            <label>Candidate number (required, 4 digits)</label>
            <div class="digitRow" aria-label="Candidate number 4 digits">
              <input class="digit" id="candD1" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD2" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD3" inputmode="numeric" maxlength="1" />
              <input class="digit" id="candD4" inputmode="numeric" maxlength="1" />
              <span class="hint">Digits only ‚Ä¢ auto-advance</span>
            </div>
          </div>

          <div class="row" style="margin-top:6px">
            <div>
              <label>Candidate surname (optional)</label>
              <input type="text" id="candSurname" placeholder="Surname" />
            </div>
            <div>
              <label>Candidate forename(s) (optional)</label>
              <input type="text" id="candForenames" placeholder="Forename(s)" />
            </div>
          </div>

          <div class="divider"></div>

          <div class="note">
            <strong>How the random paper works (SAM set 1):</strong><br/>
            ‚Ä¢ The system selects <strong>4 random passages</strong> (each worth <strong>20</strong>) and <strong>1 random translation</strong> (worth <strong>20</strong>).<br/>
            ‚Ä¢ You‚Äôll get a mix of <strong>MCQ</strong>, <strong>P/N/P+N</strong>, <strong>True/False/Not mentioned</strong>, and <strong>written answers</strong>.<br/>
            ‚Ä¢ Some passages include <strong>questions answered in Spanish</strong> (you must answer in Spanish).<br/>
            ‚Ä¢ Written + translation answers are marked by <strong>keyword coverage</strong> (so write clear, direct answers).<br/>
            ‚Ä¢ Your attempt is saved to this browser using <strong>localStorage</strong>.
          </div>

          <div class="divider"></div>

          <div class="row">
            <div>
              <label>Time allowed</label>
              <select id="timeAllowed">
                <option value="75" selected>75 minutes (recommended)</option>
                <option value="60">60 minutes</option>
                <option value="45">45 minutes</option>
              </select>
            </div>
            <div>
              <label>Question order</label>
              <select id="shuffleMode">
                <option value="shuffleAll" selected>Shuffle questions (harder)</option>
                <option value="keepOrder">Keep original order</option>
              </select>
            </div>
            <div>
              <label>On timer end</label>
              <select id="autoSubmit">
                <option value="yes" selected>Auto-submit</option>
                <option value="no">Do not auto-submit</option>
              </select>
            </div>
          </div>

          <div style="display:flex; gap:10px; margin-top:14px; flex-wrap:wrap">
            <button class="btn primary" id="btnStart">Start Random Paper</button>
            <button class="btn" id="btnPreview">Preview Random Selection</button>
          </div>

          <div id="previewBox" class="note hide" style="margin-top:12px"></div>
        </div>

        <!-- Test body -->
        <div class="bd hide" id="testBody">
          <div class="kpi">
            <div class="box"><div class="t">Candidate</div><div class="v" id="kpiCandidate">‚Äî</div></div>
            <div class="box"><div class="t">Selected passages</div><div class="v" id="kpiPassages">‚Äî</div></div>
            <div class="box"><div class="t">Translation</div><div class="v" id="kpiTranslation">‚Äî</div></div>
            <div class="box"><div class="t">Max score</div><div class="v">100</div></div>
          </div>

          <div class="divider"></div>

          <div class="note">
            <strong>Instructions reminder:</strong>
            No dictionary. Do not copy from outside. Base answers on the passage. For written answers, include the key idea(s) clearly.
          </div>

          <div id="paper"></div>

          <div class="divider"></div>

          <div style="display:flex; gap:10px; flex-wrap:wrap">
            <button class="btn primary" id="btnSubmit">Submit & Auto-Mark</button>
            <button class="btn" id="btnReset">Reset (new random paper)</button>
          </div>

          <div id="markingBox" class="hide" style="margin-top:14px"></div>
        </div>
      </div>

      <!-- Right: results / help -->
      <div class="card" id="panelSide">
        <div class="hd">
          <div>
            <h2 id="sideTitle">Otono grading</h2>
            <div class="meta" id="sideMeta">Score ‚Üí Otono grade + GCSE estimate + Pass/Merit/Distinction.</div>
          </div>
        </div>

        <div class="bd" id="sideBody">
          <div class="note">
            <strong>Pass/Merit/Distinction</strong><br/>
            PASS: 66+<br/>
            MERIT: 80+<br/>
            DISTINCTION: 90+<br/>
          </div>
          <div class="divider"></div>
          <div class="note">
            <strong>Otono grades (A‚ÄìH + secret S)</strong><br/>
            S: 101+ (secret)<br/>
            A*: 95‚Äì100<br/>
            A: 90‚Äì94<br/>
            B: 80‚Äì89<br/>
            C: 70‚Äì79<br/>
            D: 66‚Äì69<br/>
            E: 55‚Äì65<br/>
            F: 45‚Äì54<br/>
            G: 30‚Äì44<br/>
            H: 15‚Äì29<br/>
            U: 0‚Äì14
          </div>
          <div class="divider"></div>
          <div class="note">
            <strong>GCSE 9‚Äì1 estimate (simple mapping)</strong><br/>
            9: 90‚Äì100 ‚Ä¢ 8: 80‚Äì89 ‚Ä¢ 7: 70‚Äì79 ‚Ä¢ 6: 60‚Äì69 ‚Ä¢ 5: 50‚Äì59<br/>
            4: 40‚Äì49 ‚Ä¢ 3: 30‚Äì39 ‚Ä¢ 2: 20‚Äì29 ‚Ä¢ 1: 10‚Äì19 ‚Ä¢ U: 0‚Äì9
          </div>
          <div class="divider"></div>
          <div class="small">
            Tip: results are stored locally on this device/browser only. If you clear site data, they disappear.
          </div>
        </div>

        <!-- Results panel -->
        <div class="bd hide" id="resultsBody">
          <div class="tabs">
            <div class="tab active" id="tabAll">All attempts</div>
            <div class="tab" id="tabCandidate">By candidate</div>
          </div>

          <div class="row" style="margin-top:10px">
            <div>
              <label>Filter candidate number (4 digits)</label>
              <input type="text" id="filterCandidate" placeholder="e.g. 1105" inputmode="numeric" />
            </div>
            <div>
              <label>Actions</label>
              <div style="display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn" id="btnExport">Export JSON</button>
                <button class="btn danger" id="btnClear">Clear stored results</button>
              </div>
            </div>
          </div>

          <div class="divider"></div>
          <div class="resultsList" id="resultsList"></div>

          <div id="exportBox" class="note hide" style="margin-top:12px">
            <div><strong>Exported JSON</strong> (copy/save it):</div>
            <div class="divider"></div>
            <div class="copy" id="exportText"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* -----------------------------
   OTONO BANK (STRAIGHTFORWARD TEXT, SIMILAR LENGTH)
   Each passage total = 20 marks
--------------------------------*/

const PASSAGES = [
  {
    id: 1,
    title: "Pasaje 1 ‚Äî Se√±or Barley y el m√©todo",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 1 (Se√±or Barley)",
    text: `Se√±or Barley es profesor de ciencias en la escuela Otono. Habla con calma y le gusta que todo sea claro. En su aula hay reglas sencillas: los cuadernos est√°n guardados, las mesas est√°n limpias y el material est√° listo antes de la clase. Los alumnos dicen que es estricto, pero Se√±or Barley responde: ¬´Quiero sobre todo que sea preciso¬ª.

Antes de cada prueba, repite la misma idea: hay que leer la consigna y responder exactamente a la pregunta. Explica que un alumno puede conocer el tema, pero perder puntos si la respuesta no es completa. Por ejemplo, si la pregunta pide una justificaci√≥n, escribir una sola palabra no basta. Si la pregunta pide dos razones, dar una sola raz√≥n no es suficiente.

Red escucha e intenta cambiar su forma de trabajar. Vuelve a leer la pregunta, subraya las palabras importantes y comprueba cu√°ntos detalles se piden. Piensa que este peque√±o esfuerzo puede evitar errores simples.`,
    questions: [
      {
        id: "p1q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What subject does Se√±or Barley teach?",
        options: ["Science", "Music", "PE", "English"],
        answerIndex: 0
      },
      {
        id: "p1q2",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents Se√±or Barley‚Äôs classroom style as‚Ä¶ (P / N / P+N)",
        correct: "P"
      },
      {
        id: "p1q3",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO signs that the classroom is organised.",
        rubric:
          "Any two: notebooks are put away; tables are clean; equipment is ready; simple rules; everything is clear.",
        keywords: [
          ["notebooks", "cuadernos", "guardados", "guardar"],
          ["tables", "mesas", "clean", "limpias", "limpia"],
          ["equipment", "material", "ready", "listo", "lista"],
          ["rules", "reglas", "simple", "sencillas"],
          ["clear", "claro", "clara"]
        ]
      },
      {
        id: "p1q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says Se√±or Barley is a maths teacher. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p1q5",
        type: "short",
        marks: 6,
        prompt:
          "(H) Give ONE example from the passage of how someone could lose marks, and say what they should do instead.",
        rubric:
          "Example: if justification is required ‚Üí explain; if two reasons are required ‚Üí give two reasons.",
        keywords: [
          ["justification", "justificar", "explain", "explicar", "porque", "ya que"],
          ["two", "dos", "reasons", "razones"],
          ["instead", "en lugar", "should", "debe", "hay que"]
        ]
      },
      {
        id: "p1q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øQu√© hace Red para evitar errores simples? Da DOS acciones.",
        rubric:
          "Dos de: vuelve a leer la pregunta; subraya palabras importantes; comprueba cu√°ntos detalles se piden.",
        keywords: [
          ["vuelve a leer", "leer", "pregunta"],
          ["subraya", "subrayar", "palabras", "importantes"],
          ["comprueba", "comprobar", "detalles", "piden"]
        ]
      }
    ]
  },

  {
    id: 2,
    title: "Pasaje 2 ‚Äî La tinta y las consignas",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 2 (Sistema de tinta)",
    text: `Antes de los ex√°menes en Otono, se habla a menudo de los bol√≠grafos. Algunos alumnos escriben sin hacerse preguntas. Otros se estresan, porque tienen miedo de usar el bol√≠grafo equivocado y perder puntos.

A Luke le gusta la tinta negra. Dice que es limpia y f√°cil de leer. En matem√°ticas, a menudo se pide escribir en negro, porque los ex√°menes se escanean. Pero en ciencias, los alumnos a veces oyen consignas diferentes: se puede pedir evitar ciertas tintas o seguir una regla particular para un documento.

Esta situaci√≥n puede crear confusi√≥n. La v√≠spera de un examen, algunos alumnos preparan dos bol√≠grafos. Otros preguntan al profesor. Red elige una estrategia simple: se mantiene tranquilo y lee la consigna escrita en la hoja del examen, porque esa es la regla oficial.`,
    questions: [
      {
        id: "p2q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) Why do some students stress before exams?",
        options: ["They want more homework", "They fear using the wrong pen", "They dislike reading", "They forget lunch"],
        answerIndex: 1
      },
      {
        id: "p2q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO reasons Luke likes black ink.",
        rubric: "Any two: clean/neat; easy to read; clear.",
        keywords: [
          ["clean", "limpia", "limpio", "ordenada", "pulcra"],
          ["easy", "f√°cil", "leer", "legible"],
          ["clear", "clara", "claro"]
        ]
      },
      {
        id: "p2q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, the passage presents pen rules as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p2q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says science always uses the same ink rules as maths. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p2q5",
        type: "short",
        marks: 6,
        prompt: "(H) What is Red‚Äôs strategy, and why is it sensible?",
        rubric: "He stays calm and reads the written instructions; sensible because written instructions are official.",
        keywords: [
          ["calm", "tranquilo", "tranquila", "calma"],
          ["read", "leer", "consigna", "instructions", "instrucciones"],
          ["written", "escrita", "hoja", "papel"],
          ["official", "oficial", "rule", "regla"]
        ]
      },
      {
        id: "p2q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: Da UNA soluci√≥n mencionada para evitar la confusi√≥n sobre los bol√≠grafos.",
        rubric: "Una: preparar dos bol√≠grafos / preguntar al profesor / leer la consigna en la hoja del examen.",
        keywords: [
          ["preparan", "preparar", "dos", "bol√≠grafos", "boligrafos"],
          ["preguntan", "preguntar", "profesor"],
          ["lee", "leer", "consigna", "hoja", "examen"]
        ]
      },
      {
        id: "p2q7",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions Luke using blue ink for maths. (True / False / Not mentioned)",
        correct: "Not mentioned"
      }
    ]
  },

  {
    id: 3,
    title: "Pasaje 3 ‚Äî Elegir las opciones GCSE",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 3 (Opciones GCSE)",
    text: `Elegir las opciones del GCSE es importante para muchos alumnos. Algunos eligen r√°pido, porque ya saben lo que quieren hacer. Otros dudan, porque les gustan varias asignaturas o tienen miedo de equivocarse.

En Otono, tambi√©n hay limitaciones: puede haber un n√∫mero limitado de plazas en una clase, y algunas asignaturas pueden coincidir en el horario. Thomas duda sobre el franc√©s. Le gusta la asignatura, pero se pregunta si ser√° lo bastante bueno. Habla con otros alumnos y comprende que tienen las mismas preocupaciones.

Al final, Thomas elige franc√©s. La escuela acepta su elecci√≥n, aunque sea un poco tarde. Para √©l, es tranquilizador: si uno explica bien su situaci√≥n, el sistema puede ser flexible.`,
    questions: [
      {
        id: "p3q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What is the passage mainly about?",
        options: ["Choosing GCSE options", "A sports match", "A school trip", "Cooking lessons"],
        answerIndex: 0
      },
      {
        id: "p3q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO reasons some students hesitate when choosing options.",
        rubric: "Any two: like several subjects; fear making the wrong choice; worry they aren‚Äôt good enough; timetable clashes; limited places.",
        keywords: [
          ["varias", "asignaturas", "materias", "several", "subjects"],
          ["miedo", "equivocarse", "wrong choice", "fear"],
          ["lo bastante bueno", "good enough"],
          ["horario", "coincidir", "clash", "same time"],
          ["plazas", "limitado", "limited"]
        ]
      },
      {
        id: "p3q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents Thomas‚Äôs final choice as‚Ä¶ (P / N / P+N)",
        correct: "P"
      },
      {
        id: "p3q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says Thomas dislikes French. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p3q5",
        type: "short",
        marks: 6,
        prompt: "(H) What helps Thomas make his decision, and what happens in the end?",
        rubric: "He talks to other students and realises they share worries; he chooses French; the school accepts it even though it is a bit late.",
        keywords: [
          ["habla", "hablar", "talks"],
          ["otros", "alumnos", "students"],
          ["mismas", "preocupaciones", "same worries"],
          ["elige", "franc√©s", "choose French"],
          ["acepta", "accepts", "tarde", "late"]
        ]
      }
    ]
  },

  {
    id: 4,
    title: "Pasaje 4 ‚Äî En la sala de examen",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (Reglas de examen)",
    text: `El d√≠a del examen, el ambiente cambia en el pasillo. Los alumnos hablan menos. Algunos vuelven a leer sus apuntes por √∫ltima vez. Otros esperan en silencio. Cuando se abre la puerta, todos entran con calma.

En la sala, las mesas est√°n separadas y las mochilas se colocan al frente. El vigilante espera a que todos est√©n sentados y luego lee las consignas: escribir con claridad, nada de m√≥vil y respetar la lista de objetos prohibidos.

Cuando habla de esa lista, algunos alumnos entran en p√°nico. Se preguntan si han olvidado algo en un bolsillo. Red, en cambio, se mantiene concentrado. Se repite que un peque√±o error puede costar puntos, pero que lo m√°s importante es seguir las consignas hasta el final.`,
    questions: [
      {
        id: "p4q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) Where are the bags placed in the exam room?",
        options: ["At the front", "Under each chair", "Outside the school", "On the tables"],
        answerIndex: 0
      },
      {
        id: "p4q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO exam-room details from the passage.",
        rubric: "Any two: spaced tables; bags at the front; invigilator reads instructions; phones not allowed; list of forbidden items.",
        keywords: [
          ["mesas", "separadas", "spaced tables"],
          ["mochilas", "al frente", "bags front"],
          ["vigilante", "lee", "consignas", "invigilator reads instructions"],
          ["m√≥vil", "movil", "phone not allowed"],
          ["objetos", "prohibidos", "lista", "forbidden list"]
        ]
      },
      {
        id: "p4q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, the exam room atmosphere is presented as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p4q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says the invigilator allows phones. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p4q5",
        type: "short",
        marks: 6,
        prompt: "(H) What does Red tell himself to stay calm, and what does he focus on?",
        rubric: "Small mistakes can lose marks, but the key is to follow instructions until the end; he stays focused.",
        keywords: [
          ["peque√±o", "error", "small mistake"],
          ["costar", "puntos", "lose marks"],
          ["lo m√°s importante", "most important"],
          ["seguir", "consignas", "follow instructions"],
          ["hasta el final", "until the end"]
        ]
      },
      {
        id: "p4q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øPor qu√© algunos alumnos entran en p√°nico cuando oyen la lista de objetos prohibidos?",
        rubric: "Porque temen haber olvidado algo en un bolsillo.",
        keywords: [
          ["p√°nico", "panico"],
          ["temen", "miedo"],
          ["olvidado", "olvidar"],
          ["bolsillo", "bolsillos"],
          ["objetos", "prohibidos"]
        ]
      },
      {
        id: "p4q7",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions students bringing a dictionary into the exam. (True / False / Not mentioned)",
        correct: "Not mentioned"
      }
    ]
  },

  {
    id: 5,
    title: "Pasaje 5 ‚Äî El servidor de Minecraft Otono: cooperaci√≥n y tensiones",
    theme: "Tema 2 ‚Äî Tiempo libre",
    unit: "Unidad 5 (Minecraft server)",
    text: `En el servidor de Minecraft Otono, los jugadores suelen construir en equipo. Antes de una construcci√≥n grande, eligen un objetivo claro: una casa, una torre o una zona completa del mundo. Luego se reparten las tareas. Por ejemplo, una persona consigue materiales, otra construye la estructura y otra revisa los detalles para evitar errores.

Esta organizaci√≥n ayuda mucho, pero tambi√©n puede crear tensiones. Red quiere ir r√°pido y ver resultados inmediatamente. OWing prefiere avanzar m√°s despacio: revisa el plan, corrige errores peque√±os y insiste en la precisi√≥n. A veces, Red piensa que OWing frena el proyecto. A veces, OWing piensa que Red va demasiado r√°pido y se olvida de detalles.

Cuando siguen un m√©todo simple, el proyecto funciona mejor. Primero hacen una etapa r√°pida (la estructura) y despu√©s una etapa de revisi√≥n (los detalles). As√≠ ahorran tiempo, porque evitan tener que rehacer el trabajo m√°s tarde.`,
    questions: [
      {
        id: "p5q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) On the Otono Minecraft server, players usually build‚Ä¶",
        options: ["Alone", "In teams", "Only in silence", "Without a plan"],
        answerIndex: 1
      },
      {
        id: "p5q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO example roles mentioned in the passage.",
        rubric: "Two roles such as: get materials; build the structure; check details/correct errors.",
        keywords: [
          ["materiales", "consigue", "get materials"],
          ["construye", "estructura", "build structure"],
          ["revisa", "detalles", "check details"],
          ["corrige", "errores", "correct errors"]
        ]
      },
      {
        id: "p5q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents teamwork on the server as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p5q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says OWing prefers to work slowly and check details. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p5q5",
        type: "short",
        marks: 6,
        prompt: "(H) Explain ONE reason Red and OWing sometimes disagree, and how the two-step method helps.",
        rubric:
          "They disagree about speed vs precision; the method separates fast building from later checking, reducing rework and tension.",
        keywords: [
          ["r√°pido", "speed"],
          ["precisi√≥n", "precision"],
          ["desacuerdo", "tensi√≥n", "tensions"],
          ["etapa", "r√°pida", "fast stage"],
          ["revisi√≥n", "detalles", "checking"],
          ["rehacer", "rework", "m√°s tarde"]
        ]
      }
    ]
  },

  {
    id: 6,
    title: "Pasaje 6 ‚Äî Otono Airways: comodidad y l√≠mites",
    theme: "Tema 3 ‚Äî Otono Team",
    unit: "Unidad 8 (Otono Airways)",
    text: `Viajar con Otono Airways suele ser c√≥modo. Los pasajeros notan la organizaci√≥n en la cabina, la distribuci√≥n de los asientos y el ambiente general. Incluso en clase econ√≥mica, muchos consideran que hay suficiente espacio para sentarse bien.

Sin embargo, no todo es perfecto. Algunos pasajeros piensan que las reglas a bordo son estrictas, sobre todo en zonas tranquilas como el sal√≥n. Otros dicen que el servicio puede sentirse demasiado r√°pido: la comida llega pronto, pero hay menos tiempo para hablar con la tripulaci√≥n. Red observa estos detalles con atenci√≥n. Para √©l, un buen vuelo depende de un equilibrio entre comodidad, eficacia y respeto de las instrucciones.

Al final, Red concluye que la experiencia es positiva, pero que tambi√©n tiene peque√±os l√≠mites seg√∫n las expectativas de cada persona.`,
    questions: [
      {
        id: "p6q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) The passage says travelling with Otono Airways is usually‚Ä¶",
        options: ["Uncomfortable", "Comfortable", "Dangerous", "Impossible"],
        answerIndex: 1
      },
      {
        id: "p6q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO things passengers notice in the cabin.",
        rubric: "Any two: organisation; seat layout; general atmosphere; enough space in economy.",
        keywords: [
          ["organizaci√≥n", "organisation"],
          ["distribuci√≥n", "layout"],
          ["asientos", "seats"],
          ["ambiente", "atmosphere"],
          ["espacio", "econ√≥mica", "economy space"]
        ]
      },
      {
        id: "p6q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, the passage presents Otono Airways as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p6q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says the lounge rules can feel strict. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p6q5",
        type: "short",
        marks: 6,
        prompt: "(H) Give ONE criticism and ONE positive point mentioned, then explain Red‚Äôs ‚Äòbalance‚Äô.",
        rubric:
          "Criticism: strict rules / service too fast / less time with crew. Positive: comfort / organisation / space. Balance: comfort + efficiency + respecting rules.",
        keywords: [
          ["estrictas", "rules", "strict"],
          ["sal√≥n", "lounge"],
          ["servicio", "r√°pido", "fast service"],
          ["menos tiempo", "tripulaci√≥n", "less time with crew"],
          ["c√≥modo", "comodidad", "comfort"],
          ["organizaci√≥n", "organisation"],
          ["espacio", "space"],
          ["equilibrio", "comodidad", "eficacia", "respeto", "instrucciones"]
        ]
      },
      {
        id: "p6q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øQu√© tres elementos dice Red que forman un buen vuelo?",
        rubric: "Comodidad, eficacia y respeto de las instrucciones.",
        keywords: [
          ["comodidad"],
          ["eficacia"],
          ["respeto"],
          ["instrucciones", "consignas", "reglas"]
        ]
      }
    ]
  },

  {
    id: 7,
    title: "Pasaje 7 ‚Äî La gesti√≥n del tiempo",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (T√©cnicas de estudio)",
    text: `Para tener √©xito en la escuela, la gesti√≥n del tiempo es esencial. Algunos alumnos empiezan los deberes muy tarde y se sienten estresados. Otros prefieren trabajar un poco cada d√≠a para evitar la presi√≥n.

Red intenta organizar su trabajo con antelaci√≥n. Usa un horario sencillo donde anota sus deberes y sus repasos. No siempre trabaja mucho tiempo, pero trabaja con regularidad. Seg√∫n √©l, este m√©todo permite mantenerse concentrado y evitar el cansancio antes de los ex√°menes.`,
    questions: [
      {
        id: "p7q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) Time management is described as‚Ä¶",
        options: ["Useless", "Essential", "Confusing", "Optional"],
        answerIndex: 1
      },
      {
        id: "p7q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO benefits of working a little every day (from the passage).",
        rubric: "Two: avoid pressure; stay focused; avoid fatigue before exams; reduce stress.",
        keywords: [
          ["evitar", "presi√≥n", "pressure"],
          ["concentrado", "concentrarse", "focus"],
          ["cansancio", "fatiga", "fatigue"],
          ["estr√©s", "stress"]
        ]
      },
      {
        id: "p7q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents Red‚Äôs method as‚Ä¶ (P / N / P+N)",
        correct: "P"
      },
      {
        id: "p7q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says Red never uses a schedule. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p7q5",
        type: "short",
        marks: 6,
        prompt: "(H) Explain why Red‚Äôs method can help before exams.",
        rubric: "It organises homework and revision, keeps work regular, improves focus, and avoids fatigue/stress before exams.",
        keywords: [
          ["organizar", "horario", "schedule"],
          ["deberes", "repasos", "revision"],
          ["regularidad", "constancia", "regular"],
          ["concentrado", "concentraci√≥n", "focus"],
          ["cansancio", "estr√©s", "before exams", "ex√°menes"]
        ]
      },
      {
        id: "p7q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions Red studying exactly two hours every night. (True / False / Not mentioned)",
        correct: "Not mentioned"
      }
    ]
  },

  {
    id: 8,
    title: "Pasaje 8 ‚Äî El estr√©s antes de un control",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (Ex√°menes)",
    text: `Antes de un control importante, muchos alumnos sienten estr√©s. Aunque hayan estudiado, tienen miedo de ‚Äúquedarse en blanco‚Äù al leer la primera pregunta. Algunos se preocupan por el tiempo y miran el reloj continuamente. Otros se ponen nerviosos por el silencio: cualquier ruido (una silla, una p√°gina, un bol√≠grafo que cae) parece enorme y les distrae.

Red nota que el estr√©s tambi√©n cambia la manera de leer. Cuando est√° nervioso, la gente suele leer demasiado r√°pido y se salta palabras clave. Por ejemplo, confunden ‚Äúmenciona DOS‚Äù con ‚Äúmenciona UNO‚Äù, o no ven el verbo ‚Äúexplica‚Äù. Para evitarlo, Red crea una rutina sencilla. Antes de empezar, respira con calma durante unos segundos. Luego lee la pregunta lentamente una segunda vez y subraya una o dos palabras clave, como ‚Äúdos razones‚Äù, ‚Äújustifica‚Äù o ‚Äúseg√∫n el texto‚Äù.

Despu√©s, Red empieza por los ejercicios m√°s f√°ciles para ganar puntos r√°pidos y sentirse m√°s seguro. Si una pregunta le parece dif√≠cil, la marca y contin√∫a con la siguiente. Al final, si le queda tiempo, vuelve a las preguntas marcadas y revisa que ha respondido exactamente lo que se pide. Red dice que el objetivo no es ‚Äúno sentir nada‚Äù, sino usar el estr√©s como concentraci√≥n y mantener la cabeza clara.`,
    questions: [
      {
        id: "p8q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What is the main topic of the passage?",
        options: [
          "Exam stress and how to manage it",
          "A school trip",
          "A football match",
          "A cooking recipe"
        ],
        answerIndex: 0
      },
      {
        id: "p8q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO causes of stress mentioned in the passage.",
        rubric: "Any two: fear of blanking; worrying about time/clock; silence; small noises feel huge and distract.",
        keywords: [
          ["quedarse en blanco", "blank"],
          ["tiempo", "reloj", "clock"],
          ["silencio", "silence"],
          ["ruido", "silla", "p√°gina", "bol√≠grafo", "noise"]
        ]
      },
      {
        id: "p8q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, the passage presents stress as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p8q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says stress can make people read too fast. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p8q5",
        type: "short",
        marks: 6,
        prompt: "(H) Describe THREE steps in Red‚Äôs routine to control stress.",
        rubric:
          "Three steps such as: breathe calmly; reread slowly; underline key words; start with easiest tasks; mark hard questions and move on; return and check at the end.",
        keywords: [
          ["respira", "calma", "breathe"],
          ["lee", "lentamente", "reread"],
          ["subraya", "palabras clave", "underline"],
          ["m√°s f√°ciles", "puntos", "easiest"],
          ["marca", "contin√∫a", "move on"],
          ["al final", "revisa", "check"]
        ]
      },
      {
        id: "p8q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øPor qu√© Red subraya palabras clave?",
        rubric:
          "Para no confundir la consigna y responder exactamente lo que se pide / evitar errores.",
        keywords: [
          ["subraya", "palabras clave"],
          ["no confundir", "consigna"],
          ["responder", "exactamente"],
          ["evitar", "errores"]
        ]
      }
    ]
  },

  {
    id: 9,
    title: "Pasaje 9 ‚Äî El trabajo en grupo",
    theme: "Tema 2 ‚Äî Tiempo libre",
    unit: "Unidad 5 (Trabajo en equipo)",
    text: `En algunas clases y proyectos, los alumnos deben trabajar en grupo. Esto puede ser √∫til porque se comparten ideas, se reparten tareas y se corrigen errores. Sin embargo, tambi√©n puede crear problemas. A veces una persona hace casi todo el trabajo y otra participa muy poco. Entonces el grupo se frustra y la calidad baja.

Red prefiere grupos organizados. Para √©l, el secreto es simple: desde el principio, cada alumno debe tener un papel claro. Por ejemplo: una persona hace el plan, otra escribe la respuesta final y otra revisa los detalles. Red a√±ade una regla m√°s: todos deben aportar al menos una idea, aunque sea peque√±a. As√≠ nadie puede ‚Äúdesaparecer‚Äù durante el proyecto.

Cuando los roles est√°n claros, Red ve varias ventajas. Primero, el trabajo avanza m√°s r√°pido porque cada uno sabe qu√© hacer. Segundo, las ideas son m√°s variadas porque participan m√°s personas. Tercero, hay menos errores, porque alguien revisa al final. Para Red, un grupo no es solo ‚Äúestar juntos‚Äù, sino ser un equipo con una forma de trabajar.`,
    questions: [
      {
        id: "p9q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What does Red think is the secret of good group work?",
        options: ["Clear roles from the start", "Never speaking", "Working alone", "Finishing late"],
        answerIndex: 0
      },
      {
        id: "p9q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO problems of group work mentioned in the passage.",
        rubric: "Any two: unequal work; low participation; frustration; quality drops.",
        keywords: [
          ["casi todo", "una persona", "unequal"],
          ["participa", "poco", "low participation"],
          ["frustra", "frustraci√≥n"],
          ["calidad", "baja", "drops"]
        ]
      },
      {
        id: "p9q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents group work as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p9q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says everyone must speak at least once. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p9q5",
        type: "short",
        marks: 6,
        prompt: "(H) Give THREE advantages Red sees when roles are clear.",
        rubric: "Three: faster progress; more varied ideas; fewer errors; better quality.",
        keywords: [
          ["avanza", "m√°s r√°pido", "faster"],
          ["ideas", "variadas", "varied ideas"],
          ["menos errores", "revisa", "fewer errors"],
          ["calidad", "better quality"]
        ]
      },
      {
        id: "p9q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions using phones during group work. (True / False / Not mentioned)",
        correct: "Not mentioned"
      },
      {
        id: "p9q7",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øPor qu√© Red quiere que todos aporten al menos una idea?",
        rubric: "Para que nadie desaparezca y para que todos participen en el proyecto.",
        keywords: [
          ["todos", "aportar", "idea"],
          ["nadie", "desaparecer"],
          ["participar", "proyecto"]
        ]
      }
    ]
  },

  {
    id: 10,
    title: "Pasaje 10 ‚Äî El entorno de trabajo",
    theme: "Tema 2 ‚Äî Tu regi√≥n",
    unit: "Unidad 7 (Entorno)",
    text: `El entorno de trabajo influye mucho en la concentraci√≥n. Algunos alumnos prefieren el silencio total porque cualquier ruido les molesta. Otros prefieren un peque√±o ruido de fondo, como un ventilador o m√∫sica muy baja, porque les ayuda a entrar en ‚Äúmodo estudio‚Äù. No existe una √∫nica soluci√≥n para todos, pero s√≠ hay h√°bitos que suelen funcionar.

OWing cree que un espacio claro y tranquilo da ganas de trabajar. Antes de empezar, ordena el escritorio: quita papeles in√∫tiles, prepara solo lo necesario y deja el m√≥vil lejos para evitar tentaciones. Tambi√©n intenta estudiar siempre en el mismo lugar, porque eso crea una rutina. Para √©l, ese ritual manda un mensaje al cerebro: ‚Äúahora toca concentrarse‚Äù.

OWing dice que cuando el espacio est√° desordenado, se pierde tiempo buscando cosas y se cae m√°s f√°cil en distracciones. En cambio, cuando todo est√° preparado, se empieza antes y se termina mejor. Seg√∫n √©l, un buen entorno no hace milagros, pero reduce el estr√©s y mejora la calidad del trabajo.`,
    questions: [
      {
        id: "p10q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) OWing believes a good work space should be‚Ä¶",
        options: ["Clear and calm", "Noisy and messy", "Crowded", "Outside only"],
        answerIndex: 0
      },
      {
        id: "p10q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO different preferences students can have about noise.",
        rubric: "Some prefer total silence; others prefer light background noise (fan/quiet music).",
        keywords: [
          ["silencio", "total", "total silence"],
          ["ruido", "de fondo", "background noise"],
          ["ventilador", "fan"],
          ["m√∫sica", "baja", "quiet music"]
        ]
      },
      {
        id: "p10q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents background noise (like a fan) as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p10q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says OWing keeps his phone close while studying. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p10q5",
        type: "short",
        marks: 6,
        prompt: "(H) Explain why a tidy environment saves time, according to the passage.",
        rubric: "You waste less time searching for things, get distracted less, start sooner, and finish better.",
        keywords: [
          ["desordenado", "desorden", "messy"],
          ["pierde tiempo", "buscar", "waste time searching"],
          ["distracciones", "distractions"],
          ["empieza", "antes", "start sooner"],
          ["termina", "mejor", "finish better"]
        ]
      },
      {
        id: "p10q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions OWing studying in a library every day. (True / False / Not mentioned)",
        correct: "Not mentioned"
      }
    ]
  },

  {
    id: 11,
    title: "Pasaje 11 ‚Äî Clayton y el GCSE anticipado",
    theme: "Tema extra 4 ‚Äî Resultados",
    unit: "Unidad 10 (GCSE de Clayton)",
    text: `Clayton hizo su examen de matem√°ticas mucho antes que la mayor√≠a. Normalmente, una clase entera se presenta en la fecha oficial, pero a √©l le permitieron hacerlo antes porque sus profesores pensaban que estaba preparado. El d√≠a de los resultados, sac√≥ 160 sobre 160: una nota perfecta. Mucha gente lo admir√≥ y dijo que ten√≠a una l√≥gica r√°pida y una t√©cnica muy clara.

Despu√©s, en la escuela se habl√≥ much√≠simo del tema. Algunos alumnos se sintieron motivados: pensaron que pod√≠an mejorar si trabajaban con disciplina. Otros, en cambio, se sintieron desanimados porque compararon su nivel con una perfecci√≥n. Clayton explic√≥ que no era ‚Äúmagia‚Äù: para √©l era el resultado de a√±os de pr√°ctica, correcci√≥n de errores y constancia.

Sin embargo, no todos reaccionaron bien. Algunas personas dijeron que Clayton hablaba demasiado de su puntuaci√≥n. Para ellos, el √©xito es importante, pero tambi√©n lo es la humildad. Clayton respondi√≥ que estaba orgulloso y que quer√≠a demostrar que la disciplina funciona. El debate continu√≥: ¬øc√≥mo se celebra un logro enorme sin crear tensi√≥n en los dem√°s?`,
    questions: [
      {
        id: "p11q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What score did Clayton get?",
        options: ["160/160", "150/160", "140/160", "100/160"],
        answerIndex: 0
      },
      {
        id: "p11q2",
        type: "short",
        marks: 4,
        prompt: "(E) Why was Clayton allowed to take the exam early?",
        rubric: "Because teachers believed he was ready / had the level.",
        keywords: [
          ["permitieron", "antes", "allowed early"],
          ["profesores", "teachers"],
          ["preparado", "ready"],
          ["nivel", "level"]
        ]
      },
      {
        id: "p11q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, reactions to Clayton‚Äôs result are presented as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p11q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says everyone reacted positively. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p11q5",
        type: "short",
        marks: 6,
        prompt: "(H) According to Clayton, what are THREE reasons for his success?",
        rubric: "Three: years of practice; correcting mistakes; regular work/constancy; discipline; clear technique.",
        keywords: [
          ["a√±os", "pr√°ctica", "practice"],
          ["correcci√≥n", "corregir", "errores", "correct mistakes"],
          ["constancia", "regular", "regular work"],
          ["disciplina", "discipline"],
          ["t√©cnica", "clara", "clear technique"]
        ]
      },
      {
        id: "p11q6",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øPor qu√© algunas personas critican a Clayton?",
        rubric: "Porque creen que habla demasiado de su puntuaci√≥n y que le falta humildad.",
        keywords: [
          ["critican", "criticar"],
          ["habla", "demasiado"],
          ["puntuaci√≥n", "resultado", "nota"],
          ["falta", "humildad"]
        ]
      }
    ]
  },

  {
    id: 12,
    title: "Pasaje 12 ‚Äî Las notas perfectas",
    theme: "Tema extra 4 ‚Äî Resultados",
    unit: "Unidad 10 (Reacciones)",
    text: `Cuando alguien consigue una nota perfecta, las reacciones en una clase pueden ser muy diferentes. Algunas personas se sienten motivadas: piensan ‚Äúsi es posible, yo tambi√©n puedo mejorar‚Äù. Piden consejos, cambian su m√©todo de estudio y repiten ejercicios. Para ellos, una nota perfecta es una prueba de que el esfuerzo funciona.

Otras personas se sienten desanimadas. Comparan su nivel con la perfecci√≥n y creen que nunca podr√°n llegar. En algunos casos, el des√°nimo se convierte en celos, sobre todo si el alumno con la nota perfecta presume demasiado o lo menciona continuamente.

Red cree que un gran resultado debe inspirar, no aplastar. Dice que se debe celebrar el esfuerzo, no solo el n√∫mero. Para √©l, la competencia puede ser sana si empuja a progresar con respeto y sin dramas. Su idea final es clara: comp√°rate contigo mismo y mejora poco a poco, sin convertir la clase en una batalla.`,
    questions: [
      {
        id: "p12q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) The passage says reactions to perfect scores are‚Ä¶",
        options: ["Varied", "Always positive", "Always negative", "Unchanged"],
        answerIndex: 0
      },
      {
        id: "p12q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO positive reactions mentioned.",
        rubric: "Any two: feel motivated; ask for advice; change method; redo exercises.",
        keywords: [
          ["motivadas", "motivaci√≥n", "motivated"],
          ["consejos", "advice"],
          ["m√©todo", "cambiar", "change method"],
          ["repetir", "ejercicios", "redo exercises"]
        ]
      },
      {
        id: "p12q3",
        type: "pn",
        marks: 2,
        prompt: "(E) Overall, the passage presents perfect scores as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p12q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says jealousy can sometimes appear. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p12q5",
        type: "short",
        marks: 6,
        prompt: "(H) What is Red‚Äôs main message about success and competition?",
        rubric:
          "Celebrate effort, not only the number; competition can be healthy with respect; compare yourself to yourself; avoid dramas.",
        keywords: [
          ["celebrar", "esfuerzo", "effort"],
          ["n√∫mero", "number"],
          ["competencia", "sana", "healthy competition"],
          ["respeto", "respect"],
          ["compararse", "uno mismo", "compare yourself"],
          ["dramas", "avoid dramas"]
        ]
      },
      {
        id: "p12q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions Red banning competition in class. (True / False / Not mentioned)",
        correct: "Not mentioned"
      },
      {
        id: "p12q7",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øCu√°l es la idea final de Red en una frase?",
        rubric: "Comp√°rate contigo mismo y mejora poco a poco, sin dramas.",
        keywords: [
          ["comp√°rate", "compararse"],
          ["contigo mismo", "uno mismo"],
          ["mejora", "mejorar"],
          ["poco a poco"],
          ["sin dramas", "dramas"]
        ]
      }
    ]
  },

  {
    id: 13,
    title: "Pasaje 13 ‚Äî La presi√≥n de los ex√°menes",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (Presi√≥n de examen)",
    text: `La √©poca de ex√°menes puede ser intensa. Los alumnos tienen que repasar varias asignaturas a la vez y, a veces, seguir entregando deberes. En los pasillos se oyen frases como ‚Äúno tengo tiempo‚Äù o ‚Äútengo demasiados temas‚Äù. La presi√≥n tambi√©n aumenta cuando la gente se compara: algunos parecen preparados, otros entran en p√°nico, y el nerviosismo se contagia.

En este contexto, aparecen m√©todos distintos. Algunos crean un plan muy detallado con horas y objetivos. Otros estudian de manera espont√°nea: hacen ‚Äúlo que les apetece‚Äù ese d√≠a. Las dos formas pueden funcionar, pero cada una tiene riesgos. Sin plan, se puede olvidar una asignatura. Con un plan demasiado r√≠gido, uno se siente culpable por descansar.

OWing prefiere planificar, pero de forma razonable. Elige objetivos simples: ‚Äúhacer un ejercicio‚Äù, ‚Äúrepasar una ficha‚Äù o ‚Äúaprender veinte palabras‚Äù. Tambi√©n incluye descansos, porque cree que el cansancio destruye la concentraci√≥n. Para √©l, la preparaci√≥n reduce sorpresas y aumenta la confianza: cuando llega el examen, sabe lo que ha hecho y se siente m√°s seguro.`,
    questions: [
      {
        id: "p13q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) The exam period is described as‚Ä¶",
        options: ["Intense", "Relaxing", "Unimportant", "Funny"],
        answerIndex: 0
      },
      {
        id: "p13q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO reasons why students feel pressure in this passage.",
        rubric: "Any two: many subjects at once; not enough time; too many topics; comparing with others; panic spreads; still have homework.",
        keywords: [
          ["varias", "asignaturas", "many subjects"],
          ["no tengo tiempo", "not enough time"],
          ["demasiados", "temas", "too many topics"],
          ["compararse", "others", "compare"],
          ["p√°nico", "contagia", "panic spreads"],
          ["deberes", "homework"]
        ]
      },
      {
        id: "p13q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents planning as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p13q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says spontaneous study can have risks. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p13q5",
        type: "short",
        marks: 6,
        prompt: "(H) Give THREE things OWing includes in his approach.",
        rubric: "Three: simple goals; specific tasks (exercise, sheet, 20 words); rest time; avoid fatigue; preparation reduces surprises; builds confidence.",
        keywords: [
          ["objetivos", "simples", "simple goals"],
          ["ejercicio"],
          ["ficha", "repasar", "sheet"],
          ["veinte", "20", "palabras", "words"],
          ["descanso", "descansos", "rest"],
          ["cansancio", "fatiga", "fatigue"],
          ["confianza", "seguro", "confidence"]
        ]
      }
    ]
  },

  {
    id: 14,
    title: "Pasaje 14 ‚Äî La concentraci√≥n en clase",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (Concentraci√≥n)",
    text: `En clase, la concentraci√≥n es esencial para entender al profesor. Sin embargo, mantenerse atento no siempre es f√°cil. Algunos alumnos se distraen por ruidos: una conversaci√≥n al fondo, una puerta que se cierra o un bol√≠grafo golpeando la mesa. Otros se distraen por pensamientos: el fin de semana, un mensaje o un problema personal. A veces, una distracci√≥n peque√±a basta para perder una explicaci√≥n importante.

Red cree que hay que escuchar de forma activa, no solo estar sentado. Para √©l, escuchar activamente significa mirar al profesor, seguir el hilo y tomar apuntes claros. Escribe palabras esenciales y usa t√≠tulos para organizar. Si no entiende algo, marca un signo de interrogaci√≥n para preguntar despu√©s, en lugar de desconectar por completo.

Red tambi√©n evita usar el m√≥vil en clase. Dice que una sola notificaci√≥n rompe la atenci√≥n y luego cuesta volver al tema. Seg√∫n √©l, si te concentras bien en clase, necesitas menos tiempo de repaso por la tarde y cometes menos errores en los deberes.`,
    questions: [
      {
        id: "p14q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) In this passage, ‚Äòactive listening‚Äô mainly means‚Ä¶",
        options: [
          "Looking at the teacher and taking clear notes",
          "Talking all the time",
          "Using a phone to search answers",
          "Writing nothing"
        ],
        answerIndex: 0
      },
      {
        id: "p14q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO distractions mentioned in the passage.",
        rubric: "Any two: conversation; door; pen tapping; thoughts about weekend; message; personal problem.",
        keywords: [
          ["conversaci√≥n"],
          ["puerta"],
          ["bol√≠grafo", "mesa"],
          ["fin de semana"],
          ["mensaje"],
          ["problema", "personal"]
        ]
      },
      {
        id: "p14q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents phone notifications in class as‚Ä¶ (P / N / P+N)",
        correct: "N"
      },
      {
        id: "p14q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says one notification can break attention. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p14q5",
        type: "short",
        marks: 6,
        prompt: "(H) Explain why good focus in class reduces work at home, according to Red.",
        rubric: "You understand more in class, lose less info to distractions, need less revision later, and make fewer homework mistakes.",
        keywords: [
          ["entiendes", "entender", "understand"],
          ["distracciones", "distractions"],
          ["menos repaso", "revision"],
          ["por la tarde", "later"],
          ["menos errores", "deberes", "fewer mistakes"]
        ]
      },
      {
        id: "p14q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says Red always studies with music in class. (True / False / Not mentioned)",
        correct: "Not mentioned"
      }
    ]
  },

  {
    id: 15,
    title: "Pasaje 15 ‚Äî La organizaci√≥n de Otono Mansion",
    theme: "Tema 3 ‚Äî Otono Team",
    unit: "Unidad 9 (Otono Mansion)",
    text: `Otono Mansion tiene m√°s de noventa habitaciones repartidas en varios pisos. En un edificio tan grande, la organizaci√≥n no es un lujo: es una necesidad. Cada habitaci√≥n tiene una funci√≥n. Hay espacios para trabajar, para descansar y para actividades del d√≠a a d√≠a. Cuando todo est√° bien organizado, los habitantes pierden menos tiempo y los invitados entienden mejor ad√≥nde ir.

Esta estructura evita el caos. Por ejemplo, los objetos importantes no se quedan ‚Äúen cualquier sitio‚Äù: hay lugares para guardar material, para dejar documentos y para reunirse. Los pasillos est√°n m√°s tranquilos y hay menos discusiones, porque cada uno respeta el uso de las habitaciones. Si una sala es para estudiar, no se convierte en un lugar ruidoso de repente.

Red aprecia especialmente los espacios tranquilos. Elige un sitio con poco paso, una mesa despejada y buena luz. Dice que en una casa enorme el silencio es un tesoro: si sabes d√≥nde encontrarlo, puedes concentrarte mejor. Para √©l, la organizaci√≥n no es solo est√©tica, sino una forma de convivir sin estr√©s.`,
    questions: [
      {
        id: "p15q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) How many rooms does Otono Mansion have?",
        options: ["Over 90", "Exactly 20", "Less than 10", "Over 200"],
        answerIndex: 0
      },
      {
        id: "p15q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO reasons why organisation is necessary in a very large house.",
        rubric: "Any two: avoid chaos; save time; help guests; keep corridors calmer; reduce conflicts; know where items go.",
        keywords: [
          ["evitar", "caos"],
          ["menos tiempo", "tiempo"],
          ["invitados", "entienden", "ad√≥nde ir"],
          ["pasillos", "tranquilos"],
          ["menos discusiones", "conflictos"],
          ["guardar", "material", "documentos"]
        ]
      },
      {
        id: "p15q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents strict room roles (study rooms stay quiet) as‚Ä¶ (P / N / P+N)",
        correct: "P"
      },
      {
        id: "p15q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says Red prefers noisy spaces for working. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p15q5",
        type: "short",
        marks: 6,
        prompt: "(H) Give THREE features of the study space Red chooses.",
        rubric: "Three: quiet; little passage/low traffic; clear table; good light; calm environment.",
        keywords: [
          ["tranquilo", "silencio", "quiet"],
          ["poco paso", "low traffic"],
          ["mesa", "despejada", "clear table"],
          ["buena luz", "good light"],
          ["concentrarte", "focus"]
        ]
      }
    ]
  },

  {
    id: 16,
    title: "Pasaje 16 ‚Äî El equilibrio entre velocidad y precisi√≥n",
    theme: "Tema 2 ‚Äî Tiempo libre",
    unit: "Unidad 5 (Equilibrio)",
    text: `En los proyectos de Otono, se ven dos estilos de trabajo. Algunas personas prefieren ir r√°pido para terminar pronto y ver resultados. Otras prefieren la precisi√≥n: revisan todo y avanzan m√°s despacio para evitar fallos. Los dos estilos pueden ser √∫tiles, pero tambi√©n pueden causar problemas si se usan en exceso.

La velocidad ayuda a mantener la motivaci√≥n: cuando ves progreso r√°pido, te dan ganas de continuar. Pero si vas demasiado r√°pido, puedes olvidar detalles y cometer un error que luego cuesta mucho tiempo arreglar. La precisi√≥n reduce errores y mejora la calidad, pero si te vuelves demasiado lento, el proyecto se retrasa y los dem√°s tienen que esperar.

OWing dice que la soluci√≥n es un equilibrio con una regla simple: avanzar r√°pido en las etapas grandes y frenar en momentos concretos para revisar. Por ejemplo, construir una primera versi√≥n r√°pido y despu√©s hacer una revisi√≥n completa antes de finalizar. As√≠ se evita tanto el caos de los errores como el bloqueo por lentitud. Para OWing, no es ‚Äúvelocidad o precisi√≥n‚Äù: es combinar las dos de forma inteligente.`,
    questions: [
      {
        id: "p16q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) What does OWing recommend?",
        options: ["Balancing speed and precision", "Only speed always", "Only precision always", "Never checking work"],
        answerIndex: 0
      },
      {
        id: "p16q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give ONE benefit of speed and ONE benefit of precision.",
        rubric: "Speed: finish quickly / keep motivation. Precision: reduce errors / improve quality.",
        keywords: [
          ["terminar", "pronto", "motivaci√≥n", "speed benefit"],
          ["precisi√≥n", "menos errores", "calidad", "precision benefit"]
        ]
      },
      {
        id: "p16q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents speed and precision together as‚Ä¶ (P / N / P+N)",
        correct: "P"
      },
      {
        id: "p16q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says going too slow can delay a project. (True / False / Not mentioned)",
        correct: "True"
      },
      {
        id: "p16q5",
        type: "short",
        marks: 6,
        prompt: "(H) Describe OWing‚Äôs method in TWO parts.",
        rubric: "Part 1: move fast on big steps / first version. Part 2: slow down to check fully before finalising.",
        keywords: [
          ["etapas grandes", "primera versi√≥n", "fast"],
          ["frenar", "revisi√≥n completa", "check"],
          ["finalizar", "finish"]
        ]
      },
      {
        id: "p16q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions OWing refusing to check any work. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p16q7",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øQu√© frase resume la idea final del pasaje?",
        rubric: "No es ‚Äòvelocidad o precisi√≥n‚Äô: es combinar las dos de forma inteligente.",
        keywords: [
          ["no es"],
          ["velocidad"],
          ["precisi√≥n", "precision"],
          ["combinar"],
          ["inteligente"]
        ]
      }
    ]
  },

  {
    id: 17,
    title: "Pasaje 17 ‚Äî La importancia de la disciplina",
    theme: "Tema 1 ‚Äî Escuela",
    unit: "Unidad 4 (Disciplina)",
    text: `La disciplina es una cualidad importante para tener √©xito. No significa ser duro contigo mismo todo el d√≠a, sino seguir trabajando incluso cuando no tienes ganas. Implica constancia, reglas simples y una direcci√≥n clara. Sin disciplina, es f√°cil perder la motivaci√≥n: se deja todo para ma√±ana, se abandona ante el primer obst√°culo y se progresa menos.

Red cree que la disciplina no es solo escolar. Dice que la misma l√≥gica sirve para la m√∫sica, el deporte y hasta los juegos. Si quieres mejorar, tienes que repetir, corregir y volver varias veces a lo mismo. Red da un ejemplo: trabajar diez minutos cada d√≠a puede ser m√°s √∫til que estudiar tres horas una vez al mes. La regularidad crea h√°bitos, y los h√°bitos crean resultados s√≥lidos.

Red tambi√©n afirma que la disciplina ayuda a estar m√°s tranquilo. Si tienes una rutina, paniqueas menos antes de una prueba porque sabes que ya has trabajado. Aun as√≠, habr√° d√≠as dif√≠ciles. Para Red, la disciplina es precisamente volver al d√≠a siguiente sin culparte y continuar el camino.`,
    questions: [
      {
        id: "p17q1",
        type: "mcq",
        marks: 2,
        prompt: "(E) In this passage, discipline mainly means‚Ä¶",
        options: ["Continuing regularly even when you don‚Äôt feel like it", "Never resting", "Being perfect", "Ignoring rules"],
        answerIndex: 0
      },
      {
        id: "p17q2",
        type: "short",
        marks: 4,
        prompt: "(E) Give TWO things that can happen without discipline.",
        rubric: "Any two: lose motivation; postpone work; give up at obstacles; progress less.",
        keywords: [
          ["perder", "motivaci√≥n", "lose motivation"],
          ["ma√±ana", "postpone"],
          ["abandonar", "obst√°culo", "give up"],
          ["progresar", "menos", "less progress"]
        ]
      },
      {
        id: "p17q3",
        type: "pn",
        marks: 2,
        prompt: "(E) The passage presents discipline as‚Ä¶ (P / N / P+N)",
        correct: "P+N"
      },
      {
        id: "p17q4",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage says discipline only matters at school. (True / False / Not mentioned)",
        correct: "False"
      },
      {
        id: "p17q5",
        type: "short",
        marks: 6,
        prompt: "(H) Explain why ‚Äòregularity creates solid results‚Äô according to the passage.",
        rubric: "Regular work builds habits, repeated practice and correction improves skills over time, and you progress more than working rarely.",
        keywords: [
          ["regularidad", "h√°bitos", "habit"],
          ["repetir", "corregir", "repeat/correct"],
          ["con el tiempo", "over time"],
          ["progresar", "m√°s", "more progress"],
          ["rara vez", "rarely"]
        ]
      },
      {
        id: "p17q6",
        type: "tfnm",
        marks: 2,
        prompt: "(E) The passage mentions Red doing a 5am swimming routine. (True / False / Not mentioned)",
        correct: "Not mentioned"
      },
      {
        id: "p17q7",
        type: "es_short",
        marks: 4,
        prompt: "(M) En espa√±ol: ¬øC√≥mo ayuda la disciplina a Red antes de una prueba?",
        rubric: "Con una rutina, se pone menos nervioso porque sabe que ya ha trabajado.",
        keywords: [
          ["rutina"],
          ["menos nervioso", "paniqueas menos", "calma"],
          ["sabe", "ya ha trabajado", "trabajado"]
        ]
      }
    ]
  },
  {
  id: 18,
  title: "Pasaje 18 ‚Äî Jessica y el equilibrio entre asignaturas",
  theme: "Tema 1 ‚Äî Escuela",
  unit: "Unidad 4 (Equilibrio de estudio)",
  text: `Jessica disfruta varias asignaturas, pero no aborda todas de la misma manera. En arte, le encanta la libertad de crear y desarrollar ideas. En historia, prefiere organizar la informaci√≥n y construir una respuesta l√≥gica. Con matem√°ticas, su relaci√≥n es m√°s complicada: suele decir que no le gusta mucho, aunque saca buenos resultados. A algunos alumnos les parece raro, pero para Jessica es totalmente normal.

Seg√∫n ella, disfrutar una asignatura y rendir bien en esa asignatura no siempre es lo mismo. Puedes ser fuerte en algo sin sentir mucho placer, y al rev√©s: puedes amar una asignatura y aun as√≠ encontrarla dif√≠cil. Por eso, Jessica intenta mantener un equilibrio. No quiere que una sola materia defina toda su vida escolar.

Cuando repasa, Jessica adapta su m√©todo seg√∫n la asignatura. Para historia, relee apuntes y ordena los eventos por temas. Para matem√°ticas, prefiere hacer ejercicios concretos para detectar errores. Para asignaturas creativas, piensa m√°s en el estilo, la presentaci√≥n y el efecto que produce su trabajo. Para ella, lo importante no es amar todo igual, sino entender c√≥mo mejorar en cada √°rea.`,
  questions: [
    { id:"p18q1", type:"mcq", marks:2,
      prompt:"(E) What does Jessica especially enjoy about art?",
      options:["Creative freedom","Memorising dates only","Doing calculations silently","Skipping planning"],
      answerIndex:0
    },
    { id:"p18q2", type:"short", marks:4,
      prompt:"(E) Give TWO ways Jessica approaches different subjects.",
      rubric:"Any two: art = creative freedom; history = organising info + logical response; maths = she says she doesn‚Äôt really like it but gets good results.",
      keywords:[
        ["arte","libertad","crear","creative","freedom"],
        ["historia","organizar","informaci√≥n","l√≥gica","logical"],
        ["matem√°ticas","buenos resultados","good results"],
        ["no le gusta","doesn't like","complicada","complicated"]
      ]
    },
    { id:"p18q3", type:"pn", marks:2,
      prompt:"(E) Jessica‚Äôs attitude to maths is presented as‚Ä¶ (P / N / P+N)",
      correct:"P+N"
    },
    { id:"p18q4", type:"tfnm", marks:2,
      prompt:"(E) The passage says Jessica only likes one subject. (True / False / Not mentioned)",
      correct:"False"
    },
    { id:"p18q5", type:"short", marks:6,
      prompt:"(H) Why does Jessica believe success and enjoyment are not always the same thing?",
      rubric:"Because you can be strong at a subject without enjoying it, and you can enjoy a subject while finding it difficult; she therefore keeps balance so one subject doesn‚Äôt define her school life.",
      keywords:[
        ["√©xito","success","rendir bien","good results"],
        ["sin placer","no disfrutar","no le gusta"],
        ["dif√≠cil","difficult"],
        ["equilibrio","balance"],
        ["una sola materia","one subject","defina","define"]
      ]
    },
    { id:"p18q6", type:"es_short", marks:4,
      prompt:"(M) En espa√±ol: ¬øC√≥mo adapta Jessica su forma de repasar seg√∫n la asignatura? Da DOS ejemplos.",
      rubric:"Dos ejemplos: en historia relee apuntes y ordena eventos por temas; en matem√°ticas hace ejercicios concretos para detectar errores; en creativas piensa en estilo/presentaci√≥n/efecto.",
      keywords:[
        ["historia","relee","apuntes","temas"],
        ["matem√°ticas","ejercicios","errores","detectar"],
        ["creativas","estilo","presentaci√≥n","efecto"]
      ]
    }
  ]
},
{
  id: 19,
  title: "Pasaje 19 ‚Äî Red y La Marsellesa",
  theme: "Tema 2 ‚Äî M√∫sica e identidad",
  unit: "Unidad 6 (La Marsellesa)",
  text: `A Red le encanta La Marsellesa. Para √©l, no es solo un himno famoso: es una m√∫sica con energ√≠a, solemnidad e identidad nacional muy marcada. Le interesa el texto, la historia que representa y la fuerza con la que avanza la melod√≠a. Cada vez que la escucha, siente que la m√∫sica quiere decir algo importante y no simplemente llenar el silencio.

Como Red es un soprano, tambi√©n se fija en detalles musicales que a veces otros pasan por alto. Presta atenci√≥n a la l√≠nea mel√≥dica, a la altura de las notas y al efecto que se produce cuando se canta con convicci√≥n. No le importan solo las palabras: piensa en el color de la voz, en la intensidad y en el impulso general del canto. Para √©l, un himno debe ser preciso, expresivo y digno.

Red entiende que no todo el mundo reacciona igual ante La Marsellesa. Algunas personas admiran su fuerza y su valor hist√≥rico. Otras la consideran demasiado intensa o m√°s severa que alegre. Red acepta esa diversidad, pero mantiene su postura: para √©l, esta obra sigue siendo impresionante, memorable y profundamente francesa. Dice que encaja con su gusto por las obras con car√°cter, que nunca resultan ‚Äúins√≠pidas‚Äù.`,
  questions: [
    { id:"p19q1", type:"mcq", marks:2,
      prompt:"(E) Why does Red especially value La Marseillaise?",
      options:["Because it feels powerful and meaningful","Because it is quiet and simple","Because it has no history","Because it is only background noise"],
      answerIndex:0
    },
    { id:"p19q2", type:"short", marks:4,
      prompt:"(E) Give TWO reasons La Marseillaise matters to Red.",
      rubric:"Any two: energy; solemnity; strong national identity; meaningful text; historical value; powerful melody.",
      keywords:[
        ["energ√≠a","energy"],
        ["solemnidad","solemnity"],
        ["identidad nacional","national identity"],
        ["texto","meaningful"],
        ["historia","hist√≥rico","historical"],
        ["melod√≠a","fuerza","powerful"]
      ]
    },
    { id:"p19q3", type:"pn", marks:2,
      prompt:"(E) Overall, the passage presents La Marseillaise as‚Ä¶ (P / N / P+N)",
      correct:"P+N"
    },
    { id:"p19q4", type:"tfnm", marks:2,
      prompt:"(E) The passage says Red is a soprano. (True / False / Not mentioned)",
      correct:"True"
    },
    { id:"p19q5", type:"short", marks:2,
      prompt:"(E) Because of his voice type, what extra musical detail does Red notice? Give ONE.",
      rubric:"One detail such as: melodic line; pitch/height of notes; voice colour; intensity; effect when singing with conviction.",
      keywords:[
        ["l√≠nea mel√≥dica","melodic line"],
        ["altura","notas","pitch"],
        ["color de la voz","voice colour"],
        ["intensidad","intensity"],
        ["convicci√≥n","effect"]
      ]
    },
    { id:"p19q6", type:"tfnm", marks:2,
      prompt:"(E) The passage says Red always performs La Marseillaise in a stadium. (True / False / Not mentioned)",
      correct:"Not mentioned"
    },
    { id:"p19q7", type:"es_short", marks:6,
      prompt:"(H) En espa√±ol: ¬øC√≥mo responde Red a las personas que no sienten lo mismo, y por qu√© sigue admirando la obra?",
      rubric:"√âl acepta que hay opiniones distintas (algunos la admiran, otros la ven demasiado intensa/severa), pero mantiene su admiraci√≥n porque la considera impresionante, memorable y muy francesa, y porque le gustan las obras con car√°cter.",
      keywords:[
        ["acepta","diversidad","opiniones"],
        ["admiran","fuerza","hist√≥rico"],
        ["demasiado intensa","severa"],
        ["mantiene","postura","admira"],
        ["impresionante","memorable","francesa"],
        ["car√°cter","no ins√≠pida"]
      ]
    }
  ]
},
];

/* -----------------------------
   TRANSLATIONS (LONGER + STRICT KEY IDEAS)
   Each translation = 20 marks
   Marking: 5 idea-groups √ó 4 marks = 20
--------------------------------*/

const TRANSLATIONS = [
  {
    id: "T1",
    title: "Traducci√≥n ‚Äî Rutina de examen",
    theme: "Tema 1 ‚Äî Escuela",
    text: "Before an exam, I stay calm and I read the instructions carefully. I underline the important words, and I check how many details the question needs. This method helps me avoid simple mistakes and lose fewer marks.",
    ideas: [
      { name:"Contexto examen", sub:[ ["antes de un examen","antes del examen","antes del examen"] ] },
      { name:"Calma", sub:[ ["me mantengo tranquilo","me quedo tranquilo","con calma","tranquilamente"] ] },
      { name:"Leer consignas", sub:[ ["leo las consignas","leo las instrucciones","leo la consigna","con atenci√≥n","cuidadosamente"] ] },
      { name:"Subrayar + comprobar detalles", sub:[
          ["subrayo","subrayar","subrayando"],
          ["palabras importantes","palabras clave","lo importante"],
          ["compruebo","verifico","reviso"],
          ["cu√°ntos detalles","cuantos detalles","qu√© detalles","lo que pide la pregunta"]
        ]
      },
      { name:"Evitar errores + perder menos puntos", sub:[
          ["evitar errores","evito errores","errores simples","errores sencillos"],
          ["perder menos puntos","pierdo menos puntos","menos puntos","menos notas","menos marcas"]
        ]
      }
    ],
    sampleAnswer:
      "Antes de un examen, me mantengo tranquilo y leo las consignas con atenci√≥n. Subrayo las palabras importantes y compruebo cu√°ntos detalles pide la pregunta. Este m√©todo me ayuda a evitar errores simples y a perder menos puntos."
  },

  {
    id: "T2",
    title: "Traducci√≥n ‚Äî Trabajo en equipo en un juego",
    theme: "Tema 2 ‚Äî Tiempo libre",
    text: "On our game server, teamwork is essential. If someone rushes, they can make mistakes, but if someone checks everything, the project is cleaner. When we combine speed and precision, the build progresses faster and the result is better.",
    ideas: [
      { name:"Servidor + trabajo en equipo esencial", sub:[
          ["en nuestro servidor","en el servidor","servidor de juego","servidor"],
          ["trabajo en equipo","equipo","cooperaci√≥n","colaboraci√≥n"],
          ["es esencial","es imprescindible","es muy importante"]
        ]
      },
      { name:"Ir demasiado r√°pido", sub:[
          ["si alguien se apresura","si alguien va demasiado r√°pido","si alguien corre","apresurarse"],
          ["puede","pueden"]
        ]
      },
      { name:"Errores", sub:[
          ["cometer errores","hace errores","hacen errores","errores","equivocaciones"]
        ]
      },
      { name:"Comprobar todo ‚Üí m√°s limpio", sub:[
          ["si alguien lo comprueba todo","si alguien comprueba todo","si alguien revisa todo","verifica todo"],
          ["el proyecto","la construcci√≥n","el trabajo"],
          ["queda m√°s limpio","m√°s limpio","m√°s ordenado","m√°s claro"]
        ]
      },
      { name:"Combinar velocidad + precisi√≥n ‚Üí mejor resultado", sub:[
          ["cuando combinamos","al combinar","si combinamos"],
          ["velocidad","r√°pido"],
          ["precisi√≥n","detalles"],
          ["avanza m√°s r√°pido","progresa m√°s r√°pido","m√°s deprisa"],
          ["el resultado es mejor","mejor resultado","sale mejor"]
        ]
      }
    ],
    sampleAnswer:
      "En nuestro servidor de juego, el trabajo en equipo es esencial. Si alguien se apresura, puede cometer errores, pero si alguien lo comprueba todo, el proyecto queda m√°s limpio. Cuando combinamos velocidad y precisi√≥n, la construcci√≥n avanza m√°s r√°pido y el resultado es mejor."
  },

  {
    id: "T3",
    title: "Traducci√≥n ‚Äî Otono Airways",
    theme: "Tema 3 ‚Äî Otono Team",
    text: "With Otono Airways, passengers notice the organisation in the cabin and the comfort of the seats. Even in economy class, there is enough space to sit comfortably. For some people, these details show the quality of the airline.",
    ideas: [
      { name:"Otono Airways + pasajeros", sub:[
          ["con otono airways","en otono airways","otono airways"],
          ["los pasajeros","pasajeros"]
        ]
      },
      { name:"Organizaci√≥n en la cabina", sub:[
          ["organizaci√≥n","organizacion"],
          ["en la cabina","cabina"]
        ]
      },
      { name:"Comodidad de los asientos", sub:[
          ["comodidad","c√≥modo","c√≥moda","confort"],
          ["asientos","los asientos"]
        ]
      },
      { name:"Clase turista + suficiente espacio", sub:[
          ["incluso en clase turista","incluso en turista","clase turista","economy","econ√≥mica"],
          ["hay suficiente espacio","suficiente espacio","bastante espacio"],
          ["para sentarse","sentarse c√≥modamente","c√≥modamente"]
        ]
      },
      { name:"Detalles ‚Üí calidad de la aerol√≠nea", sub:[
          ["para algunas personas","para algunos","para cierta gente"],
          ["estos detalles","esos detalles","detalles"],
          ["muestran la calidad","demuestran la calidad","la calidad"],
          ["de la aerol√≠nea","de la compa√±√≠a","aerol√≠nea","compa√±√≠a"]
        ]
      }
    ],
    sampleAnswer:
      "Con Otono Airways, los pasajeros notan la organizaci√≥n en la cabina y la comodidad de los asientos. Incluso en clase turista, hay suficiente espacio para sentarse c√≥modamente. Para algunas personas, estos detalles muestran la calidad de la aerol√≠nea."
  },

  {
    id: "T4",
    title: "Traducci√≥n ‚Äî Reglas y √©xito",
    theme: "Tema 1 ‚Äî Escuela",
    text: "Knowing the topic is not always enough in an exam. If you do not follow the instructions, you can lose marks even with the correct idea. That is why it is important to answer fully and to include the details the question asks for.",
    ideas: [
      { name:"No siempre basta con saber", sub:[
          ["conocer el tema","saber el tema","saber la materia","conocer la lecci√≥n"],
          ["no siempre es suficiente","no siempre basta","no basta siempre"],
          ["en un examen","durante un examen"]
        ]
      },
      { name:"Seguir consignas", sub:[
          ["si no sigues","si no se siguen","si no sigues las consignas","si no sigues las instrucciones"],
          ["consignas","instrucciones","la consigna"]
        ]
      },
      { name:"Perder puntos aunque la idea sea correcta", sub:[
          ["puedes perder puntos","se pueden perder puntos","perder puntos","perder notas"],
          ["incluso","aunque"],
          ["idea correcta","respuesta correcta","lo correcto"]
        ]
      },
      { name:"Por eso es importante", sub:[
          ["por eso","por ello","as√≠ que","de ah√≠ que"],
          ["es importante","es esencial","es necesario"]
        ]
      },
      { name:"Responder completamente + incluir detalles", sub:[
          ["responder completamente","responder del todo","responder de forma completa"],
          ["incluir los detalles","poner detalles","a√±adir detalles"],
          ["que pide la pregunta","que la pregunta pide","seg√∫n la pregunta","lo que se pide"]
        ]
      }
    ],
    sampleAnswer:
      "Conocer el tema no siempre es suficiente en un examen. Si no sigues las consignas, puedes perder puntos incluso con la idea correcta. Por eso es importante responder completamente e incluir los detalles que pide la pregunta."
  }
];

/* -----------------------------
   Utilities
--------------------------------*/
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

function nowISO(){ return new Date().toISOString(); }

function norm(s){
  return (s ?? "")
    .toString()
    .toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[^a-z0-9\s]/g," ")
    .replace(/\s+/g," ")
    .trim();
}

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

function hasPassage(selection, id){
  return !!selection?.passages?.some(p => p.id === id);
}

function pickRandom(arr, n){
  return shuffle(arr).slice(0, n);
}

function escapeHtml(str){
  return (str ?? "").toString()
    .replace(/&/g,"&amp;")
    .replace(/</g,"&lt;")
    .replace(/>/g,"&gt;")
    .replace(/"/g,"&quot;")
    .replace(/'/g,"&#039;");
}

function otonoLetterGrade(score){
  if(score >= 101) return "S";
  if(score >= 95) return "A*";
  if(score >= 90) return "A";
  if(score >= 80) return "B";
  if(score >= 70) return "C";
  if(score >= 66) return "D";
  if(score >= 55) return "E";
  if(score >= 45) return "F";
  if(score >= 30) return "G";
  if(score >= 15) return "H";
  return "U";
}

function passMeritDistinction(score){
  if(score >= 90) return "DISTINCTION";
  if(score >= 80) return "MERIT";
  if(score >= 66) return "PASS";
  return "FAIL";
}

function gcseEstimate(score){
  if(score >= 90) return 9;
  if(score >= 80) return 8;
  if(score >= 70) return 7;
  if(score >= 60) return 6;
  if(score >= 50) return 5;
  if(score >= 40) return 4;
  if(score >= 30) return 3;
  if(score >= 20) return 2;
  if(score >= 10) return 1;
  return "U";
}

function badgeForScore(score){
  if(score >= 101) return ["badge good","üèÜ SECRET SCORE"];
  if(score >= 90) return ["badge good","üèÜ DISTINCTION"];
  if(score >= 80) return ["badge good","‚≠ê MERIT"];
  if(score >= 66) return ["badge warn","‚úÖ PASS"];
  return ["badge bad","‚ùå FAIL"];
}

/* -----------------------------
   Local storage
--------------------------------*/
const STORE_KEY = "otonoSpanishReadingSAM_set1_results_v2";

function loadResults(){
  try{ return JSON.parse(localStorage.getItem(STORE_KEY) || "[]"); }
  catch(e){ return []; }
}
function saveResults(list){
  localStorage.setItem(STORE_KEY, JSON.stringify(list));
}
function addResult(attempt){
  const list = loadResults();
  list.unshift(attempt);
  saveResults(list);
}

/* -----------------------------
   App state
--------------------------------*/
let state = {
  mode: "home",
  timer: null,
  remainingSec: 0,
  startedAt: null,

  centreNo: "50749",

  candidateNo: null,         // 4 digits
  candSurname: "",
  candForenames: "",

  selection: null,
  answers: {},               // qid -> user answer (string)
  mcqCorrectValue: {},       // qid -> correct radio value after shuffling
  submitted: false
};

/* -----------------------------
   Centre number controls
--------------------------------*/
function setCentre(no){
  state.centreNo = String(no);
  $("#centreNo").value = state.centreNo;
  $("#centreTop").textContent = state.centreNo;
}

$("#btnEditCentre").addEventListener("click", () => {
  const val = prompt("Enter centre number (digits only, e.g. 50749):", state.centreNo);
  if(val === null) return;
  const clean = String(val).replace(/\D/g,"").slice(0, 10);
  if(clean.length < 5){
    alert("Centre number must be digits only (at least 5 digits).");
    return;
  }
  setCentre(clean);
});

$("#btnResetCentre").addEventListener("click", () => setCentre("50749"));

/* -----------------------------
   Candidate number 4 squares
--------------------------------*/
const digitIds = ["#candD1","#candD2","#candD3","#candD4"];

function getCandidateNoFromSquares(){
  const d = digitIds.map(id => ($(id).value || "").trim());
  if(d.some(x => x.length !== 1 || !/^\d$/.test(x))) return "";
  return d.join("");
}

function focusDigit(i){
  const el = $(digitIds[i]);
  if(el) el.focus();
}

function wireDigitSquares(){
  digitIds.forEach((id, idx) => {
    const el = $(id);

    el.addEventListener("input", () => {
      // keep digits only
      el.value = (el.value || "").replace(/\D/g,"").slice(0,1);
      if(el.value && idx < digitIds.length-1) focusDigit(idx+1);
    });

    el.addEventListener("keydown", (e) => {
      if(e.key === "Backspace" && !el.value && idx > 0){
        focusDigit(idx-1);
      }
      if(e.key === "ArrowLeft" && idx > 0){
        e.preventDefault(); focusDigit(idx-1);
      }
      if(e.key === "ArrowRight" && idx < digitIds.length-1){
        e.preventDefault(); focusDigit(idx+1);
      }
    });

    el.addEventListener("paste", (e) => {
      e.preventDefault();
      const txt = (e.clipboardData || window.clipboardData).getData("text") || "";
      const digits = txt.replace(/\D/g,"").slice(0,4).split("");
      digits.forEach((ch, j) => {
        const target = $(digitIds[j]);
        if(target) target.value = ch;
      });
      // focus next empty
      const joined = getCandidateNoFromSquares();
      if(joined.length === 4) focusDigit(3);
      else{
        const firstEmpty = digitIds.findIndex(did => !$(did).value);
        if(firstEmpty >= 0) focusDigit(firstEmpty);
      }
    });
  });
}
wireDigitSquares();

/* -----------------------------
   Build paper (4 passages + 1 translation)
--------------------------------*/
function generateSelection(){
  const passages = pickRandom(PASSAGES, 4);
  const translation = pickRandom(TRANSLATIONS, 1)[0];
  return { passages, translation };
}
function selectionSummary(sel){
  const p = sel.passages.map(x=>`#${x.id}`).join(", ");
  return `Passages: ${p} ‚Ä¢ Translation: ${sel.translation.id}`;
}

/* -----------------------------
   Rendering
--------------------------------*/
function setBadge(text, cls="badge"){
  const b = $("#statusBadge");
  b.className = cls;
  b.textContent = text;
}

function renderHome(){
  $("#homeBody").classList.remove("hide");
  $("#testBody").classList.add("hide");
  $("#resultsBody").classList.add("hide");
  $("#sideTitle").textContent = "Otono grading";
  $("#sideMeta").textContent = "Score ‚Üí Otono grade + GCSE estimate + Pass/Merit/Distinction.";
  $("#sideBody").classList.remove("hide");
  setBadge("Ready","badge");
  $("#timerText").textContent = "--:--";
}

function renderResults(){
  $("#homeBody").classList.add("hide");
  $("#testBody").classList.add("hide");
  $("#sideBody").classList.add("hide");
  $("#resultsBody").classList.remove("hide");
  $("#sideTitle").textContent = "Saved results";
  $("#sideMeta").textContent = "Stored per candidate in this browser (localStorage).";
  setBadge("Results","badge");
  $("#timerText").textContent = "--:--";
  drawResults();
}

function stopTimer(){
  if(state.timer){
    clearInterval(state.timer);
    state.timer = null;
  }
}

function startTimer(minutes){
  stopTimer();
  state.remainingSec = Math.max(1, Math.floor(minutes*60));
  state.startedAt = Date.now();

  const tick = () => {
    if(state.submitted) return;
    const m = Math.floor(state.remainingSec/60);
    const s = state.remainingSec%60;
    $("#timerText").textContent = `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
    state.remainingSec--;
    if(state.remainingSec < 0){
      stopTimer();
      const auto = $("#autoSubmit").value === "yes";
      if(auto) submitPaper(true);
      else alert("Time is up. You can still submit manually.");
    }
  };

  tick();
  state.timer = setInterval(tick, 1000);
}

function renderTest(){
  $("#homeBody").classList.add("hide");
  $("#testBody").classList.remove("hide");
  $("#resultsBody").classList.add("hide");
  $("#sideBody").classList.remove("hide");

  const candNameLine = [
    state.candSurname ? state.candSurname : "",
    state.candForenames ? state.candForenames : ""
  ].filter(Boolean).join(", ");

  const cand = `${state.candidateNo}${candNameLine ? " ‚Ä¢ " + candNameLine : ""}`;
  $("#kpiCandidate").textContent = cand;
  $("#kpiPassages").textContent = state.selection.passages.map(p=>`#${p.id}`).join(" ");
  $("#kpiTranslation").textContent = state.selection.translation.id;

  const shuffleMode = $("#shuffleMode").value;
  const paper = $("#paper");
  paper.innerHTML = "";

  // reset per-paper MCQ mapping
  state.mcqCorrectValue = {};

  const sel = state.selection;
  const themes = sel.passages.map(p => `${p.title} (${p.theme}, ${p.unit})`);
  const head = document.createElement("div");
  head.className = "note";
  head.innerHTML = `<strong>Selected content</strong><br/>` +
    themes.map(t => `‚Ä¢ ${escapeHtml(t)}`).join("<br/>") +
    `<br/>‚Ä¢ ${escapeHtml(sel.translation.title)} (${escapeHtml(sel.translation.theme)})`;
  paper.appendChild(head);

  let allBlocks = [];

  sel.passages.forEach(p => {
    const block = document.createElement("div");
    block.className = "card";
    block.style.marginTop = "14px";

    block.innerHTML = `
      <div class="hd">
        <div>
          <h2>${escapeHtml(p.title)}</h2>
          <div class="meta">${escapeHtml(p.theme)} ‚Ä¢ ${escapeHtml(p.unit)} ‚Ä¢ <strong>20 marks</strong></div>
        </div>
        <span class="badge">${escapeHtml("#"+p.id)}</span>
      </div>
      <div class="bd">
        <div class="passage">${escapeHtml(p.text).replace(/\n/g,"<br/>")}</div>
        <div class="divider"></div>
        <div class="small">MCQ/choice options are always shuffled. Written answers are auto-marked using keyword coverage.</div>
        <div class="qs"></div>
      </div>
    `;

    const qs = block.querySelector(".qs");
    let qsList = p.questions.slice();
    if(shuffleMode === "shuffleAll") qsList = shuffle(qsList);

    qsList.forEach(q => {
      const qWrap = document.createElement("div");
      qWrap.className = "q";
      qWrap.dataset.qid = q.id;

      const markTag = `<span class="badge" title="Marks for this question">${q.marks} marks</span>`;
      const instruction = (q.type === "es_short")
        ? "Answer in Spanish. Auto-mark uses keywords."
        : (["mcq","pn","tfnm"].includes(q.type) ? "Select one option." : "Auto-mark uses keywords. Write concise, direct answers.");

      qWrap.innerHTML = `
        <h3>${escapeHtml(q.prompt)} ${markTag}</h3>
        ${renderQuestion(q)}
        <div class="small" style="margin-top:8px">${escapeHtml(instruction)}</div>
      `;
      qs.appendChild(qWrap);
    });

    allBlocks.push(block);
  });

  // Translation block
  const t = sel.translation;
  const tBlock = document.createElement("div");
  tBlock.className = "card";
  tBlock.style.marginTop = "14px";
  tBlock.innerHTML = `
    <div class="hd">
      <div>
        <h2>${escapeHtml(t.title)}</h2>
        <div class="meta">${escapeHtml(t.theme)} ‚Ä¢ <strong>20 marks</strong></div>
      </div>
      <span class="badge">TRANSLATION</span>
    </div>
    <div class="bd">
      <div class="passage">${escapeHtml(t.text)}</div>
      <div class="divider"></div>
      <div class="q" data-qid="translation">
        <h3>Translate into Spanish (write naturally). <span class="badge">20 marks</span></h3>
        <textarea id="ans_translation" placeholder="Type your Spanish translation here..."></textarea>
        <div class="small" style="margin-top:8px">Auto-mark checks key ideas. It‚Äôs strict: include the meaning clearly.</div>
      </div>
    </div>
  `;
  allBlocks.push(tBlock);

  allBlocks.forEach(b => paper.appendChild(b));

  bindInputs();

  const mins = parseInt($("#timeAllowed").value,10);
  startTimer(mins);
  state.submitted = false;

  $("#markingBox").classList.add("hide");
  $("#markingBox").innerHTML = "";
  setBadge("In progress","badge warn");
}

function renderQuestion(q){
  if(q.type === "mcq"){
    const opts = q.options.map((text, idx) => ({ text, isCorrect: idx === q.answerIndex }));
    return renderChoice(q, opts);
  }
  if(q.type === "pn"){
  const key = q.correct ?? q.answer; // ‚úÖ supports both
  const opts = [
    { text:"P", isCorrect: key === "P" },
    { text:"N", isCorrect: key === "N" },
    { text:"P+N", isCorrect: key === "P+N" }
  ];
  return renderChoice(q, opts);
}
  if(q.type === "tfnm"){
    const opts = [
      { text:"True", isCorrect: q.correct === "True" },
      { text:"False", isCorrect: q.correct === "False" },
      { text:"Not mentioned", isCorrect: q.correct === "Not mentioned" }
    ];
    return renderChoice(q, opts);
  }
  // short / es_short
  return `<textarea id="ans_${q.id}" placeholder="${q.type === "es_short" ? "Responde en espa√±ol..." : "Write your answer here..."}"></textarea>`;
}

function renderChoice(q, optionObjects){
  const name = `ans_${q.id}`;

  // ALWAYS shuffle choice options
  const shuffled = shuffle(optionObjects);

  // store which radio value is correct after shuffle
  // value = index in shuffled array
  const correctIndex = shuffled.findIndex(o => o.isCorrect);
  state.mcqCorrectValue[q.id] = String(correctIndex);

  return `
    <div class="opts">
      ${shuffled.map((opt, idx) => `
        <label class="opt">
          <input type="radio" name="${name}" value="${idx}" />
          <div><div><strong>${String.fromCharCode(65+idx)}.</strong> ${escapeHtml(opt.text)}</div></div>
        </label>
      `).join("")}
    </div>
  `;
}

function bindInputs(){
  $$("input[type='radio']").forEach(r => {
    r.addEventListener("change", () => {
      const qid = r.name.replace("ans_","");
      state.answers[qid] = r.value;
    });
  });
  $$("textarea").forEach(t => {
    t.addEventListener("input", () => {
      const id = t.id.replace("ans_","");
      state.answers[id] = t.value;
    });
  });
}

/* -----------------------------
   Auto marking
--------------------------------*/
function markShortAnswer(q, userText){
  const t = norm(userText);
  if(!t) return {score:0, max:q.marks, detail:"Blank answer."};

  const groups = q.keywords || [];
  if(groups.length === 0) return {score:0, max:q.marks, detail:"No keyword rubric set."};

  let hits = 0;
  groups.forEach(g => {
    const found = g.some(k => t.includes(norm(k)));
    if(found) hits++;
  });

  const per = q.marks / groups.length;
  const raw = hits * per;
  const score = Math.max(0, Math.min(q.marks, Math.round(raw*2)/2));

  let detail = `Keyword groups matched: ${hits}/${groups.length}.`;
  if(q.rubric) detail += ` Expected: ${q.rubric}`;
  return {score, max:q.marks, detail};
}

function markChoice(qid, chosenValue, marks){
  const correctValue = state.mcqCorrectValue[qid];
  const ok = String(chosenValue ?? "") === String(correctValue);
  return {
    score: ok ? marks : 0,
    max: marks,
    detail: ok ? "Correct." : "Incorrect."
  };
}

function markTranslation(tObj, userText){
  const raw = userText || "";
  const t = norm(raw);
  if(!t) return {score:0, max:20, detail:"Blank translation."};

  const ideaObjs = tObj.ideas || []; // <-- uses your real structure
  if(ideaObjs.length === 0){
    return {score:0, max:20, detail:"No translation rubric set (tObj.ideas missing)."};
  }

  // score each idea group 0..4 depending on how many sub-points are hit
  function scoreGroup(group){
    const subs = group.sub || [];
    if(subs.length === 0) return 0;

    let hit = 0;
    subs.forEach(arr => {
      const ok = (arr || []).some(k => t.includes(norm(k)));
      if(ok) hit++;
    });

    const ratio = hit / subs.length;      // 0..1
    return Math.max(0, Math.min(4, Math.round(ratio * 4))); // 0..4
  }

  let total = 0;
  let detailParts = [];

  ideaObjs.forEach(g => {
    const gs = scoreGroup(g);
    total += gs;
    detailParts.push(`${g.name}: ${gs}/4`);
  });

  return {
    score: Math.max(0, Math.min(20, total)),
    max: 20,
    detail: `Idea-group marks ‚Üí ${detailParts.join(" ‚Ä¢ ")}`
  };
}
function computeTotal(){
  let total = 0;
  let breakdown = [];

  state.selection.passages.forEach(p => {
    p.questions.forEach(q => {
      const ans = state.answers[q.id];
      let res;

      if(["mcq","pn","tfnm"].includes(q.type)){
        res = markChoice(q.id, ans, q.marks);
      }else{
        res = markShortAnswer(q, ans);
      }

      total += res.score;
      breakdown.push({
        qid: q.id,
        passageId: p.id,
        type: q.type,
        prompt: q.prompt,
        score: res.score,
        max: res.max,
        detail: res.detail
      });
    });
  });

  const tAns = state.answers["translation"] ?? $("#ans_translation")?.value ?? "";
  const tRes = markTranslation(state.selection.translation, tAns);
  total += tRes.score;
  breakdown.push({
    qid: "translation",
    passageId: "translation",
    type: "translation",
    prompt: "Translate into Spanish",
    score: tRes.score,
    max: tRes.max,
    detail: tRes.detail
  });

  const totalRounded = Math.round(total*10)/10;
  return { total: totalRounded, max: 100, breakdown };
}

/* -----------------------------
   Submission + saving
--------------------------------*/
function submitPaper(fromAutoTimer=false){
  if(state.submitted) return;

  const { total, max, breakdown } = computeTotal();
  state.submitted = true;
  stopTimer();

  const letter = otonoLetterGrade(total);
  const pmd = passMeritDistinction(total);
  const gcse = gcseEstimate(total);
  const [badgeCls, badgeText] = badgeForScore(total);

  const attempt = {
    paper: "Otono Spanish Reading (SAM) ‚Ä¢ Sample set 1",
    centre: state.centreNo,
    candidateNo: String(state.candidateNo),
    candidateSurname: state.candSurname || "",
    candidateForenames: state.candForenames || "",
    submittedAt: nowISO(),
    timeAllowedMin: parseInt($("#timeAllowed").value,10),
    selectedPassages: state.selection.passages.map(p=>p.id),
    selectedTranslation: state.selection.translation.id,
    score: total,
    maxScore: max,
    otonoGrade: letter,
    gcseEstimated: gcse,
    outcome: pmd,
    breakdown
  };
  addResult(attempt);

  const nameLine = [attempt.candidateSurname, attempt.candidateForenames].filter(Boolean).join(", ");

  const box = $("#markingBox");
  box.classList.remove("hide");
  box.className = "";
  box.innerHTML = `
    <div class="card">
      <div class="hd">
        <div>
          <h2>‚úÖ Marked${fromAutoTimer ? " (auto-submitted)" : ""}</h2>
          <div class="meta">Saved to Results ‚Ä¢ Centre ${escapeHtml(attempt.centre)} ‚Ä¢ Candidate ${escapeHtml(attempt.candidateNo)}${nameLine ? " ‚Ä¢ " + escapeHtml(nameLine) : ""}</div>
        </div>
        <span class="${badgeCls}">${escapeHtml(badgeText)}</span>
      </div>
      <div class="bd">
        <div class="kpi">
          <div class="box"><div class="t">Score</div><div class="v">${attempt.score} / ${attempt.maxScore}</div></div>
          <div class="box"><div class="t">Otono grade</div><div class="v">${escapeHtml(attempt.otonoGrade)}</div></div>
          <div class="box"><div class="t">GCSE estimate</div><div class="v">${escapeHtml(String(attempt.gcseEstimated))}</div></div>
          <div class="box"><div class="t">Outcome</div><div class="v">${escapeHtml(attempt.outcome)}</div></div>
        </div>

        <div class="divider"></div>

        <div class="note">
          <strong>Marking notes</strong><br/>
          ‚Ä¢ MCQ / P-N / TFNM are exact (options are shuffled).<br/>
          ‚Ä¢ Written + translation are keyword-based. If you used very different wording, it may under-mark.
        </div>

        <div class="divider"></div>

        <button class="btn" id="btnShowBreakdown">Show question breakdown</button>
        <div id="breakdown" class="hide" style="margin-top:12px"></div>

        <div class="divider"></div>

        <div class="note">
          <strong>Translation model answer (for reference)</strong><br/>
          ${escapeHtml(state.selection.translation.sampleAnswer)}
        </div>
      </div>
    </div>
  `;

  $("#btnShowBreakdown").addEventListener("click", () => {
    const bd = $("#breakdown");
    bd.classList.toggle("hide");
    if(!bd.classList.contains("hide")){
      bd.innerHTML = breakdown.map(b => `
        <div class="attempt">
          <div class="top">
            <div><strong>${escapeHtml(b.qid)}</strong> ‚Ä¢ ${escapeHtml(String(b.type))}</div>
            <div><span class="badge">${b.score} / ${b.max}</span></div>
          </div>
          <div class="meta">
            <div><strong>Prompt:</strong> ${escapeHtml(b.prompt)}</div>
            <div><strong>Marker:</strong> ${escapeHtml(b.detail)}</div>
          </div>
        </div>
      `).join("");
    }
  });

  setBadge("Submitted","badge good");
}

/* -----------------------------
   Results UI
--------------------------------*/
function drawResults(){
  const listEl = $("#resultsList");
  const all = loadResults();
  const filter = ($("#filterCandidate").value || "").replace(/\D/g,"").slice(0,4);

  const filtered = filter ? all.filter(a => String(a.candidateNo) === String(filter)) : all;

  if(filtered.length === 0){
    listEl.innerHTML = `<div class="note">No stored attempts${filter ? " for this candidate" : ""} yet.</div>`;
    return;
  }

  listEl.innerHTML = filtered.map(a => {
    const [cls, txt] = badgeForScore(a.score);
    const nameLine = [a.candidateSurname, a.candidateForenames].filter(Boolean).join(", ");
    return `
      <div class="attempt">
        <div class="top">
          <div>
            <strong>${escapeHtml(a.candidateNo)}</strong>${nameLine ? " ‚Ä¢ " + escapeHtml(nameLine) : ""}
            <span class="badge" style="margin-left:8px">Centre ${escapeHtml(a.centre)}</span>
          </div>
          <div class="${cls}">${escapeHtml(txt)} ‚Ä¢ ${escapeHtml(String(a.score))}/100</div>
        </div>
        <div class="meta">
          <div><strong>Date:</strong> ${escapeHtml(new Date(a.submittedAt).toLocaleString())}</div>
          <div><strong>Selection:</strong> Passages ${escapeHtml(a.selectedPassages.join(", "))} ‚Ä¢ Translation ${escapeHtml(a.selectedTranslation)}</div>
          <div><strong>Grades:</strong> Otono ${escapeHtml(a.otonoGrade)} ‚Ä¢ GCSE ${escapeHtml(String(a.gcseEstimated))} ‚Ä¢ ${escapeHtml(a.outcome)}</div>
        </div>
      </div>
    `;
  }).join("");
}

function exportResults(){
  const all = loadResults();
  $("#exportText").textContent = JSON.stringify(all, null, 2);
  $("#exportBox").classList.remove("hide");
}

function clearResults(){
  if(!confirm("Clear ALL stored Otono Spanish results on this browser?")) return;
  localStorage.removeItem(STORE_KEY);
  drawResults();
  $("#exportBox").classList.add("hide");
}

/* -----------------------------
   Buttons / navigation
--------------------------------*/
$("#btnHome").addEventListener("click", () => {
  state.mode = "home";
  renderHome();
});

$("#btnResults").addEventListener("click", () => {
  state.mode = "results";
  renderResults();
});

$("#btnPreview").addEventListener("click", () => {
  const c = getCandidateNoFromSquares();
  if(!c){
    alert("Enter a candidate number first.");
    return;
  }
  const sel = generateSelection();
  const box = $("#previewBox");
  box.classList.remove("hide");
  box.innerHTML = `<strong>Preview (not started):</strong><br/>${escapeHtml(selectionSummary(sel))}<br/>` +
    sel.passages.map(p => `‚Ä¢ ${escapeHtml(p.title)} (${escapeHtml(p.theme)})`).join("<br/>") +
    `<br/>‚Ä¢ ${escapeHtml(sel.translation.title)} (${escapeHtml(sel.translation.theme)})`;
});

$("#btnStart").addEventListener("click", () => {
  const c = getCandidateNoFromSquares();
  if(!c){
    alert("Candidate number is required.");
    focusDigit(0);
    return;
  }

  state.candidateNo = c;
  state.candSurname = ($("#candSurname").value || "").trim();
  state.candForenames = ($("#candForenames").value || "").trim();

  state.selection = generateSelection();
  state.answers = {};
  renderTest();
});

$("#btnSubmit").addEventListener("click", () => submitPaper(false));

$("#btnReset").addEventListener("click", () => {
  if(!confirm("Reset this paper and generate a NEW random test? Your current answers will be lost.")) return;
  stopTimer();
  state.answers = {};
  state.submitted = false;
  state.selection = generateSelection();
  renderTest();
});

/* Results filters & tabs */
$("#filterCandidate").addEventListener("input", (e) => {
  e.target.value = e.target.value.replace(/\D/g,"").slice(0,4);
  drawResults();
});

$("#tabAll").addEventListener("click", () => {
  $("#tabAll").classList.add("active");
  $("#tabCandidate").classList.remove("active");
  $("#filterCandidate").value = "";
  drawResults();
});

$("#tabCandidate").addEventListener("click", () => {
  $("#tabCandidate").classList.add("active");
  $("#tabAll").classList.remove("active");
  $("#filterCandidate").focus();
});

$("#btnExport").addEventListener("click", exportResults);
$("#btnClear").addEventListener("click", clearResults);

/* Initial */
setCentre("50749");
renderHome();

/* -----------------------------
   Anti-cheat / source protection
   (as requested)
--------------------------------*/
const disabledKeys = ["u", "I"];
const showAlert = e => {
  e.preventDefault();
  return alert("Hahaha, I challenge you, valiant soldier, to uproot the source codes yourself!!!");
};
document.addEventListener("contextmenu", e => { showAlert(e); });
document.addEventListener("keydown", e => {
  if ((e.ctrlKey && disabledKeys.includes(e.key)) || e.key === "F12") {
    showAlert(e);
  }
});
</script>

</body>
</html>
